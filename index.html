<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OK저축은행 회의자료 관리 시스템</title>
  <style>
    :root {
      --ok-orange: #E93D1A;
      --ok-dark-brown: #554744;
      --ok-yellow: #F4A611;
      --ok-bright-gray: #C5C5C5;
      --ok-bg-gray: #F8F8F8;
      --ok-text-dark: #2D2D2D;
      --ok-border-light: #E8E8E8;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
      background-color: var(--ok-bg-gray);
      color: var(--ok-text-dark);
      min-height: 100vh;
    }

    /* 통합 로그인 페이지 스타일 */
    .login-page {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, var(--ok-bg-gray) 0%, #e8e8e8 100%);
      padding: 20px;
    }

    .login-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.1);
      padding: 40px;
      max-width: 500px;
      width: 100%;
      text-align: center;
      border: 2px solid var(--ok-border-light);
    }

    .login-header {
      margin-bottom: 30px;
    }

    .login-logo svg {
      height: 60px;
      width: auto;
      margin-bottom: 20px;
    }

    .login-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 10px;
    }

    .login-subtitle {
      color: var(--ok-dark-brown);
      font-size: 1rem;
      margin-bottom: 20px;
    }

    .login-type-selector {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      background: var(--ok-bg-gray);
      padding: 6px;
      border-radius: 12px;
    }

    .login-type-btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      background: transparent;
      color: var(--ok-text-dark);
    }

    .login-type-btn.active {
      background: var(--ok-orange);
      color: white;
      box-shadow: 0 4px 15px rgba(233, 61, 26, 0.3);
    }

    .login-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .form-group {
      text-align: left;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--ok-text-dark);
    }

    .form-input {
      width: 100%;
      padding: 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 10px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: #fafafa;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--ok-orange);
      background: white;
      box-shadow: 0 0 0 3px rgba(233, 61, 26, 0.1);
    }

    .login-btn {
      background: linear-gradient(135deg, var(--ok-orange) 0%, #ff6b35 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(233, 61, 26, 0.3);
      margin-top: 10px;
    }

    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(233, 61, 26, 0.4);
    }

    .login-btn:disabled {
      background: var(--ok-bright-gray);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .login-message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      font-size: 0.9rem;
      display: none;
    }

    .login-message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .login-message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .login-message.info {
      background: #cce5ff;
      color: #004085;
      border: 1px solid #b3d9ff;
    }

    /* 메인 앱 스타일 */
    .main-app {
      display: none;
      min-height: 100vh;
    }

    .app-header {
      background: linear-gradient(135deg, var(--ok-dark-brown) 0%, #3D2F2C 100%);
      color: white;
      padding: 20px 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      position: relative;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .app-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .header-logo svg {
      height: 40px;
      width: auto;
    }

    .header-title {
      font-size: 1.8rem;
      font-weight: 700;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-info {
      background: rgba(255,255,255,0.1);
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .btn-header {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn-header:hover {
      background: #ff4520;
      transform: translateY(-2px);
    }

    .btn-header.secondary {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.3);
    }

    .btn-header.secondary:hover {
      background: rgba(255,255,255,0.2);
    }

    .app-content {
      padding: 30px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* 탭 스타일 (관리자용) */
    .tab-navigation {
      background: white;
      border-bottom: 2px solid var(--ok-border-light);
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .tab-container {
      display: flex;
      max-width: 1400px;
      margin: 0 auto;
    }

    .tab-button {
      background: none;
      border: none;
      padding: 20px 30px;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--ok-text-dark);
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
      position: relative;
    }

    .tab-button:hover {
      background: rgba(233, 61, 26, 0.05);
      color: var(--ok-orange);
    }

    .tab-button.active {
      color: var(--ok-orange);
      border-bottom-color: var(--ok-orange);
      background: rgba(233, 61, 26, 0.05);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* 기본 카드 스타일 */
    .card {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      margin-bottom: 30px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .card-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--ok-text-dark);
    }

    /* 작성자 전용 - 회의 선택 */
    .meeting-selector {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      margin-bottom: 30px;
    }

    .selector-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .selector-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .selector-group label {
      font-weight: 600;
      color: var(--ok-text-dark);
    }

    /* 작성자 입력 폼 스타일 */
    .meeting-form {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      margin-bottom: 30px;
    }

    .form-header {
      text-align: center;
      margin-bottom: 30px;
      padding-bottom: 20px;
      border-bottom: 2px solid var(--ok-border-light);
    }

    .form-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 10px;
    }

    .form-subtitle {
      color: var(--ok-dark-brown);
      font-size: 1.1rem;
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 20px;
      flex-wrap: wrap;
    }

    .user-dept {
      background: var(--ok-orange);
      color: white;
      padding: 4px 12px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .form-container {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .form-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .form-label {
      font-weight: 600;
      color: var(--ok-text-dark);
      font-size: 1.1rem;
      margin-bottom: 5px;
    }

    .form-textarea {
      width: 100%;
      min-height: 150px;
      padding: 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 12px;
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
      transition: border-color 0.3s ease;
      box-sizing: border-box;
    }

    .form-textarea:focus {
      outline: none;
      border-color: var(--ok-orange);
      box-shadow: 0 0 0 3px rgba(233, 61, 26, 0.1);
    }

    .form-textarea::placeholder {
      color: #999;
    }

    .form-actions {
      display: flex;
      gap: 15px;
      justify-content: center;
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid var(--ok-border-light);
    }

    .form-actions button {
      min-width: 120px;
      padding: 12px 24px;
      font-size: 1rem;
      font-weight: 600;
    }

    .textarea-container {
      position: relative;
    }

    .char-counter {
      position: absolute;
      bottom: 8px;
      right: 12px;
      font-size: 0.8rem;
      color: #666;
      background: rgba(255, 255, 255, 0.9);
      padding: 2px 6px;
      border-radius: 4px;
      pointer-events: none;
    }

    .char-counter.warning {
      color: #ff6b35;
      font-weight: 600;
    }

    .char-counter.error {
      color: #d32f2f;
      font-weight: 600;
    }

    .info-message {
      margin-top: 15px;
      padding: 10px 15px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 500;
    }

    .info-message.info {
      background-color: #e3f2fd;
      color: #1976d2;
      border: 1px solid #90caf9;
    }

    .info-message.warning {
      background-color: #fff3e0;
      color: #f57c00;
      border: 1px solid #ffb74d;
    }

    .info-message.error {
      background-color: #ffebee;
      color: #d32f2f;
      border: 1px solid #ef5350;
    }

    /* 보안 경고 배너 스타일 */
    .security-warning-banner {
      background: linear-gradient(135deg, #d32f2f 0%, #c62828 100%);
      border: 2px solid #b71c1c;
      border-radius: 12px;
      margin-bottom: 25px;
      box-shadow: 0 4px 15px rgba(211, 47, 47, 0.3);
      animation: securityPulse 3s ease-in-out infinite;
    }

    @keyframes securityPulse {
      0%, 100% { box-shadow: 0 4px 15px rgba(211, 47, 47, 0.3); }
      50% { box-shadow: 0 4px 20px rgba(211, 47, 47, 0.5); }
    }

    .security-warning-content {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 15px 20px;
      color: white;
    }

    .security-icon {
      font-size: 2rem;
      filter: drop-shadow(0 2px 4px rgba(0,0,0,0.3));
    }

    .security-text {
      flex: 1;
    }

    .security-title {
      font-size: 1.1rem;
      font-weight: 700;
      margin-bottom: 8px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .security-message {
      font-size: 0.9rem;
      line-height: 1.4;
    }

    .security-message p {
      margin: 0;
      margin-bottom: 4px;
    }

    .security-message p:last-child {
      margin-bottom: 0;
    }

    .security-message strong {
      font-weight: 700;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    /* 보안 경고 컴팩트 버전 */
    .security-warning-compact {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
      margin-top: 12px;
      padding: 8px 15px;
      background: linear-gradient(135deg, #ff5722 0%, #f4511e 100%);
      border: 1px solid #e64a19;
      border-radius: 20px;
      color: white;
      font-size: 0.8rem;
      font-weight: 600;
      box-shadow: 0 2px 8px rgba(255, 87, 34, 0.3);
    }

    .security-compact-icon {
      font-size: 0.9rem;
      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3));
    }

    .security-compact-text {
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
      letter-spacing: 0.5px;
    }

    /* 모바일 대응 */
    @media (max-width: 768px) {
      .security-warning-content {
        flex-direction: column;
        text-align: center;
        gap: 10px;
      }
      
      .security-icon {
        font-size: 1.5rem;
      }
      
      .security-message {
        font-size: 0.85rem;
      }
      
      .security-warning-compact {
        flex-wrap: wrap;
        gap: 5px;
        font-size: 0.75rem;
      }
    }

    /* 로그인 페이지 보안 안내 */
    .login-security-notice {
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
      margin-top: 20px;
      padding: 10px 15px;
      background: linear-gradient(135deg, #37474f 0%, #263238 100%);
      border: 1px solid #455a64;
      border-radius: 10px;
      color: white;
      font-size: 0.8rem;
    }

    .login-security-icon {
      font-size: 1rem;
      filter: drop-shadow(0 1px 2px rgba(0,0,0,0.3));
    }

    .login-security-text {
      text-align: center;
      line-height: 1.3;
      text-shadow: 0 1px 2px rgba(0,0,0,0.3);
    }

    .login-security-text strong {
      font-weight: 700;
      color: #ffeb3b;
    }

    /* 회의자료 총괄 탭 스타일 */
    .summary-header {
      background: white;
      border-radius: 12px;
      padding: 25px;
      margin-bottom: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
    }

    .summary-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 20px;
    }

    .summary-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 20px;
    }

    .summary-filter {
      display: flex;
      align-items: center;
      gap: 15px;
      flex-wrap: wrap;
    }

    .summary-filter label {
      font-weight: 600;
      color: var(--ok-text-dark);
      white-space: nowrap;
    }

    .summary-filter .form-select {
      min-width: 120px;
    }

    .summary-actions {
      display: flex;
      gap: 10px;
    }

    .summary-content {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
    }

    .summary-info {
      margin-bottom: 25px;
      padding: 20px;
      background: var(--ok-bg-gray);
      border-radius: 8px;
      border: 1px solid var(--ok-border-light);
    }

    .summary-meeting-title {
      font-size: 1.4rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 15px;
      text-align: center;
    }

    .summary-stats {
      display: flex;
      justify-content: center;
      gap: 30px;
      flex-wrap: wrap;
    }

    .summary-stat {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
    }

    .summary-stat-label {
      font-size: 0.9rem;
      color: var(--ok-dark-brown);
      font-weight: 600;
    }

    .summary-stat-value {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--ok-text-dark);
    }

    .summary-stat-value.completed {
      color: #4caf50;
    }

    .summary-stat-value.pending {
      color: #ff9800;
    }

    .summary-table-container {
      overflow-x: auto;
      border-radius: 8px;
      border: 1px solid var(--ok-border-light);
    }

    .summary-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.9rem;
    }

    .summary-table th {
      background: var(--ok-dark-brown);
      color: white;
      padding: 12px 8px;
      text-align: left;
      font-weight: 600;
      border: 1px solid #666;
    }

    .summary-table td {
      padding: 12px 8px;
      border: 1px solid var(--ok-border-light);
      vertical-align: top;
    }

    .summary-table tbody tr:nth-child(even) {
      background: var(--ok-bg-gray);
    }

    .summary-table tbody tr:hover {
      background: #f0f8ff;
    }

    .summary-table .content-cell {
      max-width: 200px;
      word-wrap: break-word;
      line-height: 1.4;
    }

    .summary-table .status-completed {
      color: #4caf50;
      font-weight: 600;
    }

    .summary-table .status-empty {
      color: #ff9800;
      font-weight: 600;
    }

    .summary-empty {
      text-align: center;
      padding: 60px 20px;
      color: var(--ok-dark-brown);
    }

    .empty-icon {
      font-size: 3rem;
      margin-bottom: 15px;
    }

    .empty-text {
      font-size: 1.1rem;
      color: var(--ok-dark-brown);
    }

    /* 모바일 대응 */
    @media (max-width: 768px) {
      .summary-controls {
        flex-direction: column;
        align-items: stretch;
      }
      
      .summary-filter {
        justify-content: center;
      }
      
      .summary-actions {
        justify-content: center;
      }
      
      .summary-stats {
        gap: 20px;
      }
      
      .summary-table {
        font-size: 0.8rem;
      }
      
      .summary-table th,
      .summary-table td {
        padding: 8px 6px;
      }
    }

    .form-select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 8px;
      font-size: 1rem;
      background: #fafafa;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .form-select:focus {
      outline: none;
      border-color: var(--ok-orange);
      background: white;
    }

    .btn-primary {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background: #ff4520;
    }

    .btn-primary:disabled {
      background: var(--ok-bright-gray);
      cursor: not-allowed;
    }

    /* 모달 스타일 */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      text-align: center;
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 20px;
    }

    .modal-subtitle {
      color: var(--ok-dark-brown);
      margin-bottom: 30px;
      line-height: 1.5;
    }

    /* 대시보드 스타일 */
    .dashboard-stats {
      margin-bottom: 30px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
    }

    .stat-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .stat-icon {
      font-size: 3rem;
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .stat-content {
      flex: 1;
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--ok-orange);
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 5px;
    }

    .stat-desc {
      color: var(--ok-dark-brown);
      font-size: 0.9rem;
    }

    .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }

    .card-actions {
      display: flex;
      gap: 10px;
    }

    .table-container {
      overflow-x: auto;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.95rem;
    }

    .data-table th,
    .data-table td {
      padding: 15px 20px;
      text-align: left;
      border-bottom: 1px solid var(--ok-border-light);
    }

    .data-table th {
      background: var(--ok-bg-gray);
      font-weight: 600;
      color: var(--ok-text-dark);
    }

    .data-table tbody tr:hover {
      background: rgba(233, 61, 26, 0.05);
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 600;
      text-align: center;
      min-width: 80px;
      display: inline-block;
    }

    .status-completed {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .status-not-started {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f1b0b7;
    }

    .empty-state {
      text-align: center;
      padding: 50px 20px;
      color: var(--ok-bright-gray);
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 20px;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: var(--ok-text-dark);
    }

    .empty-state p {
      font-size: 1rem;
      color: var(--ok-dark-brown);
    }

    .btn-action {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 600;
      transition: all 0.3s ease;
      margin: 0 2px;
    }

    .btn-view {
      background: #007bff;
      color: white;
    }

    .btn-view:hover {
      background: #0056b3;
    }

    .btn-edit {
      background: #28a745;
      color: white;
    }

    .btn-edit:hover {
      background: #1e7e34;
    }

    .btn-delete {
      background: #dc3545;
      color: white;
    }

    .btn-delete:hover {
      background: #c82333;
    }

    /* 계정 관리 스타일 */
    .account-stats {
      margin-bottom: 30px;
    }

    .account-creation-form {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .account-status {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
      display: inline-block;
    }

    .account-status.active {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .account-status.inactive {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f1b0b7;
    }

    .account-status.online {
      background: #cce5ff;
      color: #004085;
      border: 1px solid #b3d9ff;
    }

    .btn-manage {
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.7rem;
      font-weight: 600;
      transition: all 0.3s ease;
      margin: 0 2px;
    }

    .btn-activate {
      background: #28a745;
      color: white;
    }

    .btn-activate:hover {
      background: #1e7e34;
    }

    .btn-deactivate {
      background: #ffc107;
      color: #212529;
    }

    .btn-deactivate:hover {
      background: #e0a800;
    }

    .btn-reset {
      background: #17a2b8;
      color: white;
    }

    .btn-reset:hover {
      background: #138496;
    }

    .btn-remove {
      background: #dc3545;
      color: white;
    }

    .btn-remove:hover {
      background: #c82333;
    }

    /* 보안 설정 스타일 */
    .security-stats {
      margin-bottom: 30px;
    }

    .admin-settings {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .setting-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
    }

    .setting-info h3 {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 10px;
    }

    .setting-info p {
      color: var(--ok-dark-brown);
      margin-bottom: 5px;
    }

    .setting-actions {
      flex-shrink: 0;
    }

    .login-filter {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
      margin-bottom: 20px;
    }

    .filter-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }

    .login-status {
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 600;
      display: inline-block;
    }

    .login-status.success {
      background: #d4edda;
      color: #155724;
    }

    .login-status.failed {
      background: #f8d7da;
      color: #721c24;
    }

    .ip-address {
      font-family: 'Courier New', monospace;
      background: #f8f9fa;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .browser-info {
      font-size: 0.8rem;
      color: var(--ok-dark-brown);
      max-width: 200px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* 반응형 디자인 */
    @media (max-width: 768px) {
      .login-container {
        padding: 30px 20px;
      }

      .app-header {
        flex-direction: column;
      gap: 15px;
        text-align: center;
      }

      .header-left {
        flex-direction: column;
        gap: 10px;
      }

      .header-right {
        flex-direction: column;
        gap: 10px;
      }

      .app-content {
        padding: 20px;
      }

      .tab-container {
        flex-direction: column;
      }
      
      .tab-button {
        padding: 15px 20px;
      }
      
      .selector-grid {
        grid-template-columns: 1fr;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .filter-grid {
        grid-template-columns: 1fr;
      }

      .stat-card {
        flex-direction: column;
        text-align: center;
      }

      .stat-icon {
        width: 60px;
        height: 60px;
        font-size: 2rem;
      }

      .stat-number {
        font-size: 2rem;
      }

      .card-actions {
        flex-direction: column;
        width: 100%;
      }

      .data-table {
        font-size: 0.85rem;
      }

      .data-table th,
      .data-table td {
        padding: 10px 8px;
      }

      .btn-action {
        padding: 4px 8px;
        font-size: 0.7rem;
      }

      .setting-item {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      .setting-actions {
        width: 100%;
      }

      .filter-row {
        grid-template-columns: 1fr;
      }

      .login-filter {
        padding: 15px;
      }

      .browser-info {
        max-width: 100px;
      }

      .btn-manage {
        padding: 3px 6px;
        font-size: 0.6rem;
      }
    }
  </style>
</head>
<body>
  <!-- 통합 로그인 페이지 -->
  <div class="login-page" id="loginPage">
    <div class="login-container">
      <div class="login-header">
        <div class="login-logo">
          <svg width="140" height="50" viewBox="0 0 140 50" style="height: 60px; width: auto;">
            <defs>
              <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#554744;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3d3330;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="orangeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#E93D1A;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#d32f0f;stop-opacity:1" />
              </linearGradient>
            </defs>
            <rect width="140" height="50" rx="12" fill="url(#bgGradient)"/>
            <rect x="0" y="0" width="8" height="50" rx="12" fill="url(#orangeGradient)"/>
            <text x="18" y="34" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="#2a2a2a" opacity="0.3">OK</text>
            <text x="16" y="32" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="white">OK</text>
            <text x="52" y="34" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#2a2a2a" opacity="0.3">!</text>
            <text x="50" y="32" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#E93D1A">!</text>
            <text x="70" y="22" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white">저축은행</text>
            <text x="70" y="36" font-family="Arial, sans-serif" font-size="9" font-weight="500" fill="#F4A611">SAVINGS BANK</text>
            <circle cx="125" cy="15" r="4" fill="#E93D1A" opacity="0.8"/>
            <circle cx="130" cy="25" r="2.5" fill="#F4A611" opacity="0.9"/>
            <circle cx="120" cy="35" r="2" fill="#E93D1A" opacity="0.6"/>
          </svg>
        </div>
        <h1 class="login-title">OK저축은행 회의자료 관리 시스템</h1>
        <p class="login-subtitle">시스템에 접속하려면 로그인해주세요</p>
        </div>

      <div class="login-type-selector">
        <button class="login-type-btn active" onclick="switchLoginType('admin')">관리자</button>
        <button class="login-type-btn" onclick="switchLoginType('writer')">작성자</button>
        </div>

      <div id="adminLoginForm" class="login-form">
        <div class="form-group">
          <label for="adminId">관리자 ID</label>
          <input type="text" id="adminId" class="form-input" placeholder="OKADMIN" value="OKADMIN" readonly>
          </div>
        <div class="form-group">
          <label for="adminPassword">비밀번호</label>
          <input type="password" id="adminPassword" class="form-input" placeholder="비밀번호를 입력하세요">
        </div>
        <button class="login-btn" onclick="handleAdminLogin()">관리자 로그인</button>
        </div>

      <div id="writerLoginForm" class="login-form" style="display: none;">
        <div class="form-group">
          <label for="writerId">작성자 ID</label>
          <input type="text" id="writerId" class="form-input" placeholder="OK 1 ~ OK 20">
          </div>
        <div class="form-group">
          <label for="writerPassword">비밀번호</label>
          <input type="password" id="writerPassword" class="form-input" placeholder="비밀번호를 입력하세요">
        </div>
        <button class="login-btn" onclick="handleWriterLogin()">작성자 로그인</button>
    </div>

      <div id="loginMessage" class="login-message"></div>
      
      <!-- 로그인 페이지 보안 안내 -->
      <div class="login-security-notice">
        <div class="login-security-icon">🔒</div>
        <div class="login-security-text">
          <strong>보안 시스템</strong> • 접속 기록 모니터링 • 기밀정보 무단유출 금지
        </div>
      </div>
    </div>
  </div>

  <!-- 메인 앱 -->
  <div class="main-app" id="mainApp">
    <div class="app-header">
      <div class="header-left">
        <div class="header-logo">
          <svg width="140" height="50" viewBox="0 0 140 50" style="height: 40px; width: auto;">
            <defs>
              <linearGradient id="bgGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#554744;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3d3330;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="orangeGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#E93D1A;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#d32f0f;stop-opacity:1" />
              </linearGradient>
            </defs>
            <rect width="140" height="50" rx="12" fill="url(#bgGradient2)"/>
            <rect x="0" y="0" width="8" height="50" rx="12" fill="url(#orangeGradient2)"/>
            <text x="18" y="34" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="#2a2a2a" opacity="0.3">OK</text>
            <text x="16" y="32" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="white">OK</text>
            <text x="52" y="34" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#2a2a2a" opacity="0.3">!</text>
            <text x="50" y="32" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#E93D1A">!</text>
            <text x="70" y="22" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white">저축은행</text>
            <text x="70" y="36" font-family="Arial, sans-serif" font-size="9" font-weight="500" fill="#F4A611">SAVINGS BANK</text>
            <circle cx="125" cy="15" r="4" fill="#E93D1A" opacity="0.8"/>
            <circle cx="130" cy="25" r="2.5" fill="#F4A611" opacity="0.9"/>
            <circle cx="120" cy="35" r="2" fill="#E93D1A" opacity="0.6"/>
          </svg>
        </div>
        <h1 class="header-title" id="headerTitle">회의자료 관리 시스템</h1>
      </div>
      <div class="header-right">
        <div class="user-info" id="userInfo">사용자</div>
        <button class="btn-header secondary" onclick="logout()">로그아웃</button>
      </div>
      </div>
      
    <!-- 관리자 전용 탭 -->
    <div class="tab-navigation" id="adminTabs" style="display: none;">
      <div class="tab-container">
        <button class="tab-button active" onclick="switchTab('dashboard')">📊 대시보드</button>
        <button class="tab-button" onclick="switchTab('summary')">📋 회의자료 총괄</button>
        <button class="tab-button" onclick="switchTab('accounts')">👥 계정관리</button>
        <button class="tab-button" onclick="switchTab('security')">🔐 보안설정</button>
      </div>
          </div>
          
    <div class="app-content">
      <!-- 관리자 대시보드 -->
      <div id="dashboardTab" class="tab-content">
        <!-- 통계 카드 -->
        <div class="dashboard-stats">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">📅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="totalMeetings">0</h3>
                <p class="stat-label">전체 부서</p>
                <p class="stat-desc">16개 부서</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">✅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="completedTasks">0</h3>
                <p class="stat-label">작성완료</p>
                <p class="stat-desc">완료된 회의자료</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">📝</div>
              <div class="stat-content">
                <h3 class="stat-number" id="pendingTasks">0</h3>
                <p class="stat-label">작성중</p>
                <p class="stat-desc">진행중인 회의자료</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">⏳</div>
              <div class="stat-content">
                <h3 class="stat-number" id="notStartedTasks">0</h3>
                <p class="stat-label">미작성</p>
                <p class="stat-desc">시작하지 않은 회의자료</p>
              </div>
            </div>
          </div>
        </div>
        
        <!-- 회의 선택 필터 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">회의 선택</h2>
        </div>
          <div class="filter-grid">
            <div class="form-group">
              <label for="filterYear">연도</label>
              <select id="filterYear" class="form-select">
                <option value="">연도 선택</option>
                <option value="2025">2025년</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filterMonth">월</label>
              <select id="filterMonth" class="form-select">
                <option value="">월 선택</option>
                <option value="08">8월</option>
                <option value="09">9월</option>
                <option value="10">10월</option>
                <option value="11">11월</option>
                <option value="12">12월</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filterType">회의 구분</label>
              <select id="filterType" class="form-select">
                <option value="">회의 구분 선택</option>
                <option value="monthly">월간간담회</option>
                <option value="week1">1주차 주간간담회</option>
                <option value="week2">2주차 주간간담회</option>
                <option value="week3">3주차 주간간담회</option>
                <option value="week4">4주차 주간간담회</option>
                <option value="week5">5주차 주간간담회</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn-primary" onclick="searchMeeting()" id="searchBtn" disabled>회의 조회</button>
            </div>
      </div>
    </div>

        <!-- 회의자료 현황 테이블 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">회의자료 작성 현황</h2>
            <div class="card-actions">
              <button class="btn-header" onclick="exportCurrentData()">📊 데이터 내보내기</button>
              <button class="btn-header secondary" onclick="refreshData()">🔄 새로고침</button>
        </div>
          </div>
          <div id="tableContent">
            <div class="empty-state" id="emptyState">
              <div class="empty-icon">📊</div>
              <h3>회의를 선택해주세요</h3>
              <p>위에서 연도, 월, 회의 구분을 선택한 후 회의 조회 버튼을 눌러주세요.</p>
            </div>
            <div class="table-container" id="dataTableContainer" style="display: none;">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>회의명</th>
                    <th>부서</th>
                    <th>상태</th>
                    <th>마지막 수정</th>
                    <th>액션</th>
                  </tr>
                </thead>
                <tbody id="dataTableBody">
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 계정 관리 -->
      <div id="accountsTab" class="tab-content">
        <!-- 계정 현황 통계 -->
        <div class="account-stats">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">👥</div>
              <div class="stat-content">
                <h3 class="stat-number" id="totalAccounts">0</h3>
                <p class="stat-label">전체 계정</p>
                <p class="stat-desc">OK 1 ~ OK 20</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">✅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="activeAccounts">0</h3>
                <p class="stat-label">활성 계정</p>
                <p class="stat-desc">사용 가능한 계정</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">🔒</div>
              <div class="stat-content">
                <h3 class="stat-number" id="inactiveAccounts">0</h3>
                <p class="stat-label">비활성 계정</p>
                <p class="stat-desc">비활성화된 계정</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">🌐</div>
              <div class="stat-content">
                <h3 class="stat-number" id="onlineAccounts">0</h3>
                <p class="stat-label">접속중 계정</p>
                <p class="stat-desc">현재 로그인한 계정</p>
              </div>
            </div>
          </div>
        </div>

        <!-- 새 계정 생성 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">새 계정 생성</h2>
          </div>
          <div class="account-creation-form">
            <div class="form-row">
              <div class="form-group">
                <label for="newAccountId">계정 ID</label>
                <select id="newAccountId" class="form-select">
                  <option value="">계정 ID 선택</option>
                </select>
              </div>
              <div class="form-group">
                <label for="newAccountPw">초기 비밀번호</label>
                <input type="password" id="newAccountPw" class="form-input" placeholder="비밀번호 입력" maxlength="30">
              </div>
              <div class="form-group">
                <label for="newAccountDept">담당 부서</label>
                <select id="newAccountDept" class="form-select">
                  <option value="">부서 선택</option>
                </select>
              </div>
            </div>
            <button class="btn-primary" onclick="createNewAccount()">➕ 계정 생성</button>
            <div id="accountCreationMessage" class="login-message"></div>
          </div>
        </div>

        <!-- 계정 목록 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">계정 목록</h2>
            <div class="card-actions">
              <button class="btn-header" onclick="exportAccountData()">📊 계정 데이터 내보내기</button>
              <button class="btn-header secondary" onclick="refreshAccountData()">🔄 새로고침</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>번호</th>
                  <th>계정 ID</th>
                  <th>담당 부서</th>
                  <th>상태</th>
                  <th>생성일</th>
                  <th>마지막 로그인</th>
                  <th>관리</th>
                </tr>
              </thead>
              <tbody id="accountTableBody">
                <tr>
                  <td colspan="7" style="text-align: center; color: #999; padding: 40px;">
                    등록된 계정이 없습니다.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- 보안 설정 -->
      <div id="securityTab" class="tab-content">
        <!-- 시스템 보안 현황 -->
        <div class="security-stats">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">🔐</div>
              <div class="stat-content">
                <h3 class="stat-number" id="totalLogins">0</h3>
                <p class="stat-label">총 로그인 시도</p>
                <p class="stat-desc">전체 로그인 기록</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">✅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="successLogins">0</h3>
                <p class="stat-label">성공한 로그인</p>
                <p class="stat-desc">정상 로그인</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">❌</div>
              <div class="stat-content">
                <h3 class="stat-number" id="failedLogins">0</h3>
                <p class="stat-label">실패한 로그인</p>
                <p class="stat-desc">로그인 실패</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">🌐</div>
              <div class="stat-content">
                <h3 class="stat-number" id="onlineUsers">0</h3>
                <p class="stat-label">현재 접속자</p>
                <p class="stat-desc">실시간 접속자</p>
              </div>
            </div>
          </div>
        </div>

        <!-- 관리자 설정 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">관리자 설정</h2>
          </div>
          <div class="admin-settings">
            <div class="setting-item">
              <div class="setting-info">
                <h3>현재 관리자 계정</h3>
                <p>ID: <strong>OKADMIN</strong></p>
                <p>마지막 로그인: <span id="adminLastLogin">-</span></p>
              </div>
              <div class="setting-actions">
                <button class="btn-primary" onclick="showAdminPasswordChange()">비밀번호 변경</button>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <h3>시스템 설정</h3>
                <p>자동 로그아웃: <span id="autoLogoutTime">30분</span></p>
                <p>로그인 시도 제한: <span id="loginAttemptLimit">5회</span></p>
              </div>
              <div class="setting-actions">
                <button class="btn-primary" onclick="showSystemSettings()">시스템 설정</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 로그인 기록 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">로그인 기록</h2>
            <div class="card-actions">
              <button class="btn-header" onclick="exportLoginData()">📊 로그인 기록 내보내기</button>
              <button class="btn-header secondary" onclick="clearLoginRecords()">🗑️ 기록 삭제</button>
              <button class="btn-header secondary" onclick="refreshLoginData()">🔄 새로고침</button>
            </div>
          </div>
          <div class="login-filter">
            <div class="filter-row">
              <div class="form-group">
                <label for="loginUserFilter">사용자 필터</label>
                <select id="loginUserFilter" class="form-select">
                  <option value="">전체 사용자</option>
                </select>
              </div>
              <div class="form-group">
                <label for="loginStatusFilter">상태 필터</label>
                <select id="loginStatusFilter" class="form-select">
                  <option value="">전체 상태</option>
                  <option value="true">성공</option>
                  <option value="false">실패</option>
                </select>
              </div>
              <div class="form-group">
                <label for="loginDateFilter">날짜 필터</label>
                <input type="date" id="loginDateFilter" class="form-input">
              </div>
              <div class="form-group">
                <button class="btn-primary" onclick="applyLoginFilters()">필터 적용</button>
              </div>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>번호</th>
                  <th>사용자 ID</th>
                  <th>로그인 시간</th>
                  <th>상태</th>
                  <th>IP 주소</th>
                  <th>브라우저</th>
                </tr>
              </thead>
              <tbody id="loginRecordsBody">
                <tr>
                  <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
                    로그인 기록이 없습니다.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- 회의자료 총괄 탭 -->
      <div id="summaryTab" class="tab-content" style="display: none;">
        <div class="summary-header">
          <h2 class="summary-title">회의자료 총괄</h2>
          <div class="summary-controls">
            <div class="summary-filter">
              <label for="summaryYear">연도:</label>
              <select id="summaryYear" class="form-select">
                <option value="">연도 선택</option>
                <option value="2025">2025년</option>
              </select>
              <label for="summaryMonth">월:</label>
              <select id="summaryMonth" class="form-select">
                <option value="">월 선택</option>
                <option value="08">8월</option>
                <option value="09">9월</option>
                <option value="10">10월</option>
                <option value="11">11월</option>
                <option value="12">12월</option>
              </select>
              <label for="summaryType">회의구분:</label>
              <select id="summaryType" class="form-select">
                <option value="">회의구분 선택</option>
                <option value="monthly">월간간담회</option>
                <option value="week1">1주차 주간간담회</option>
                <option value="week2">2주차 주간간담회</option>
                <option value="week3">3주차 주간간담회</option>
                <option value="week4">4주차 주간간담회</option>
                <option value="week5">5주차 주간간담회</option>
              </select>
              <button class="btn-primary" onclick="loadSummaryData()">조회</button>
            </div>
            <div class="summary-actions">
              <button class="btn-secondary" onclick="exportSummaryPDF()">📄 PDF 출력</button>
              <button class="btn-secondary" onclick="exportSummaryExcel()">📊 Excel 내보내기</button>
            </div>
          </div>
        </div>
        
        <div class="summary-content">
          <div id="summaryInfo" class="summary-info" style="display: none;">
            <div class="summary-meeting-title" id="summaryMeetingTitle"></div>
            <div class="summary-stats">
              <div class="summary-stat">
                <span class="summary-stat-label">전체 부서:</span>
                <span class="summary-stat-value" id="summaryTotalDepts">16</span>
              </div>
              <div class="summary-stat">
                <span class="summary-stat-label">작성 완료:</span>
                <span class="summary-stat-value completed" id="summaryCompletedDepts">0</span>
              </div>
              <div class="summary-stat">
                <span class="summary-stat-label">미작성:</span>
                <span class="summary-stat-value pending" id="summaryPendingDepts">16</span>
              </div>
            </div>
          </div>
          
          <div id="summaryTable" class="summary-table-container" style="display: none;">
            <table class="summary-table">
              <thead>
                <tr>
                  <th>부서명</th>
                  <th>주요사항</th>
                  <th>전월(주) 추진실적</th>
                  <th>금월(주) 추진계획</th>
                  <th>작성자</th>
                  <th>작성일시</th>
                  <th>상태</th>
                </tr>
              </thead>
              <tbody id="summaryTableBody">
              </tbody>
            </table>
          </div>
          
          <div class="summary-empty" id="summaryEmpty" style="display: block;">
            <div class="empty-icon">📋</div>
            <div class="empty-text">회의를 선택하면 모든 부서의 회의자료를 확인할 수 있습니다.</div>
          </div>
        </div>
      </div>

      <!-- 작성자 회의 선택 -->
      <div id="writerContent" class="tab-content" style="display: none;">
        <!-- 보안 경고 문구 -->
        <div class="security-warning-banner">
          <div class="security-warning-content">
            <div class="security-icon">🔒</div>
            <div class="security-text">
              <div class="security-title">보안 주의사항</div>
              <div class="security-message">
                <p><strong>본 문서는 OK저축은행의 기밀정보로 무단 유출 시 법적 책임을 받을 수 있습니다.</strong></p>
                <p>모든 접속 기록 및 IP 주소가 실시간 모니터링되고 있으며, 정보보안 위반 시 엄중한 법적 조치가 취해집니다.</p>
              </div>
            </div>
          </div>
        </div>

        <!-- 회의 선택 화면 -->
        <div id="meetingSelector" class="meeting-selector">
          <h2 class="card-title" style="margin-bottom: 25px;">회의 선택</h2>
          <div class="selector-grid">
            <div class="selector-group">
              <label for="yearSelect">연도</label>
              <select id="yearSelect" class="form-select">
                <option value="">연도 선택</option>
                <option value="2025">2025년</option>
              </select>
            </div>
            <div class="selector-group">
              <label for="monthSelect">월</label>
              <select id="monthSelect" class="form-select">
                <option value="">월 선택</option>
                <option value="08">8월</option>
                <option value="09">9월</option>
                <option value="10">10월</option>
                <option value="11">11월</option>
                <option value="12">12월</option>
              </select>
            </div>
            <div class="selector-group">
              <label for="meetingTypeSelect">회의 구분</label>
              <select id="meetingTypeSelect" class="form-select">
                <option value="">회의 구분 선택</option>
                <option value="monthly">월간간담회</option>
                <option value="week1">1주차 주간간담회</option>
                <option value="week2">2주차 주간간담회</option>
                <option value="week3">3주차 주간간담회</option>
                <option value="week4">4주차 주간간담회</option>
                <option value="week5">5주차 주간간담회</option>
              </select>
            </div>
            <div class="selector-group">
              <label for="departmentSelect">담당 부서</label>
              <select id="departmentSelect" class="form-select">
                <option value="">부서 선택</option>
              </select>
            </div>
          </div>
          <button id="confirmBtn" class="btn-primary" onclick="goToMeeting()" disabled>회의자료 작성하기</button>
        </div>

        <!-- 회의자료 입력 화면 -->
        <div id="meetingForm" class="meeting-form" style="display: none;">
          <div class="form-header">
            <h2 class="form-title" id="selectedMeetingTitle">회의자료 작성</h2>
            <div class="form-subtitle">
              <span id="selectedMeetingInfo"></span>
              <span class="user-dept" id="writerDepartment"></span>
            </div>
            <div class="security-warning-compact">
              <span class="security-compact-icon">🔒</span>
              <span class="security-compact-text">기밀정보 · 무단유출금지 · 접속기록 모니터링</span>
            </div>
            <div id="infoMessage" class="info-message" style="display: none;"></div>
          </div>

          <div class="form-container">
            <div class="form-group">
              <label for="keyPoints" class="form-label">주요사항</label>
              <div class="textarea-container">
                <textarea id="keyPoints" class="form-textarea" rows="8" placeholder="주요사항을 입력해주세요..." maxlength="2000"></textarea>
                <div class="char-counter" id="keyPointsCounter">0 / 2000</div>
              </div>
            </div>

            <div class="form-group">
              <label for="previousResults" class="form-label">전월(주) 추진실적</label>
              <div class="textarea-container">
                <textarea id="previousResults" class="form-textarea" rows="8" placeholder="전월(주) 추진실적을 입력해주세요..." maxlength="2000"></textarea>
                <div class="char-counter" id="previousResultsCounter">0 / 2000</div>
              </div>
            </div>

            <div class="form-group">
              <label for="currentPlan" class="form-label">금월(주) 추진계획</label>
              <div class="textarea-container">
                <textarea id="currentPlan" class="form-textarea" rows="8" placeholder="금월(주) 추진계획을 입력해주세요..." maxlength="2000"></textarea>
                <div class="char-counter" id="currentPlanCounter">0 / 2000</div>
              </div>
            </div>

            <div class="form-actions">
              <button class="btn-secondary" onclick="goBackToSelector()">이전</button>
              <button class="btn-primary" onclick="saveMeetingData()">저장</button>
            </div>
          </div>
        </div>
      </div>
      </div>
    </div>
    
  <!-- 비밀번호 변경 모달 -->
  <div id="passwordModal" class="modal">
    <div class="modal-content">
      <h2 class="modal-title">비밀번호 변경</h2>
      <p class="modal-subtitle">보안을 위해 비밀번호를 변경해주세요.</p>
      <div class="form-group">
        <label for="currentPassword">현재 비밀번호</label>
        <input type="password" id="currentPassword" class="form-input">
      </div>
      <div class="form-group">
        <label for="newPassword">새 비밀번호</label>
        <input type="password" id="newPassword" class="form-input">
      </div>
      <div class="form-group">
        <label for="confirmPassword">비밀번호 확인</label>
        <input type="password" id="confirmPassword" class="form-input">
      </div>
      <button class="login-btn" onclick="changePassword()">비밀번호 변경</button>
      <div id="passwordMessage" class="login-message"></div>
    </div>
  </div>

  <script>
    // 전역 변수
    let currentUser = null;
    let currentUserRole = null;

    // 16개 부서 목록
    const departments = [
      '영업추진부', '리테일기획부', '모기지사업부', '심사부', 
      '리스크관리부', '경영관리본부(경영기획부)', '경영관리본부(IT기획부)', '미래디지털부',
      '소비자금융영업부', '소비자금융기획부', '신용관리부', '마케팅팀',
      '감사부', '준법지원부', '금융소비자보호부', '정보보안팀'
    ];

    // 초기 설정
    document.addEventListener('DOMContentLoaded', function() {
      initializeSystem();
    });

    function initializeSystem() {
      // 기본 관리자 계정 생성
      createDefaultAdminAccount();
      
      // 작성자 계정 생성 (OK 1 ~ OK 20)
      createWriterAccounts();
      
      // 로그인 상태 확인
      checkLoginStatus();
    }

    function createDefaultAdminAccount() {
      const savedAccounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const adminExists = savedAccounts.some(acc => acc.id === 'OKADMIN');
      
      if (!adminExists) {
        const adminAccount = {
          id: 'OKADMIN',
          password: '1234',
          role: 'admin',
          isFirstLogin: true,
          createdAt: new Date().toISOString()
        };
        savedAccounts.push(adminAccount);
        localStorage.setItem('systemAccounts', JSON.stringify(savedAccounts));
      }
    }

    function createWriterAccounts() {
      const savedAccounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      
      for (let i = 1; i <= 20; i++) {
        const accountId = `OK ${i}`;
        const accountExists = savedAccounts.some(acc => acc.id === accountId);
        
        if (!accountExists) {
          const writerAccount = {
            id: accountId,
            password: '1234',
            role: 'writer',
            isFirstLogin: true,
            createdAt: new Date().toISOString()
          };
          savedAccounts.push(writerAccount);
        }
      }
      
      localStorage.setItem('systemAccounts', JSON.stringify(savedAccounts));
    }

    function checkLoginStatus() {
      const savedUser = sessionStorage.getItem('currentUser');
      const savedRole = sessionStorage.getItem('currentUserRole');
      
      if (savedUser && savedRole) {
        currentUser = savedUser;
        currentUserRole = savedRole;
        showMainApp();
      } else {
        showLoginPage();
      }
    }

    function switchLoginType(type) {
      document.querySelectorAll('.login-type-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      document.getElementById('adminLoginForm').style.display = type === 'admin' ? 'block' : 'none';
      document.getElementById('writerLoginForm').style.display = type === 'writer' ? 'block' : 'none';
      hideMessage();
    }

    function handleAdminLogin() {
      const id = document.getElementById('adminId').value.trim();
      const password = document.getElementById('adminPassword').value.trim();
      
      if (!id || !password) {
        showMessage('ID와 비밀번호를 모두 입력해주세요.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const account = accounts.find(acc => acc.id === id && acc.password === password && acc.role === 'admin');
      
      if (account) {
        currentUser = account.id;
        currentUserRole = account.role;
        
        sessionStorage.setItem('currentUser', currentUser);
        sessionStorage.setItem('currentUserRole', currentUserRole);
        
        // 마지막 로그인 시간 업데이트
        const accountIndex = accounts.findIndex(acc => acc.id === id);
        if (accountIndex !== -1) {
          accounts[accountIndex].lastLogin = new Date().toISOString();
          localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        }
        
        if (account.isFirstLogin) {
          showPasswordModal();
        } else {
          showMainApp();
        }
        
        recordLoginAttempt(id, true);
      } else {
        showMessage('관리자 ID 또는 비밀번호가 올바르지 않습니다.', 'error');
        recordLoginAttempt(id, false);
      }
    }

    function handleWriterLogin() {
      const id = document.getElementById('writerId').value.trim();
      const password = document.getElementById('writerPassword').value.trim();
      
      if (!id || !password) {
        showMessage('ID와 비밀번호를 모두 입력해주세요.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const account = accounts.find(acc => acc.id === id && acc.password === password && acc.role === 'writer');
      
      if (account) {
        currentUser = account.id;
        currentUserRole = account.role;
        
        sessionStorage.setItem('currentUser', currentUser);
        sessionStorage.setItem('currentUserRole', currentUserRole);
        
        // 마지막 로그인 시간 업데이트
        const accountIndex = accounts.findIndex(acc => acc.id === id);
        if (accountIndex !== -1) {
          accounts[accountIndex].lastLogin = new Date().toISOString();
          localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        }
        
        if (account.isFirstLogin) {
          showPasswordModal();
        } else {
          // 작성자 로그인 시 보안 안내 문구 표시
          setTimeout(() => {
            alert('🔒 로그인 성공\n\n보안 주의사항:\n• 본 시스템은 기밀정보 처리 시스템입니다\n• 모든 접속 기록이 실시간 모니터링됩니다\n• 정보 유출 시 법적 책임을 질 수 있습니다\n\n보안 규정을 준수하여 업무하세요.');
          }, 500);
          showMainApp();
        }
        
        recordLoginAttempt(id, true);
      } else {
        showMessage('작성자 ID 또는 비밀번호가 올바르지 않습니다.', 'error');
        recordLoginAttempt(id, false);
      }
    }

    function showPasswordModal() {
      document.getElementById('passwordModal').style.display = 'flex';
    }

    function changePassword() {
      const currentPassword = document.getElementById('currentPassword').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      if (!currentPassword || !newPassword || !confirmPassword) {
        showPasswordMessage('모든 필드를 입력해주세요.', 'error');
        return;
      }
      
      if (newPassword !== confirmPassword) {
        showPasswordMessage('새 비밀번호와 확인 비밀번호가 일치하지 않습니다.', 'error');
        return;
      }
      
      if (newPassword.length < 4) {
        showPasswordMessage('비밀번호는 4자 이상이어야 합니다.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const accountIndex = accounts.findIndex(acc => acc.id === currentUser);
      
      if (accountIndex !== -1 && accounts[accountIndex].password === currentPassword) {
        accounts[accountIndex].password = newPassword;
        accounts[accountIndex].isFirstLogin = false;
        localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        
        showPasswordMessage('비밀번호가 성공적으로 변경되었습니다.', 'success');
        
        setTimeout(() => {
          document.getElementById('passwordModal').style.display = 'none';
          showMainApp();
        }, 2000);
      } else {
        showPasswordMessage('현재 비밀번호가 올바르지 않습니다.', 'error');
      }
    }

    function showMainApp() {
      document.getElementById('loginPage').style.display = 'none';
      document.getElementById('mainApp').style.display = 'block';
      
      // 사용자 정보 표시
      document.getElementById('userInfo').textContent = `${currentUser} (${currentUserRole === 'admin' ? '관리자' : '작성자'})`;
      
      if (currentUserRole === 'admin') {
        document.getElementById('headerTitle').textContent = '관리자 대시보드';
        document.getElementById('adminTabs').style.display = 'block';
        document.getElementById('dashboardTab').style.display = 'block';
        document.getElementById('writerContent').style.display = 'none';
        
        // 관리자 대시보드 초기화
        initializeAdminDashboard();
        
        // 탭 초기화
        document.getElementById('dashboardTab').style.display = 'block';
        document.getElementById('summaryTab').style.display = 'none';
        document.getElementById('accountsTab').style.display = 'none';
        document.getElementById('securityTab').style.display = 'none';
        document.getElementById('writerContent').style.display = 'none';
      } else {
        document.getElementById('headerTitle').textContent = '회의자료 작성 시스템';
        document.getElementById('adminTabs').style.display = 'none';
        document.getElementById('dashboardTab').style.display = 'none';
        document.getElementById('summaryTab').style.display = 'none';
        document.getElementById('accountsTab').style.display = 'none';
        document.getElementById('securityTab').style.display = 'none';
        document.getElementById('writerContent').style.display = 'block';
        
        // 작성자 화면 초기화
        loadWriterInterface();
      }
    }

    function showLoginPage() {
      document.getElementById('loginPage').style.display = 'flex';
      document.getElementById('mainApp').style.display = 'none';
    }

    function logout() {
      // 작성자 로그아웃 시 보안 안내 문구 표시
      if (currentUserRole === 'writer') {
        alert('🔒 로그아웃 완료\n\n보안 안내사항:\n• 회의자료는 기밀정보로 무단 유출 금지\n• 접속 기록이 모니터링됨\n• 정보보안 정책 준수 필수\n\n안전한 업무 되세요.');
      }
      
      sessionStorage.removeItem('currentUser');
      sessionStorage.removeItem('currentUserRole');
      currentUser = null;
      currentUserRole = null;
      
      // 폼 초기화
      document.getElementById('adminId').value = 'OKADMIN';
      document.getElementById('adminPassword').value = '';
      document.getElementById('writerId').value = '';
      document.getElementById('writerPassword').value = '';
      
      hideMessage();
      showLoginPage();
    }

    function switchTab(tabName) {
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      document.querySelectorAll('.tab-content').forEach(content => {
        content.style.display = 'none';
      });
      
      document.getElementById(tabName + 'Tab').style.display = 'block';
      
      // 회의자료 총괄 탭이 선택된 경우 초기화
      if (tabName === 'summary') {
        initializeSummaryTab();
      }
    }

    function showMessage(message, type) {
      const messageElement = document.getElementById('loginMessage');
      messageElement.textContent = message;
      messageElement.className = `login-message ${type}`;
      messageElement.style.display = 'block';
    }

    function hideMessage() {
      document.getElementById('loginMessage').style.display = 'none';
    }

    function showPasswordMessage(message, type) {
      const messageElement = document.getElementById('passwordMessage');
      messageElement.textContent = message;
      messageElement.className = `login-message ${type}`;
      messageElement.style.display = 'block';
    }

    function recordLoginAttempt(userId, success) {
        const records = JSON.parse(localStorage.getItem('loginRecords') || '[]');
        const newRecord = {
          userId: userId,
        timestamp: new Date().toISOString(),
          success: success,
        ip: 'localhost', // 실제 구현에서는 IP를 가져오는 로직 추가
        userAgent: navigator.userAgent
        };
        
        records.push(newRecord);
        
      // 최대 1000개 기록 유지
      if (records.length > 1000) {
        records.splice(0, records.length - 1000);
        }
        
        localStorage.setItem('loginRecords', JSON.stringify(records));
    }

    // ========== 회의자료 총괄 기능 ==========

    // 총괄 탭 초기화
    function initializeSummaryTab() {
      document.getElementById('summaryInfo').style.display = 'none';
      document.getElementById('summaryTable').style.display = 'none';
      document.getElementById('summaryEmpty').style.display = 'block';
      
      // 필터 초기화
      document.getElementById('summaryYear').value = '';
      document.getElementById('summaryMonth').value = '';
      document.getElementById('summaryType').value = '';
    }

    // 총괄 데이터 로드
    function loadSummaryData() {
      const year = document.getElementById('summaryYear').value;
      const month = document.getElementById('summaryMonth').value;
      const type = document.getElementById('summaryType').value;
      
      if (!year || !month || !type) {
        alert('연도, 월, 회의구분을 모두 선택해주세요.');
        return;
      }
      
      const meetingKey = `${year}-${month}-${type}`;
      
      // 회의 유형 한글 변환
      const meetingTypeKorean = {
        'monthly': '월간간담회',
        'week1': '1주차 주간간담회',
        'week2': '2주차 주간간담회',
        'week3': '3주차 주간간담회',
        'week4': '4주차 주간간담회',
        'week5': '5주차 주간간담회'
      };
      
      // 제목 설정
      document.getElementById('summaryMeetingTitle').textContent = 
        `${year}년 ${month}월 ${meetingTypeKorean[type]} 회의자료 총괄`;
      
      // 모든 부서 데이터 수집
      const summaryData = [];
      let completedCount = 0;
      
      departments.forEach(dept => {
        const savedData = JSON.parse(localStorage.getItem(`meetingData_${meetingKey}_${dept}`) || '{}');
        
        const hasData = savedData.keyPoints || savedData.previousResults || savedData.currentPlan;
        const isCompleted = savedData.keyPoints && savedData.previousResults && savedData.currentPlan;
        
        if (hasData && isCompleted) {
          completedCount++;
        }
        
        summaryData.push({
          department: dept,
          keyPoints: savedData.keyPoints || '',
          previousResults: savedData.previousResults || '',
          currentPlan: savedData.currentPlan || '',
          writer: savedData.writer || '',
          savedAt: savedData.savedAt || '',
          hasData: hasData,
          isCompleted: isCompleted
        });
      });
      
      // 통계 업데이트
      document.getElementById('summaryTotalDepts').textContent = departments.length;
      document.getElementById('summaryCompletedDepts').textContent = completedCount;
      document.getElementById('summaryPendingDepts').textContent = departments.length - completedCount;
      
      // 테이블 렌더링
      renderSummaryTable(summaryData);
      
      // 화면 표시
      document.getElementById('summaryEmpty').style.display = 'none';
      document.getElementById('summaryInfo').style.display = 'block';
      document.getElementById('summaryTable').style.display = 'block';
    }

    // 총괄 테이블 렌더링
    function renderSummaryTable(summaryData) {
      const tbody = document.getElementById('summaryTableBody');
      tbody.innerHTML = '';
      
      summaryData.forEach(data => {
        const row = document.createElement('tr');
        
        // 상태 텍스트
        const statusText = data.isCompleted ? '완료' : (data.hasData ? '부분완료' : '미작성');
        const statusClass = data.isCompleted ? 'status-completed' : 'status-empty';
        
        // 저장일시 포맷팅
        const savedDate = data.savedAt ? new Date(data.savedAt).toLocaleString('ko-KR') : '';
        
        row.innerHTML = `
          <td><strong>${data.department}</strong></td>
          <td class="content-cell">${data.keyPoints || '<span style="color: #999;">미작성</span>'}</td>
          <td class="content-cell">${data.previousResults || '<span style="color: #999;">미작성</span>'}</td>
          <td class="content-cell">${data.currentPlan || '<span style="color: #999;">미작성</span>'}</td>
          <td>${data.writer || ''}</td>
          <td>${savedDate || ''}</td>
          <td class="${statusClass}">${statusText}</td>
        `;
        
        tbody.appendChild(row);
      });
    }

    // PDF 출력
    function exportSummaryPDF() {
      const year = document.getElementById('summaryYear').value;
      const month = document.getElementById('summaryMonth').value;
      const type = document.getElementById('summaryType').value;
      
      if (!year || !month || !type) {
        alert('먼저 회의를 조회해주세요.');
        return;
      }
      
      const meetingTypeKorean = {
        'monthly': '월간간담회',
        'week1': '1주차 주간간담회',
        'week2': '2주차 주간간담회',
        'week3': '3주차 주간간담회',
        'week4': '4주차 주간간담회',
        'week5': '5주차 주간간담회'
      };
      
      const meetingKey = `${year}-${month}-${type}`;
      const meetingTitle = `${year}년 ${month}월 ${meetingTypeKorean[type]} 회의자료 총괄`;
      
      // 새 창을 열어서 PDF로 출력
      const printWindow = window.open('', '_blank');
      
      let printContent = `
        <!DOCTYPE html>
        <html>
        <head>
          <title>${meetingTitle}</title>
          <style>
            body { font-family: 'Malgun Gothic', sans-serif; margin: 20px; }
            h1 { text-align: center; color: #333; margin-bottom: 30px; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f5f5f5; font-weight: bold; }
            .completed { color: #4caf50; font-weight: bold; }
            .empty { color: #ff9800; font-weight: bold; }
            .footer { margin-top: 30px; text-align: center; color: #666; }
            @media print {
              body { margin: 0; }
              table { page-break-inside: avoid; }
            }
          </style>
        </head>
        <body>
          <h1>${meetingTitle}</h1>
          <table>
            <thead>
              <tr>
                <th>부서명</th>
                <th>주요사항</th>
                <th>전월(주) 추진실적</th>
                <th>금월(주) 추진계획</th>
                <th>작성자</th>
                <th>작성일시</th>
                <th>상태</th>
              </tr>
            </thead>
            <tbody>
      `;
      
      departments.forEach(dept => {
        const savedData = JSON.parse(localStorage.getItem(`meetingData_${meetingKey}_${dept}`) || '{}');
        const hasData = savedData.keyPoints || savedData.previousResults || savedData.currentPlan;
        const isCompleted = savedData.keyPoints && savedData.previousResults && savedData.currentPlan;
        const statusText = isCompleted ? '완료' : (hasData ? '부분완료' : '미작성');
        const statusClass = isCompleted ? 'completed' : 'empty';
        const savedDate = savedData.savedAt ? new Date(savedData.savedAt).toLocaleString('ko-KR') : '';
        
        printContent += `
          <tr>
            <td><strong>${dept}</strong></td>
            <td>${savedData.keyPoints || '미작성'}</td>
            <td>${savedData.previousResults || '미작성'}</td>
            <td>${savedData.currentPlan || '미작성'}</td>
            <td>${savedData.writer || ''}</td>
            <td>${savedDate || ''}</td>
            <td class="${statusClass}">${statusText}</td>
          </tr>
        `;
      });
      
      printContent += `
            </tbody>
          </table>
          <div class="footer">
            <p>OK저축은행 회의자료 관리 시스템 - 출력일시: ${new Date().toLocaleString('ko-KR')}</p>
          </div>
        </body>
        </html>
      `;
      
      printWindow.document.write(printContent);
      printWindow.document.close();
      
      // 약간의 지연 후 출력 대화상자 열기
      setTimeout(() => {
        printWindow.print();
      }, 500);
    }

    // Excel 내보내기
    function exportSummaryExcel() {
      const year = document.getElementById('summaryYear').value;
      const month = document.getElementById('summaryMonth').value;
      const type = document.getElementById('summaryType').value;
      
      if (!year || !month || !type) {
        alert('먼저 회의를 조회해주세요.');
        return;
      }
      
      const meetingTypeKorean = {
        'monthly': '월간간담회',
        'week1': '1주차 주간간담회',
        'week2': '2주차 주간간담회',
        'week3': '3주차 주간간담회',
        'week4': '4주차 주간간담회',
        'week5': '5주차 주간간담회'
      };
      
      const meetingKey = `${year}-${month}-${type}`;
      const meetingTitle = `${year}년 ${month}월 ${meetingTypeKorean[type]} 회의자료 총괄`;
      
      let csvContent = `${meetingTitle}\n`;
      csvContent += "부서명,주요사항,전월(주) 추진실적,금월(주) 추진계획,작성자,작성일시,상태\n";
      
      departments.forEach(dept => {
        const savedData = JSON.parse(localStorage.getItem(`meetingData_${meetingKey}_${dept}`) || '{}');
        const hasData = savedData.keyPoints || savedData.previousResults || savedData.currentPlan;
        const isCompleted = savedData.keyPoints && savedData.previousResults && savedData.currentPlan;
        const statusText = isCompleted ? '완료' : (hasData ? '부분완료' : '미작성');
        const savedDate = savedData.savedAt ? new Date(savedData.savedAt).toLocaleString('ko-KR') : '';
        
        // CSV 포맷팅 (쉼표와 줄바꿈 처리)
        const formatCell = (text) => {
          if (!text) return '';
          text = text.replace(/"/g, '""');
          if (text.includes(',') || text.includes('\n') || text.includes('"')) {
            return `"${text}"`;
          }
          return text;
        };
        
        csvContent += `${formatCell(dept)},${formatCell(savedData.keyPoints || '')},${formatCell(savedData.previousResults || '')},${formatCell(savedData.currentPlan || '')},${formatCell(savedData.writer || '')},${formatCell(savedDate)},${formatCell(statusText)}\n`;
      });
      
      // BOM 추가 (한글 깨짐 방지)
      const BOM = '\uFEFF';
      const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
      const link = document.createElement('a');
      const url = URL.createObjectURL(blob);
      
      link.setAttribute('href', url);
      link.setAttribute('download', `${meetingTitle}_${new Date().toISOString().split('T')[0]}.csv`);
      link.style.visibility = 'hidden';
      
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
      
      alert('Excel 파일이 다운로드되었습니다.');
    }

    // 작성자 회의 선택 로직
    function goToMeeting() {
      const year = document.getElementById('yearSelect').value;
      const month = document.getElementById('monthSelect').value;
      const meetingType = document.getElementById('meetingTypeSelect').value;
      const department = document.getElementById('departmentSelect').value;
      
      if (!year || !month || !meetingType || !department) {
        // 선택되지 않은 항목 확인
        const missingItems = [];
        if (!year) missingItems.push('연도');
        if (!month) missingItems.push('월');
        if (!meetingType) missingItems.push('회의 구분');
        if (!department) missingItems.push('담당 부서');
        
        alert(`다음 항목을 선택해주세요: ${missingItems.join(', ')}`);
        return;
      }
      
      // 회의 유형 한글 변환
      const meetingTypeKorean = {
        'monthly': '월간간담회',
        'week1': '1주차 주간간담회',
        'week2': '2주차 주간간담회',
        'week3': '3주차 주간간담회',
        'week4': '4주차 주간간담회',
        'week5': '5주차 주간간담회'
      };
      
      // 선택된 회의 정보 표시
      document.getElementById('selectedMeetingInfo').textContent = `${year}년 ${month}월 ${meetingTypeKorean[meetingType]}`;
      document.getElementById('writerDepartment').textContent = department;
      
      // 기존 데이터 로드
      loadExistingMeetingData(year, month, meetingType, department);
      
      // 화면 전환
      document.getElementById('meetingSelector').style.display = 'none';
      document.getElementById('meetingForm').style.display = 'block';
    }

    // 기존 회의 데이터 로드
    function loadExistingMeetingData(year, month, meetingType, department) {
      const meetingKey = `${year}-${month}-${meetingType}`;
      const departmentKey = department;
      
      // 로컬 스토리지에서 기존 데이터 불러오기
      const savedData = JSON.parse(localStorage.getItem(`meetingData_${meetingKey}_${departmentKey}`) || '{}');
      
      // 입력 필드에 기존 데이터 설정
      document.getElementById('keyPoints').value = savedData.keyPoints || '';
      document.getElementById('previousResults').value = savedData.previousResults || '';
      document.getElementById('currentPlan').value = savedData.currentPlan || '';
      
      // 기존 데이터가 있으면 경고 메시지 표시
      if (savedData.keyPoints || savedData.previousResults || savedData.currentPlan) {
        const savedDate = savedData.savedAt ? new Date(savedData.savedAt).toLocaleString('ko-KR') : '알 수 없음';
        showInfoMessage(`기존 저장된 데이터가 있습니다. (저장 시간: ${savedDate})`, 'info');
      }
      
      // 문자 수 카운터 업데이트
      setTimeout(() => {
        const textareas = [
          { id: 'keyPoints', counterId: 'keyPointsCounter' },
          { id: 'previousResults', counterId: 'previousResultsCounter' },
          { id: 'currentPlan', counterId: 'currentPlanCounter' }
        ];
        
        textareas.forEach(({ id, counterId }) => {
          const textarea = document.getElementById(id);
          const counter = document.getElementById(counterId);
          if (textarea && counter) {
            updateCharacterCounter(textarea, counter);
          }
        });
      }, 100);
    }

    // 회의 선택 화면으로 돌아가기
    function goBackToSelector() {
      const keyPoints = document.getElementById('keyPoints').value.trim();
      const previousResults = document.getElementById('previousResults').value.trim();
      const currentPlan = document.getElementById('currentPlan').value.trim();
      
      // 입력된 내용이 있으면 확인 메시지 표시
      if (keyPoints || previousResults || currentPlan) {
        if (!confirm('입력된 내용이 있습니다. 저장하지 않고 이전 화면으로 돌아가시겠습니까?')) {
          return;
        }
      }
      
      document.getElementById('meetingForm').style.display = 'none';
      document.getElementById('meetingSelector').style.display = 'block';
      hideInfoMessage();
    }

    // 회의 데이터 저장
    function saveMeetingData() {
      const year = document.getElementById('yearSelect').value;
      const month = document.getElementById('monthSelect').value;
      const meetingType = document.getElementById('meetingTypeSelect').value;
      const department = document.getElementById('departmentSelect').value;
      const keyPoints = document.getElementById('keyPoints').value.trim();
      const previousResults = document.getElementById('previousResults').value.trim();
      const currentPlan = document.getElementById('currentPlan').value.trim();
      
      // 입력 검증
      const validationResult = validateMeetingData(keyPoints, previousResults, currentPlan);
      if (!validationResult.isValid) {
        alert(validationResult.message);
        return;
      }
      
      // 기존 데이터 확인 및 덮어쓰기 경고
      const meetingKey = `${year}-${month}-${meetingType}`;
      const departmentKey = department;
      const existingData = JSON.parse(localStorage.getItem(`meetingData_${meetingKey}_${departmentKey}`) || '{}');
      
      if (existingData.keyPoints || existingData.previousResults || existingData.currentPlan) {
        const existingDate = existingData.savedAt ? new Date(existingData.savedAt).toLocaleString('ko-KR') : '알 수 없음';
        if (!confirm(`이미 저장된 회의자료가 있습니다.\n(저장 시간: ${existingDate})\n\n기존 데이터를 덮어쓰시겠습니까?`)) {
          return;
        }
      }
      
      // 저장 전 최종 확인 (보안 동의 포함)
      const securityConfirmMessage = `다음 사항에 동의하시고 회의자료를 저장하시겠습니까?

📋 회의자료 저장 및 보안 동의사항:
✓ 본 문서는 OK저축은행의 기밀정보입니다
✓ 무단 유출 시 법적 책임을 질 수 있습니다  
✓ 모든 접속 기록이 실시간 모니터링됩니다
✓ 정보보안 정책을 준수합니다

저장하시겠습니까?`;

      if (!confirm(securityConfirmMessage)) {
        return;
      }
      
      // 데이터 저장
      const meetingData = {
        keyPoints: keyPoints,
        previousResults: previousResults,
        currentPlan: currentPlan,
        savedAt: new Date().toISOString(),
        department: departmentKey,
        writer: currentUser  // 실제 작성자 정보 추가
      };
      
      try {
        localStorage.setItem(`meetingData_${meetingKey}_${departmentKey}`, JSON.stringify(meetingData));
        
        // 회의 현황 업데이트 (관리자용)
        updateMeetingStatus(meetingKey, departmentKey, meetingData);
        
        alert('회의자료가 성공적으로 저장되었습니다!');
        
        // 선택 화면으로 돌아가기
        goBackToSelector();
        
        // 입력 폼 초기화
        document.getElementById('keyPoints').value = '';
        document.getElementById('previousResults').value = '';
        document.getElementById('currentPlan').value = '';
        
        // 선택 필드 초기화
        document.getElementById('departmentSelect').value = '';
        
      } catch (error) {
        alert('저장 중 오류가 발생했습니다. 다시 시도해주세요.');
        console.error('저장 오류:', error);
      }
    }

    // 입력 데이터 검증
    function validateMeetingData(keyPoints, previousResults, currentPlan) {
      // 최소 한 개 이상의 항목 입력 확인
      if (!keyPoints && !previousResults && !currentPlan) {
        return {
          isValid: false,
          message: '최소 한 개 이상의 항목을 입력해주세요.'
        };
      }
      
      // 각 필드별 최소 길이 확인
      const emptyFields = [];
      if (!keyPoints) emptyFields.push('주요사항');
      if (!previousResults) emptyFields.push('전월(주) 추진실적');
      if (!currentPlan) emptyFields.push('금월(주) 추진계획');
      
      if (emptyFields.length > 0) {
        const fieldList = emptyFields.join(', ');
        if (!confirm(`다음 항목이 비어있습니다: ${fieldList}\n\n비어있는 항목이 있어도 저장하시겠습니까?`)) {
          return {
            isValid: false,
            message: '저장이 취소되었습니다.'
          };
        }
      }
      
      // 각 필드 길이 제한 확인 (각 필드 최대 2000자)
      const maxLength = 2000;
      if (keyPoints.length > maxLength) {
        return {
          isValid: false,
          message: `주요사항은 ${maxLength}자를 초과할 수 없습니다. (현재: ${keyPoints.length}자)`
        };
      }
      
      if (previousResults.length > maxLength) {
        return {
          isValid: false,
          message: `전월(주) 추진실적은 ${maxLength}자를 초과할 수 없습니다. (현재: ${previousResults.length}자)`
        };
      }
      
      if (currentPlan.length > maxLength) {
        return {
          isValid: false,
          message: `금월(주) 추진계획은 ${maxLength}자를 초과할 수 없습니다. (현재: ${currentPlan.length}자)`
        };
      }
      
      // 각 필드 최소 길이 권장 (10자 이상)
      const minRecommendedLength = 10;
      const shortFields = [];
      if (keyPoints && keyPoints.length < minRecommendedLength) shortFields.push('주요사항');
      if (previousResults && previousResults.length < minRecommendedLength) shortFields.push('전월(주) 추진실적');
      if (currentPlan && currentPlan.length < minRecommendedLength) shortFields.push('금월(주) 추진계획');
      
      if (shortFields.length > 0) {
        const fieldList = shortFields.join(', ');
        if (!confirm(`다음 항목이 너무 짧습니다 (${minRecommendedLength}자 미만): ${fieldList}\n\n계속 저장하시겠습니까?`)) {
          return {
            isValid: false,
            message: '저장이 취소되었습니다.'
          };
        }
      }
      
      return { isValid: true };
    }

    // 정보 메시지 표시
    function showInfoMessage(message, type = 'info') {
      const messageElement = document.getElementById('infoMessage');
      if (messageElement) {
        messageElement.textContent = message;
        messageElement.className = `info-message ${type}`;
        messageElement.style.display = 'block';
        
        // 5초 후 자동 숨김
        setTimeout(() => {
          hideInfoMessage();
        }, 5000);
      }
    }

    // 정보 메시지 숨김
    function hideInfoMessage() {
      const messageElement = document.getElementById('infoMessage');
      if (messageElement) {
        messageElement.style.display = 'none';
      }
    }

    // 관리자용 회의 현황 업데이트
    function updateMeetingStatus(meetingKey, departmentKey, meetingData) {
      const meetingStatus = JSON.parse(localStorage.getItem('meetingStatus') || '{}');
      
      if (!meetingStatus[meetingKey]) {
        meetingStatus[meetingKey] = {};
      }
      
      meetingStatus[meetingKey][departmentKey] = {
        status: 'completed',
        lastUpdated: new Date().toISOString(),
        hasData: !!(meetingData.keyPoints || meetingData.previousResults || meetingData.currentPlan)
      };
      
      localStorage.setItem('meetingStatus', JSON.stringify(meetingStatus));
    }

    // 작성자 화면 초기화
    function loadWriterInterface() {
      // 회의 선택 화면을 기본으로 표시
      document.getElementById('meetingSelector').style.display = 'block';
      document.getElementById('meetingForm').style.display = 'none';
      
      // 선택 필드 초기화
      document.getElementById('yearSelect').value = '';
      document.getElementById('monthSelect').value = '';
      document.getElementById('meetingTypeSelect').value = '';
      document.getElementById('departmentSelect').value = '';
      document.getElementById('confirmBtn').disabled = true;
      
      // 부서 목록 로드
      loadDepartmentOptions();
      
      // 입력 폼 초기화
      document.getElementById('keyPoints').value = '';
      document.getElementById('previousResults').value = '';
      document.getElementById('currentPlan').value = '';
      
      // 문자 수 카운터 초기화
      setupCharacterCounters();
      
      // 페이지 이탈 방지 설정
      setupPageLeaveWarning();
    }

    // 부서 선택 옵션 로드
    function loadDepartmentOptions() {
      const departmentSelect = document.getElementById('departmentSelect');
      departmentSelect.innerHTML = '<option value="">부서 선택</option>';
      
      departments.forEach(dept => {
        const option = document.createElement('option');
        option.value = dept;
        option.textContent = dept;
        departmentSelect.appendChild(option);
      });
    }

    // 페이지 이탈 방지 경고 설정
    function setupPageLeaveWarning() {
      window.addEventListener('beforeunload', function(e) {
        // 작성자 화면의 입력 폼이 보이고 있고, 입력된 내용이 있는 경우에만 경고
        const meetingForm = document.getElementById('meetingForm');
        if (meetingForm && meetingForm.style.display !== 'none') {
          const keyPoints = document.getElementById('keyPoints').value.trim();
          const previousResults = document.getElementById('previousResults').value.trim();
          const currentPlan = document.getElementById('currentPlan').value.trim();
          
          if (keyPoints || previousResults || currentPlan) {
            e.preventDefault();
            e.returnValue = '입력된 내용이 저장되지 않았습니다. 정말 페이지를 나가시겠습니까?';
            return e.returnValue;
          }
        }
      });
    }

    // 문자 수 카운터 설정
    function setupCharacterCounters() {
      const textareas = [
        { id: 'keyPoints', counterId: 'keyPointsCounter' },
        { id: 'previousResults', counterId: 'previousResultsCounter' },
        { id: 'currentPlan', counterId: 'currentPlanCounter' }
      ];
      
      textareas.forEach(({ id, counterId }) => {
        const textarea = document.getElementById(id);
        const counter = document.getElementById(counterId);
        
        if (textarea && counter) {
          // 초기 카운터 업데이트
          updateCharacterCounter(textarea, counter);
          
          // 입력 이벤트 리스너 추가
          textarea.addEventListener('input', function() {
            updateCharacterCounter(textarea, counter);
          });
        }
      });
    }

    // 문자 수 카운터 업데이트
    function updateCharacterCounter(textarea, counter) {
      const currentLength = textarea.value.length;
      const maxLength = parseInt(textarea.getAttribute('maxlength')) || 2000;
      
      counter.textContent = `${currentLength} / ${maxLength}`;
      
      // 경고 색상 적용
      counter.classList.remove('warning', 'error');
      
      if (currentLength > maxLength * 0.9) {
        counter.classList.add('error');
      } else if (currentLength > maxLength * 0.8) {
        counter.classList.add('warning');
      }
    }

    // 회의 선택 유효성 검사
    document.addEventListener('DOMContentLoaded', function() {
      const selectors = ['yearSelect', 'monthSelect', 'meetingTypeSelect', 'departmentSelect'];
      selectors.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          element.addEventListener('change', function() {
            checkMeetingSelection();
          });
        }
      });
    });

    function checkMeetingSelection() {
      const year = document.getElementById('yearSelect').value;
      const month = document.getElementById('monthSelect').value;
      const meetingType = document.getElementById('meetingTypeSelect').value;
      const department = document.getElementById('departmentSelect').value;
      
      document.getElementById('confirmBtn').disabled = !(year && month && meetingType && department);
    }

    // 엔터 키 이벤트
    document.getElementById('adminPassword').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        handleAdminLogin();
      }
    });

    document.getElementById('writerPassword').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        handleWriterLogin();
      }
    });

    // ========== 대시보드 기능 ==========
    let meetingData = {};
    let currentMeetingData = [];
    let selectedMeeting = null;

    // 대시보드 초기화
    function initializeDashboard() {
      loadMeetingData();
      updateDashboardStats();
      setupFilterEventListeners();
    }

    // 회의 데이터 로드
    function loadMeetingData() {
      meetingData = JSON.parse(localStorage.getItem('meetingData') || '{}');
    }

    // 필터 이벤트 리스너 설정
    function setupFilterEventListeners() {
      const filterIds = ['filterYear', 'filterMonth', 'filterType'];
      filterIds.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          element.addEventListener('change', checkSearchValid);
        }
      });
    }

    // 검색 버튼 활성화 체크
    function checkSearchValid() {
      const year = document.getElementById('filterYear').value;
      const month = document.getElementById('filterMonth').value;
      const type = document.getElementById('filterType').value;
      
      const searchBtn = document.getElementById('searchBtn');
      if (searchBtn) {
        searchBtn.disabled = !(year && month && type);
      }
    }

    // 회의 검색
    function searchMeeting() {
      const year = document.getElementById('filterYear').value;
      const month = document.getElementById('filterMonth').value;
      const type = document.getElementById('filterType').value;
      
      if (!year || !month || !type) {
        alert('모든 항목을 선택해주세요.');
        return;
      }
      
      const meetingId = `${year}-${month}-${type}`;
      const meetingName = generateMeetingName(year, month, type);
      
      selectedMeeting = {
        id: meetingId,
        name: meetingName,
        year,
        month,
        type
      };
      
      // 부서별 데이터 준비
      currentMeetingData = [];
      departments.forEach(dept => {
        const deptData = meetingData[meetingId] ? meetingData[meetingId][dept] : null;
        const status = getDepartmentStatus(deptData);
        const lastModified = getLastModified(deptData);
        
        currentMeetingData.push({
          meetingId,
          meetingName,
          department: dept,
          status,
          lastModified,
          data: deptData
        });
      });
      
      updateDashboardStats();
      renderMeetingTable();
    }

    // 회의명 생성
    function generateMeetingName(year, month, type) {
      const monthName = parseInt(month) + '월';
      if (type === 'monthly') {
        return `${year}년 ${monthName} 월간간담회`;
      } else {
        const weekNum = type.replace('week', '');
        return `${year}년 ${monthName} ${weekNum}주차 주간간담회`;
      }
    }

    // 부서 상태 확인
    function getDepartmentStatus(deptData) {
      if (!deptData) return 'not-started';
      if (deptData.completed) return 'completed';
      
      const hasContent = Object.keys(deptData).some(key => 
        key !== 'completed' && key !== 'lastModified' && 
        deptData[key] && deptData[key].toString().trim() !== ''
      );
      
      return hasContent ? 'pending' : 'not-started';
    }

    // 마지막 수정일 확인
    function getLastModified(deptData) {
      if (!deptData || !deptData.lastModified) return '-';
      const date = new Date(deptData.lastModified);
      return date.toLocaleDateString('ko-KR') + ' ' + date.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'});
    }

    // 대시보드 통계 업데이트
    function updateDashboardStats() {
      const stats = calculateStats();
      
      document.getElementById('totalMeetings').textContent = stats.totalDepartments;
      document.getElementById('completedTasks').textContent = stats.completed;
      document.getElementById('pendingTasks').textContent = stats.pending;
      document.getElementById('notStartedTasks').textContent = stats.notStarted;
    }

    // 통계 계산
    function calculateStats() {
      if (!selectedMeeting) {
        return { totalDepartments: 16, completed: 0, pending: 0, notStarted: 16 };
      }
      
      const totalDepartments = departments.length;
      let completed = 0;
      let pending = 0;
      let notStarted = 0;
      
      // 작성자가 저장한 실제 데이터 확인
      departments.forEach(department => {
        const savedData = JSON.parse(localStorage.getItem(`meetingData_${selectedMeeting}_${department}`) || '{}');
        
        if (savedData.keyPoints || savedData.previousResults || savedData.currentPlan) {
          // 모든 필드가 채워졌는지 확인
          if (savedData.keyPoints && savedData.previousResults && savedData.currentPlan) {
            completed++;
          } else {
            pending++;
          }
        } else {
          notStarted++;
        }
      });
      
      return { totalDepartments, completed, pending, notStarted };
    }

    // 회의 테이블 렌더링
    function renderMeetingTable() {
      const emptyState = document.getElementById('emptyState');
      const tableContainer = document.getElementById('dataTableContainer');
      const tableBody = document.getElementById('dataTableBody');
      
      if (!selectedMeeting || currentMeetingData.length === 0) {
        emptyState.style.display = 'block';
        tableContainer.style.display = 'none';
        return;
      }
      
      emptyState.style.display = 'none';
      tableContainer.style.display = 'block';
      
      tableBody.innerHTML = '';
      currentMeetingData.forEach(item => {
        const row = createTableRow(item);
        tableBody.appendChild(row);
      });
    }

    // 테이블 행 생성
    function createTableRow(item) {
      const row = document.createElement('tr');
      
      const statusText = {
        'completed': '작성완료',
        'pending': '작성중',
        'not-started': '미작성'
      };
      
      const statusClass = {
        'completed': 'status-completed',
        'pending': 'status-pending',
        'not-started': 'status-not-started'
      };
      
      row.innerHTML = `
        <td>${item.meetingName}</td>
        <td>${item.department}</td>
        <td><span class="status-badge ${statusClass[item.status]}">${statusText[item.status]}</span></td>
        <td>${item.lastModified}</td>
        <td>
          <button class="btn-action btn-view" onclick="viewMeetingDetail('${item.meetingId}', '${item.department}')">보기</button>
          <button class="btn-action btn-edit" onclick="editMeetingDetail('${item.meetingId}', '${item.department}')">수정</button>
          <button class="btn-action btn-delete" onclick="deleteMeetingDetail('${item.meetingId}', '${item.department}')">삭제</button>
        </td>
      `;
      
      return row;
    }

    // 회의 상세보기
    function viewMeetingDetail(meetingId, department) {
      // 작성자가 저장한 데이터를 로컬 스토리지에서 불러오기
      const savedData = JSON.parse(localStorage.getItem(`meetingData_${meetingId}_${department}`) || '{}');
      
      if (savedData.keyPoints || savedData.previousResults || savedData.currentPlan) {
        const savedDate = savedData.savedAt ? new Date(savedData.savedAt).toLocaleString('ko-KR') : '정보 없음';
        alert(`${department}의 회의자료:\n\n주요사항: ${savedData.keyPoints || '없음'}\n전월/전주 실적: ${savedData.previousResults || '없음'}\n금월/금주 계획: ${savedData.currentPlan || '없음'}\n\n저장 시간: ${savedDate}`);
      } else {
        alert(`${department}의 회의자료가 없습니다.`);
      }
    }

    // 회의 수정
    function editMeetingDetail(meetingId, department) {
      alert(`${department}의 회의자료 수정 기능은 작성자 모드에서 사용할 수 있습니다.`);
    }

    // 회의 삭제
    function deleteMeetingDetail(meetingId, department) {
      if (!confirm(`${department}의 회의자료를 삭제하시겠습니까?`)) return;
      
      if (meetingData[meetingId] && meetingData[meetingId][department]) {
        delete meetingData[meetingId][department];
        
        // 해당 회의에 다른 부서 데이터가 없으면 회의 자체 삭제
        if (Object.keys(meetingData[meetingId]).length === 0) {
          delete meetingData[meetingId];
        }
        
        localStorage.setItem('meetingData', JSON.stringify(meetingData));
        searchMeeting(); // 테이블 새로고침
        alert('회의자료가 삭제되었습니다.');
      }
    }

    // 데이터 내보내기
    function exportCurrentData() {
      if (!selectedMeeting) {
        alert('먼저 회의를 선택해주세요.');
        return;
      }
      
      const csvContent = generateCSV(currentMeetingData);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `${selectedMeeting.name}_현황데이터_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // CSV 생성
    function generateCSV(data) {
      const headers = ['회의명', '부서', '상태', '마지막수정'];
      const rows = data.map(item => [
        item.meetingName,
        item.department,
        item.status === 'completed' ? '작성완료' : item.status === 'pending' ? '작성중' : '미작성',
        item.lastModified
      ]);
      
      const csvContent = [headers, ...rows]
        .map(row => row.map(field => `"${field}"`).join(','))
        .join('\n');
        
      return '\uFEFF' + csvContent; // BOM 추가 (한글 깨짐 방지)
    }

    // 데이터 새로고침
    function refreshData() {
      loadMeetingData();
      updateDashboardStats();
      if (selectedMeeting) {
        searchMeeting();
      }
      alert('데이터가 새로고침되었습니다.');
    }

    // 관리자 로그인 후 대시보드 초기화
    function initializeAdminDashboard() {
      if (currentUserRole === 'admin') {
        setTimeout(() => {
          initializeDashboard();
          initializeAccountManagement();
          initializeSecuritySettings();
        }, 100);
      }
    }

    // ========== 계정 관리 기능 ==========
    
    // 계정 관리 초기화
    function initializeAccountManagement() {
      setupAccountSelectors();
      updateAccountStats();
      renderAccountTable();
    }

    // 계정 선택기 설정
    function setupAccountSelectors() {
      const accountSelect = document.getElementById('newAccountId');
      const deptSelect = document.getElementById('newAccountDept');
      
      if (accountSelect) {
        accountSelect.innerHTML = '<option value="">계정 ID 선택</option>';
        
        // 기존 계정 확인
        const existingAccounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
        const existingIds = existingAccounts.filter(acc => acc.role === 'writer').map(acc => acc.id);
        
        for (let i = 1; i <= 20; i++) {
          const accountId = `OK ${i}`;
          if (!existingIds.includes(accountId)) {
            const option = document.createElement('option');
            option.value = accountId;
            option.textContent = accountId;
            accountSelect.appendChild(option);
          }
        }
      }
      
      if (deptSelect) {
        deptSelect.innerHTML = '<option value="">부서 선택</option>';
        departments.forEach(dept => {
          const option = document.createElement('option');
          option.value = dept;
          option.textContent = dept;
          deptSelect.appendChild(option);
        });
      }
    }

    // 계정 통계 업데이트
    function updateAccountStats() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const writerAccounts = accounts.filter(acc => acc.role === 'writer');
      
      const total = writerAccounts.length;
      const active = writerAccounts.filter(acc => acc.status !== 'inactive').length;
      const inactive = writerAccounts.filter(acc => acc.status === 'inactive').length;
      const online = writerAccounts.filter(acc => acc.status === 'online').length;
      
      document.getElementById('totalAccounts').textContent = total;
      document.getElementById('activeAccounts').textContent = active;
      document.getElementById('inactiveAccounts').textContent = inactive;
      document.getElementById('onlineAccounts').textContent = online;
    }

    // 새 계정 생성
    function createNewAccount() {
      const accountId = document.getElementById('newAccountId').value;
      const password = document.getElementById('newAccountPw').value;
      const department = document.getElementById('newAccountDept').value;
      const messageElement = document.getElementById('accountCreationMessage');
      
      if (!accountId || !password || !department) {
        showAccountMessage('모든 필드를 입력해주세요.', 'error');
        return;
      }
      
      if (password.length < 4) {
        showAccountMessage('비밀번호는 4자 이상이어야 합니다.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const existingAccount = accounts.find(acc => acc.id === accountId);
      
      if (existingAccount) {
        showAccountMessage('이미 존재하는 계정 ID입니다.', 'error');
        return;
      }
      
      const newAccount = {
        id: accountId,
        password: password,
        role: 'writer',
        department: department,
        status: 'active',
        isFirstLogin: true,
        createdAt: new Date().toISOString(),
        lastLogin: null
      };
      
      accounts.push(newAccount);
      localStorage.setItem('systemAccounts', JSON.stringify(accounts));
      
      // 폼 초기화
      document.getElementById('newAccountId').value = '';
      document.getElementById('newAccountPw').value = '';
      document.getElementById('newAccountDept').value = '';
      
      showAccountMessage(`계정 "${accountId}"가 성공적으로 생성되었습니다!`, 'success');
      
      // 화면 업데이트
      setupAccountSelectors();
      updateAccountStats();
      renderAccountTable();
    }

    // 계정 테이블 렌더링
    function renderAccountTable() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const writerAccounts = accounts.filter(acc => acc.role === 'writer');
      const tbody = document.getElementById('accountTableBody');
      
      if (writerAccounts.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; color: #999; padding: 40px;">
              등록된 계정이 없습니다.
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = writerAccounts.map((account, index) => `
        <tr>
          <td>${index + 1}</td>
          <td><strong>${account.id}</strong></td>
          <td>${account.department || '-'}</td>
          <td><span class="account-status ${account.status || 'active'}">${getStatusText(account.status)}</span></td>
          <td>${new Date(account.createdAt).toLocaleDateString('ko-KR')}</td>
          <td>${account.lastLogin ? new Date(account.lastLogin).toLocaleString('ko-KR') : '없음'}</td>
          <td>
            ${account.status === 'active' ? 
              `<button class="btn-manage btn-deactivate" onclick="toggleAccountStatus('${account.id}', 'inactive')">비활성화</button>` :
              `<button class="btn-manage btn-activate" onclick="toggleAccountStatus('${account.id}', 'active')">활성화</button>`
            }
            <button class="btn-manage btn-reset" onclick="resetAccountPassword('${account.id}')">비밀번호 초기화</button>
            <button class="btn-manage btn-remove" onclick="removeAccount('${account.id}')">삭제</button>
          </td>
        </tr>
      `).join('');
    }

    // 계정 상태 텍스트 변환
    function getStatusText(status) {
      switch(status) {
        case 'active': return '활성';
        case 'inactive': return '비활성';
        case 'online': return '접속중';
        default: return '활성';
      }
    }

    // 계정 상태 토글
    function toggleAccountStatus(accountId, newStatus) {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const accountIndex = accounts.findIndex(acc => acc.id === accountId);
      
      if (accountIndex !== -1) {
        accounts[accountIndex].status = newStatus;
        localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        
        updateAccountStats();
        renderAccountTable();
        
        const statusText = newStatus === 'active' ? '활성화' : '비활성화';
        alert(`계정 "${accountId}"이 ${statusText}되었습니다.`);
      }
    }

    // 계정 비밀번호 초기화
    function resetAccountPassword(accountId) {
      if (!confirm(`계정 "${accountId}"의 비밀번호를 초기화하시겠습니까?`)) return;
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const accountIndex = accounts.findIndex(acc => acc.id === accountId);
      
      if (accountIndex !== -1) {
        accounts[accountIndex].password = '1234';
        accounts[accountIndex].isFirstLogin = true;
        localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        
        alert(`계정 "${accountId}"의 비밀번호가 "1234"로 초기화되었습니다.`);
      }
    }

    // 계정 삭제
    function removeAccount(accountId) {
      if (!confirm(`계정 "${accountId}"를 완전히 삭제하시겠습니까?`)) return;
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const filteredAccounts = accounts.filter(acc => acc.id !== accountId);
      
      localStorage.setItem('systemAccounts', JSON.stringify(filteredAccounts));
      
      setupAccountSelectors();
      updateAccountStats();
      renderAccountTable();
      
      alert(`계정 "${accountId}"가 삭제되었습니다.`);
    }

    // 계정 데이터 내보내기
    function exportAccountData() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const writerAccounts = accounts.filter(acc => acc.role === 'writer');
      
      if (writerAccounts.length === 0) {
        alert('내보낼 계정 데이터가 없습니다.');
        return;
      }
      
      const csvContent = generateAccountCSV(writerAccounts);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `계정목록_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // 계정 CSV 생성
    function generateAccountCSV(accounts) {
      const headers = ['번호', '계정ID', '담당부서', '상태', '생성일', '마지막로그인'];
      const rows = accounts.map((account, index) => [
        index + 1,
        account.id,
        account.department || '-',
        getStatusText(account.status),
        new Date(account.createdAt).toLocaleDateString('ko-KR'),
        account.lastLogin ? new Date(account.lastLogin).toLocaleString('ko-KR') : '없음'
      ]);
      
      const csvContent = [headers, ...rows]
        .map(row => row.map(field => `"${field}"`).join(','))
        .join('\n');
        
      return '\uFEFF' + csvContent;
    }

    // 계정 데이터 새로고침
    function refreshAccountData() {
      updateAccountStats();
      renderAccountTable();
      setupAccountSelectors();
      alert('계정 데이터가 새로고침되었습니다.');
    }

    // 계정 메시지 표시
    function showAccountMessage(message, type) {
      const messageElement = document.getElementById('accountCreationMessage');
      messageElement.textContent = message;
      messageElement.className = `login-message ${type}`;
      messageElement.style.display = 'block';
      
      setTimeout(() => {
        messageElement.style.display = 'none';
      }, 3000);
    }

    // ========== 보안 설정 기능 ==========
    
    // 보안 설정 초기화
    function initializeSecuritySettings() {
      updateSecurityStats();
      loadAdminInfo();
      setupLoginFilters();
      renderLoginRecords();
    }

    // 보안 통계 업데이트
    function updateSecurityStats() {
      const loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      
      const totalLogins = loginRecords.length;
      const successLogins = loginRecords.filter(record => record.success).length;
      const failedLogins = loginRecords.filter(record => !record.success).length;
      const onlineUsers = accounts.filter(acc => acc.status === 'online').length;
      
      document.getElementById('totalLogins').textContent = totalLogins;
      document.getElementById('successLogins').textContent = successLogins;
      document.getElementById('failedLogins').textContent = failedLogins;
      document.getElementById('onlineUsers').textContent = onlineUsers;
    }

    // 관리자 정보 로드
    function loadAdminInfo() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const adminAccount = accounts.find(acc => acc.id === 'OKADMIN');
      
      if (adminAccount && adminAccount.lastLogin) {
        const lastLoginDate = new Date(adminAccount.lastLogin);
        document.getElementById('adminLastLogin').textContent = lastLoginDate.toLocaleString('ko-KR');
      } else {
        document.getElementById('adminLastLogin').textContent = '-';
      }
    }

    // 로그인 필터 설정
    function setupLoginFilters() {
      const userFilter = document.getElementById('loginUserFilter');
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      
      if (userFilter) {
        userFilter.innerHTML = '<option value="">전체 사용자</option>';
        
        // 고유한 사용자 ID만 추출
        const uniqueUsers = [...new Set(accounts.map(acc => acc.id))];
        uniqueUsers.forEach(userId => {
          const option = document.createElement('option');
          option.value = userId;
          option.textContent = userId;
          userFilter.appendChild(option);
        });
      }
    }

    // 로그인 기록 렌더링
    function renderLoginRecords() {
      const loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      const tbody = document.getElementById('loginRecordsBody');
      
      if (loginRecords.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
              로그인 기록이 없습니다.
            </td>
          </tr>
        `;
        return;
      }
      
      // 최신 기록부터 표시
      const sortedRecords = loginRecords.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      tbody.innerHTML = sortedRecords.map((record, index) => `
        <tr>
          <td>${index + 1}</td>
          <td><strong>${record.userId}</strong></td>
          <td>${new Date(record.timestamp).toLocaleString('ko-KR')}</td>
          <td><span class="login-status ${record.success ? 'success' : 'failed'}">${record.success ? '성공' : '실패'}</span></td>
          <td><span class="ip-address">${record.ip || 'localhost'}</span></td>
          <td><span class="browser-info" title="${record.userAgent || 'Unknown'}">${getBrowserName(record.userAgent)}</span></td>
        </tr>
      `).join('');
    }

    // 브라우저 이름 추출
    function getBrowserName(userAgent) {
      if (!userAgent) return 'Unknown';
      
      if (userAgent.includes('Chrome')) return 'Chrome';
      if (userAgent.includes('Firefox')) return 'Firefox';
      if (userAgent.includes('Safari')) return 'Safari';
      if (userAgent.includes('Edge')) return 'Edge';
      if (userAgent.includes('Opera')) return 'Opera';
      
      return 'Unknown';
    }

    // 로그인 필터 적용
    function applyLoginFilters() {
      const userFilter = document.getElementById('loginUserFilter').value;
      const statusFilter = document.getElementById('loginStatusFilter').value;
      const dateFilter = document.getElementById('loginDateFilter').value;
      
      let loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      
      // 필터 적용
      if (userFilter) {
        loginRecords = loginRecords.filter(record => record.userId === userFilter);
      }
      
      if (statusFilter) {
        const isSuccess = statusFilter === 'true';
        loginRecords = loginRecords.filter(record => record.success === isSuccess);
      }
      
      if (dateFilter) {
        const filterDate = new Date(dateFilter);
        loginRecords = loginRecords.filter(record => {
          const recordDate = new Date(record.timestamp);
          return recordDate.toDateString() === filterDate.toDateString();
        });
      }
      
      renderFilteredLoginRecords(loginRecords);
    }

    // 필터된 로그인 기록 렌더링
    function renderFilteredLoginRecords(records) {
      const tbody = document.getElementById('loginRecordsBody');
      
      if (records.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
              필터 조건에 맞는 로그인 기록이 없습니다.
            </td>
          </tr>
        `;
        return;
      }
      
      const sortedRecords = records.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      tbody.innerHTML = sortedRecords.map((record, index) => `
        <tr>
          <td>${index + 1}</td>
          <td><strong>${record.userId}</strong></td>
          <td>${new Date(record.timestamp).toLocaleString('ko-KR')}</td>
          <td><span class="login-status ${record.success ? 'success' : 'failed'}">${record.success ? '성공' : '실패'}</span></td>
          <td><span class="ip-address">${record.ip || 'localhost'}</span></td>
          <td><span class="browser-info" title="${record.userAgent || 'Unknown'}">${getBrowserName(record.userAgent)}</span></td>
        </tr>
      `).join('');
    }

    // 관리자 비밀번호 변경
    function showAdminPasswordChange() {
      showPasswordModal();
    }

    // 시스템 설정
    function showSystemSettings() {
      alert('시스템 설정 기능은 추후 업데이트 예정입니다.');
    }

    // 로그인 데이터 내보내기
    function exportLoginData() {
      const loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      
      if (loginRecords.length === 0) {
        alert('내보낼 로그인 데이터가 없습니다.');
        return;
      }
      
      const csvContent = generateLoginCSV(loginRecords);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `로그인기록_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // 로그인 CSV 생성
    function generateLoginCSV(records) {
      const headers = ['번호', '사용자ID', '로그인시간', '상태', 'IP주소', '브라우저'];
      const rows = records.map((record, index) => [
        index + 1,
        record.userId,
        new Date(record.timestamp).toLocaleString('ko-KR'),
        record.success ? '성공' : '실패',
        record.ip || 'localhost',
        getBrowserName(record.userAgent)
      ]);
      
      const csvContent = [headers, ...rows]
        .map(row => row.map(field => `"${field}"`).join(','))
        .join('\n');
        
      return '\uFEFF' + csvContent;
    }

    // 로그인 기록 삭제
    function clearLoginRecords() {
      if (!confirm('모든 로그인 기록을 삭제하시겠습니까?')) return;
      
      localStorage.removeItem('loginRecords');
      
      updateSecurityStats();
      renderLoginRecords();
      
      alert('로그인 기록이 삭제되었습니다.');
    }

    // 로그인 데이터 새로고침
    function refreshLoginData() {
      updateSecurityStats();
      renderLoginRecords();
      setupLoginFilters();
      
      // 필터 초기화
      document.getElementById('loginUserFilter').value = '';
      document.getElementById('loginStatusFilter').value = '';
      document.getElementById('loginDateFilter').value = '';
      
      alert('로그인 데이터가 새로고침되었습니다.');
    }
  </script>
</body>
</html>


