<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OK저축은행 회의자료 관리 시스템</title>
  <style>
    :root {
      --ok-orange: #E93D1A;
      --ok-dark-brown: #554744;
      --ok-yellow: #F4A611;
      --ok-bright-gray: #C5C5C5;
      --ok-bg-gray: #F8F8F8;
      --ok-text-dark: #2D2D2D;
      --ok-border-light: #E8E8E8;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
      background-color: var(--ok-bg-gray);
      color: var(--ok-text-dark);
      min-height: 100vh;
    }

    /* 통합 로그인 페이지 스타일 */
    .login-page {
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      background: linear-gradient(135deg, var(--ok-bg-gray) 0%, #e8e8e8 100%);
      padding: 20px;
    }

    .login-container {
      background: white;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.1);
      padding: 40px;
      max-width: 500px;
      width: 100%;
      text-align: center;
      border: 2px solid var(--ok-border-light);
    }

    .login-header {
      margin-bottom: 30px;
    }

    .login-logo svg {
      height: 60px;
      width: auto;
      margin-bottom: 20px;
    }

    .login-title {
      font-size: 1.8rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 10px;
    }

    .login-subtitle {
      color: var(--ok-dark-brown);
      font-size: 1rem;
      margin-bottom: 20px;
    }

    .login-type-selector {
      display: flex;
      gap: 10px;
      margin-bottom: 30px;
      background: var(--ok-bg-gray);
      padding: 6px;
      border-radius: 12px;
    }

    .login-type-btn {
      flex: 1;
      padding: 12px 20px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      background: transparent;
      color: var(--ok-text-dark);
    }

    .login-type-btn.active {
      background: var(--ok-orange);
      color: white;
      box-shadow: 0 4px 15px rgba(233, 61, 26, 0.3);
    }

    .login-form {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .form-group {
      text-align: left;
    }

    .form-group label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--ok-text-dark);
    }

    .form-input {
      width: 100%;
      padding: 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 10px;
      font-size: 1rem;
      transition: all 0.3s ease;
      background: #fafafa;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--ok-orange);
      background: white;
      box-shadow: 0 0 0 3px rgba(233, 61, 26, 0.1);
    }

    .login-btn {
      background: linear-gradient(135deg, var(--ok-orange) 0%, #ff6b35 100%);
      color: white;
      border: none;
      padding: 15px 30px;
      border-radius: 10px;
      font-size: 1.1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: 0 6px 20px rgba(233, 61, 26, 0.3);
      margin-top: 10px;
    }

    .login-btn:hover {
      transform: translateY(-2px);
      box-shadow: 0 8px 25px rgba(233, 61, 26, 0.4);
    }

    .login-btn:disabled {
      background: var(--ok-bright-gray);
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }

    .login-message {
      margin-top: 20px;
      padding: 15px;
      border-radius: 8px;
      font-size: 0.9rem;
      display: none;
    }

    .login-message.success {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .login-message.error {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f5c6cb;
    }

    .login-message.info {
      background: #cce5ff;
      color: #004085;
      border: 1px solid #b3d9ff;
    }

    /* 메인 앱 스타일 */
    .main-app {
      display: none;
      min-height: 100vh;
    }

    .app-header {
      background: linear-gradient(135deg, var(--ok-dark-brown) 0%, #3D2F2C 100%);
      color: white;
      padding: 20px 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      position: relative;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .app-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .header-logo svg {
      height: 40px;
      width: auto;
    }

    .header-title {
      font-size: 1.8rem;
      font-weight: 700;
    }

    .header-right {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .user-info {
      background: rgba(255,255,255,0.1);
      padding: 8px 15px;
      border-radius: 20px;
      font-size: 0.9rem;
      font-weight: 600;
    }

    .btn-header {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 10px 20px;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: inline-block;
    }

    .btn-header:hover {
      background: #ff4520;
      transform: translateY(-2px);
    }

    .btn-header.secondary {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.3);
    }

    .btn-header.secondary:hover {
      background: rgba(255,255,255,0.2);
    }

    .app-content {
      padding: 30px;
      max-width: 1400px;
      margin: 0 auto;
    }

    /* 탭 스타일 (관리자용) */
    .tab-navigation {
      background: white;
      border-bottom: 2px solid var(--ok-border-light);
      margin-bottom: 30px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.05);
    }

    .tab-container {
      display: flex;
      max-width: 1400px;
      margin: 0 auto;
    }

    .tab-button {
      background: none;
      border: none;
      padding: 20px 30px;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--ok-text-dark);
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 3px solid transparent;
      position: relative;
    }

    .tab-button:hover {
      background: rgba(233, 61, 26, 0.05);
      color: var(--ok-orange);
    }

    .tab-button.active {
      color: var(--ok-orange);
      border-bottom-color: var(--ok-orange);
      background: rgba(233, 61, 26, 0.05);
    }

    .tab-content {
      display: none;
    }

    .tab-content.active {
      display: block;
    }

    /* 기본 카드 스타일 */
    .card {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      margin-bottom: 30px;
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
    }

    .card-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--ok-text-dark);
    }

    /* 작성자 전용 - 회의 선택 */
    .meeting-selector {
      background: white;
      border-radius: 15px;
      padding: 30px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      margin-bottom: 30px;
    }

    .selector-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }

    .selector-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .selector-group label {
      font-weight: 600;
      color: var(--ok-text-dark);
    }

    .form-select {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 8px;
      font-size: 1rem;
      background: #fafafa;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .form-select:focus {
      outline: none;
      border-color: var(--ok-orange);
      background: white;
    }

    .btn-primary {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-primary:hover {
      background: #ff4520;
    }

    .btn-primary:disabled {
      background: var(--ok-bright-gray);
      cursor: not-allowed;
    }

    /* 모달 스타일 */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.5);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 1000;
    }

    .modal-content {
      background: white;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 500px;
      text-align: center;
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 20px;
    }

    .modal-subtitle {
      color: var(--ok-dark-brown);
      margin-bottom: 30px;
      line-height: 1.5;
    }

    /* 대시보드 스타일 */
    .dashboard-stats {
      margin-bottom: 30px;
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 25px;
    }

    .stat-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      display: flex;
      align-items: center;
      gap: 20px;
      position: relative;
      overflow: hidden;
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .stat-icon {
      font-size: 3rem;
      width: 80px;
      height: 80px;
      background: linear-gradient(135deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
    }

    .stat-content {
      flex: 1;
    }

    .stat-number {
      font-size: 2.5rem;
      font-weight: 900;
      color: var(--ok-orange);
      margin-bottom: 5px;
    }

    .stat-label {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 5px;
    }

    .stat-desc {
      color: var(--ok-dark-brown);
      font-size: 0.9rem;
    }

    .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }

    .card-actions {
      display: flex;
      gap: 10px;
    }

    .table-container {
      overflow-x: auto;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.95rem;
    }

    .data-table th,
    .data-table td {
      padding: 15px 20px;
      text-align: left;
      border-bottom: 1px solid var(--ok-border-light);
    }

    .data-table th {
      background: var(--ok-bg-gray);
      font-weight: 600;
      color: var(--ok-text-dark);
    }

    .data-table tbody tr:hover {
      background: rgba(233, 61, 26, 0.05);
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 600;
      text-align: center;
      min-width: 80px;
      display: inline-block;
    }

    .status-completed {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .status-not-started {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f1b0b7;
    }

    .empty-state {
      text-align: center;
      padding: 50px 20px;
      color: var(--ok-bright-gray);
    }

    .empty-icon {
      font-size: 4rem;
      margin-bottom: 20px;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: var(--ok-text-dark);
    }

    .empty-state p {
      font-size: 1rem;
      color: var(--ok-dark-brown);
    }

    .btn-action {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 600;
      transition: all 0.3s ease;
      margin: 0 2px;
    }

    .btn-view {
      background: #007bff;
      color: white;
    }

    .btn-view:hover {
      background: #0056b3;
    }

    .btn-edit {
      background: #28a745;
      color: white;
    }

    .btn-edit:hover {
      background: #1e7e34;
    }

    .btn-delete {
      background: #dc3545;
      color: white;
    }

    .btn-delete:hover {
      background: #c82333;
    }

    /* 계정 관리 스타일 */
    .account-stats {
      margin-bottom: 30px;
    }

    .account-creation-form {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
    }

    .form-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 20px;
    }

    .account-status {
      padding: 4px 12px;
      border-radius: 12px;
      font-size: 0.8rem;
      font-weight: 600;
      display: inline-block;
    }

    .account-status.active {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .account-status.inactive {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f1b0b7;
    }

    .account-status.online {
      background: #cce5ff;
      color: #004085;
      border: 1px solid #b3d9ff;
    }

    .btn-manage {
      padding: 4px 8px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.7rem;
      font-weight: 600;
      transition: all 0.3s ease;
      margin: 0 2px;
    }

    .btn-activate {
      background: #28a745;
      color: white;
    }

    .btn-activate:hover {
      background: #1e7e34;
    }

    .btn-deactivate {
      background: #ffc107;
      color: #212529;
    }

    .btn-deactivate:hover {
      background: #e0a800;
    }

    .btn-reset {
      background: #17a2b8;
      color: white;
    }

    .btn-reset:hover {
      background: #138496;
    }

    .btn-remove {
      background: #dc3545;
      color: white;
    }

    .btn-remove:hover {
      background: #c82333;
    }

    /* 보안 설정 스타일 */
    .security-stats {
      margin-bottom: 30px;
    }

    .admin-settings {
      display: flex;
      flex-direction: column;
      gap: 20px;
    }

    .setting-item {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 20px;
      background: #f8f9fa;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
    }

    .setting-info h3 {
      font-size: 1.2rem;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 10px;
    }

    .setting-info p {
      color: var(--ok-dark-brown);
      margin-bottom: 5px;
    }

    .setting-actions {
      flex-shrink: 0;
    }

    .login-filter {
      background: #f8f9fa;
      padding: 20px;
      border-radius: 10px;
      border: 1px solid var(--ok-border-light);
      margin-bottom: 20px;
    }

    .filter-row {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }

    .login-status {
      padding: 4px 8px;
      border-radius: 8px;
      font-size: 0.8rem;
      font-weight: 600;
      display: inline-block;
    }

    .login-status.success {
      background: #d4edda;
      color: #155724;
    }

    .login-status.failed {
      background: #f8d7da;
      color: #721c24;
    }

    .ip-address {
      font-family: 'Courier New', monospace;
      background: #f8f9fa;
      padding: 2px 6px;
      border-radius: 4px;
      font-size: 0.9rem;
    }

    .browser-info {
      font-size: 0.8rem;
      color: var(--ok-dark-brown);
      max-width: 200px;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }

    /* 반응형 디자인 */
    @media (max-width: 768px) {
      .login-container {
        padding: 30px 20px;
      }

      .app-header {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      .header-left {
        flex-direction: column;
        gap: 10px;
      }

      .header-right {
        flex-direction: column;
        gap: 10px;
      }

      .app-content {
        padding: 20px;
      }

      .tab-container {
        flex-direction: column;
      }

      .tab-button {
        padding: 15px 20px;
      }

      .selector-grid {
        grid-template-columns: 1fr;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .filter-grid {
        grid-template-columns: 1fr;
      }

      .stat-card {
        flex-direction: column;
        text-align: center;
      }

      .stat-icon {
        width: 60px;
        height: 60px;
        font-size: 2rem;
      }

      .stat-number {
        font-size: 2rem;
      }

      .card-actions {
        flex-direction: column;
        width: 100%;
      }

      .data-table {
        font-size: 0.85rem;
      }

      .data-table th,
      .data-table td {
        padding: 10px 8px;
      }

      .btn-action {
        padding: 4px 8px;
        font-size: 0.7rem;
      }

      .setting-item {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      .setting-actions {
        width: 100%;
      }

      .filter-row {
        grid-template-columns: 1fr;
      }

      .login-filter {
        padding: 15px;
      }

      .browser-info {
        max-width: 100px;
      }

      .btn-manage {
        padding: 3px 6px;
        font-size: 0.6rem;
      }
    }
  </style>
</head>
<body>
  <!-- 통합 로그인 페이지 -->
  <div class="login-page" id="loginPage">
    <div class="login-container">
      <div class="login-header">
        <div class="login-logo">
          <svg width="140" height="50" viewBox="0 0 140 50" style="height: 60px; width: auto;">
            <defs>
              <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#554744;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3d3330;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="orangeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#E93D1A;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#d32f0f;stop-opacity:1" />
              </linearGradient>
            </defs>
            <rect width="140" height="50" rx="12" fill="url(#bgGradient)"/>
            <rect x="0" y="0" width="8" height="50" rx="12" fill="url(#orangeGradient)"/>
            <text x="18" y="34" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="#2a2a2a" opacity="0.3">OK</text>
            <text x="16" y="32" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="white">OK</text>
            <text x="52" y="34" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#2a2a2a" opacity="0.3">!</text>
            <text x="50" y="32" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#E93D1A">!</text>
            <text x="70" y="22" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white">저축은행</text>
            <text x="70" y="36" font-family="Arial, sans-serif" font-size="9" font-weight="500" fill="#F4A611">SAVINGS BANK</text>
            <circle cx="125" cy="15" r="4" fill="#E93D1A" opacity="0.8"/>
            <circle cx="130" cy="25" r="2.5" fill="#F4A611" opacity="0.9"/>
            <circle cx="120" cy="35" r="2" fill="#E93D1A" opacity="0.6"/>
          </svg>
        </div>
        <h1 class="login-title">OK저축은행 회의자료 관리 시스템</h1>
        <p class="login-subtitle">시스템에 접속하려면 로그인해주세요</p>
      </div>
      
      <div class="login-type-selector">
        <button class="login-type-btn active" onclick="switchLoginType('admin')">관리자</button>
        <button class="login-type-btn" onclick="switchLoginType('writer')">작성자</button>
      </div>

      <div id="adminLoginForm" class="login-form">
        <div class="form-group">
          <label for="adminId">관리자 ID</label>
          <input type="text" id="adminId" class="form-input" placeholder="OKADMIN" value="OKADMIN" readonly>
        </div>
        <div class="form-group">
          <label for="adminPassword">비밀번호</label>
          <input type="password" id="adminPassword" class="form-input" placeholder="비밀번호를 입력하세요">
        </div>
        <button class="login-btn" onclick="handleAdminLogin()">관리자 로그인</button>
      </div>

      <div id="writerLoginForm" class="login-form" style="display: none;">
        <div class="form-group">
          <label for="writerId">작성자 ID</label>
          <input type="text" id="writerId" class="form-input" placeholder="OK 1 ~ OK 20">
        </div>
        <div class="form-group">
          <label for="writerPassword">비밀번호</label>
          <input type="password" id="writerPassword" class="form-input" placeholder="비밀번호를 입력하세요">
        </div>
        <button class="login-btn" onclick="handleWriterLogin()">작성자 로그인</button>
      </div>

      <div id="loginMessage" class="login-message"></div>
    </div>
  </div>

  <!-- 메인 앱 -->
  <div class="main-app" id="mainApp">
    <div class="app-header">
      <div class="header-left">
        <div class="header-logo">
          <svg width="140" height="50" viewBox="0 0 140 50" style="height: 40px; width: auto;">
            <defs>
              <linearGradient id="bgGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#554744;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3d3330;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="orangeGradient2" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#E93D1A;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#d32f0f;stop-opacity:1" />
              </linearGradient>
            </defs>
            <rect width="140" height="50" rx="12" fill="url(#bgGradient2)"/>
            <rect x="0" y="0" width="8" height="50" rx="12" fill="url(#orangeGradient2)"/>
            <text x="18" y="34" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="#2a2a2a" opacity="0.3">OK</text>
            <text x="16" y="32" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="white">OK</text>
            <text x="52" y="34" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#2a2a2a" opacity="0.3">!</text>
            <text x="50" y="32" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#E93D1A">!</text>
            <text x="70" y="22" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white">저축은행</text>
            <text x="70" y="36" font-family="Arial, sans-serif" font-size="9" font-weight="500" fill="#F4A611">SAVINGS BANK</text>
            <circle cx="125" cy="15" r="4" fill="#E93D1A" opacity="0.8"/>
            <circle cx="130" cy="25" r="2.5" fill="#F4A611" opacity="0.9"/>
            <circle cx="120" cy="35" r="2" fill="#E93D1A" opacity="0.6"/>
          </svg>
        </div>
        <h1 class="header-title" id="headerTitle">회의자료 관리 시스템</h1>
      </div>
      <div class="header-right">
        <div class="user-info" id="userInfo">사용자</div>
        <button class="btn-header secondary" onclick="logout()">로그아웃</button>
      </div>
    </div>

    <!-- 관리자 전용 탭 -->
    <div class="tab-navigation" id="adminTabs" style="display: none;">
      <div class="tab-container">
        <button class="tab-button active" onclick="switchTab('dashboard')">📊 대시보드</button>
        <button class="tab-button" onclick="switchTab('accounts')">👥 계정관리</button>
        <button class="tab-button" onclick="switchTab('security')">🔐 보안설정</button>
      </div>
    </div>

    <div class="app-content">
      <!-- 관리자 대시보드 -->
      <div id="dashboardTab" class="tab-content">
        <!-- 통계 카드 -->
        <div class="dashboard-stats">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">📅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="totalMeetings">0</h3>
                <p class="stat-label">전체 부서</p>
                <p class="stat-desc">16개 부서</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">✅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="completedTasks">0</h3>
                <p class="stat-label">작성완료</p>
                <p class="stat-desc">완료된 회의자료</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">📝</div>
              <div class="stat-content">
                <h3 class="stat-number" id="pendingTasks">0</h3>
                <p class="stat-label">작성중</p>
                <p class="stat-desc">진행중인 회의자료</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">⏳</div>
              <div class="stat-content">
                <h3 class="stat-number" id="notStartedTasks">0</h3>
                <p class="stat-label">미작성</p>
                <p class="stat-desc">시작하지 않은 회의자료</p>
              </div>
            </div>
          </div>
        </div>

        <!-- 회의 선택 필터 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">회의 선택</h2>
          </div>
          <div class="filter-grid">
            <div class="form-group">
              <label for="filterYear">연도</label>
              <select id="filterYear" class="form-select">
                <option value="">연도 선택</option>
                <option value="2025">2025년</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filterMonth">월</label>
              <select id="filterMonth" class="form-select">
                <option value="">월 선택</option>
                <option value="08">8월</option>
                <option value="09">9월</option>
                <option value="10">10월</option>
                <option value="11">11월</option>
                <option value="12">12월</option>
              </select>
            </div>
            <div class="form-group">
              <label for="filterType">회의 구분</label>
              <select id="filterType" class="form-select">
                <option value="">회의 구분 선택</option>
                <option value="monthly">월간간담회</option>
                <option value="week1">1주차 주간간담회</option>
                <option value="week2">2주차 주간간담회</option>
                <option value="week3">3주차 주간간담회</option>
                <option value="week4">4주차 주간간담회</option>
                <option value="week5">5주차 주간간담회</option>
              </select>
            </div>
            <div class="form-group">
              <button class="btn-primary" onclick="searchMeeting()" id="searchBtn" disabled>회의 조회</button>
            </div>
          </div>
        </div>

        <!-- 회의자료 현황 테이블 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">회의자료 작성 현황</h2>
            <div class="card-actions">
              <button class="btn-header" onclick="exportCurrentData()">📊 데이터 내보내기</button>
              <button class="btn-header secondary" onclick="refreshData()">🔄 새로고침</button>
            </div>
          </div>
          <div id="tableContent">
            <div class="empty-state" id="emptyState">
              <div class="empty-icon">📊</div>
              <h3>회의를 선택해주세요</h3>
              <p>위에서 연도, 월, 회의 구분을 선택한 후 회의 조회 버튼을 눌러주세요.</p>
            </div>
            <div class="table-container" id="dataTableContainer" style="display: none;">
              <table class="data-table">
                <thead>
                  <tr>
                    <th>회의명</th>
                    <th>부서</th>
                    <th>상태</th>
                    <th>마지막 수정</th>
                    <th>액션</th>
                  </tr>
                </thead>
                <tbody id="dataTableBody">
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>

      <!-- 계정 관리 -->
      <div id="accountsTab" class="tab-content">
        <!-- 계정 현황 통계 -->
        <div class="account-stats">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">👥</div>
              <div class="stat-content">
                <h3 class="stat-number" id="totalAccounts">0</h3>
                <p class="stat-label">전체 계정</p>
                <p class="stat-desc">OK 1 ~ OK 20</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">✅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="activeAccounts">0</h3>
                <p class="stat-label">활성 계정</p>
                <p class="stat-desc">사용 가능한 계정</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">🔒</div>
              <div class="stat-content">
                <h3 class="stat-number" id="inactiveAccounts">0</h3>
                <p class="stat-label">비활성 계정</p>
                <p class="stat-desc">비활성화된 계정</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">🌐</div>
              <div class="stat-content">
                <h3 class="stat-number" id="onlineAccounts">0</h3>
                <p class="stat-label">접속중 계정</p>
                <p class="stat-desc">현재 로그인한 계정</p>
              </div>
            </div>
          </div>
        </div>

        <!-- 새 계정 생성 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">새 계정 생성</h2>
          </div>
          <div class="account-creation-form">
            <div class="form-row">
              <div class="form-group">
                <label for="newAccountId">계정 ID</label>
                <select id="newAccountId" class="form-select">
                  <option value="">계정 ID 선택</option>
                </select>
              </div>
              <div class="form-group">
                <label for="newAccountPw">초기 비밀번호</label>
                <input type="password" id="newAccountPw" class="form-input" placeholder="비밀번호 입력" maxlength="30">
              </div>
              <div class="form-group">
                <label for="newAccountDept">담당 부서</label>
                <select id="newAccountDept" class="form-select">
                  <option value="">부서 선택</option>
                </select>
              </div>
            </div>
            <button class="btn-primary" onclick="createNewAccount()">➕ 계정 생성</button>
            <div id="accountCreationMessage" class="login-message"></div>
          </div>
        </div>

        <!-- 계정 목록 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">계정 목록</h2>
            <div class="card-actions">
              <button class="btn-header" onclick="exportAccountData()">📊 계정 데이터 내보내기</button>
              <button class="btn-header secondary" onclick="refreshAccountData()">🔄 새로고침</button>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>번호</th>
                  <th>계정 ID</th>
                  <th>담당 부서</th>
                  <th>상태</th>
                  <th>생성일</th>
                  <th>마지막 로그인</th>
                  <th>관리</th>
                </tr>
              </thead>
              <tbody id="accountTableBody">
                <tr>
                  <td colspan="7" style="text-align: center; color: #999; padding: 40px;">
                    등록된 계정이 없습니다.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- 보안 설정 -->
      <div id="securityTab" class="tab-content">
        <!-- 시스템 보안 현황 -->
        <div class="security-stats">
          <div class="stats-grid">
            <div class="stat-card">
              <div class="stat-icon">🔐</div>
              <div class="stat-content">
                <h3 class="stat-number" id="totalLogins">0</h3>
                <p class="stat-label">총 로그인 시도</p>
                <p class="stat-desc">전체 로그인 기록</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">✅</div>
              <div class="stat-content">
                <h3 class="stat-number" id="successLogins">0</h3>
                <p class="stat-label">성공한 로그인</p>
                <p class="stat-desc">정상 로그인</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">❌</div>
              <div class="stat-content">
                <h3 class="stat-number" id="failedLogins">0</h3>
                <p class="stat-label">실패한 로그인</p>
                <p class="stat-desc">로그인 실패</p>
              </div>
            </div>
            <div class="stat-card">
              <div class="stat-icon">🌐</div>
              <div class="stat-content">
                <h3 class="stat-number" id="onlineUsers">0</h3>
                <p class="stat-label">현재 접속자</p>
                <p class="stat-desc">실시간 접속자</p>
              </div>
            </div>
          </div>
        </div>

        <!-- 관리자 설정 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">관리자 설정</h2>
          </div>
          <div class="admin-settings">
            <div class="setting-item">
              <div class="setting-info">
                <h3>현재 관리자 계정</h3>
                <p>ID: <strong>OKADMIN</strong></p>
                <p>마지막 로그인: <span id="adminLastLogin">-</span></p>
              </div>
              <div class="setting-actions">
                <button class="btn-primary" onclick="showAdminPasswordChange()">비밀번호 변경</button>
              </div>
            </div>
            <div class="setting-item">
              <div class="setting-info">
                <h3>시스템 설정</h3>
                <p>자동 로그아웃: <span id="autoLogoutTime">30분</span></p>
                <p>로그인 시도 제한: <span id="loginAttemptLimit">5회</span></p>
              </div>
              <div class="setting-actions">
                <button class="btn-primary" onclick="showSystemSettings()">시스템 설정</button>
              </div>
            </div>
          </div>
        </div>

        <!-- 로그인 기록 -->
        <div class="card">
          <div class="card-header">
            <h2 class="card-title">로그인 기록</h2>
            <div class="card-actions">
              <button class="btn-header" onclick="exportLoginData()">📊 로그인 기록 내보내기</button>
              <button class="btn-header secondary" onclick="clearLoginRecords()">🗑️ 기록 삭제</button>
              <button class="btn-header secondary" onclick="refreshLoginData()">🔄 새로고침</button>
            </div>
          </div>
          <div class="login-filter">
            <div class="filter-row">
              <div class="form-group">
                <label for="loginUserFilter">사용자 필터</label>
                <select id="loginUserFilter" class="form-select">
                  <option value="">전체 사용자</option>
                </select>
              </div>
              <div class="form-group">
                <label for="loginStatusFilter">상태 필터</label>
                <select id="loginStatusFilter" class="form-select">
                  <option value="">전체 상태</option>
                  <option value="true">성공</option>
                  <option value="false">실패</option>
                </select>
              </div>
              <div class="form-group">
                <label for="loginDateFilter">날짜 필터</label>
                <input type="date" id="loginDateFilter" class="form-input">
              </div>
              <div class="form-group">
                <button class="btn-primary" onclick="applyLoginFilters()">필터 적용</button>
              </div>
            </div>
          </div>
          <div class="table-container">
            <table class="data-table">
              <thead>
                <tr>
                  <th>번호</th>
                  <th>사용자 ID</th>
                  <th>로그인 시간</th>
                  <th>상태</th>
                  <th>IP 주소</th>
                  <th>브라우저</th>
                </tr>
              </thead>
              <tbody id="loginRecordsBody">
                <tr>
                  <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
                    로그인 기록이 없습니다.
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- 작성자 회의 선택 -->
      <div id="writerContent" class="tab-content" style="display: none;">
        <div class="meeting-selector">
          <h2 class="card-title" style="margin-bottom: 25px;">회의 선택</h2>
          <div class="selector-grid">
            <div class="selector-group">
              <label for="yearSelect">연도</label>
              <select id="yearSelect" class="form-select">
                <option value="">연도 선택</option>
                <option value="2025">2025년</option>
              </select>
            </div>
            <div class="selector-group">
              <label for="monthSelect">월</label>
              <select id="monthSelect" class="form-select">
                <option value="">월 선택</option>
                <option value="08">8월</option>
                <option value="09">9월</option>
                <option value="10">10월</option>
                <option value="11">11월</option>
                <option value="12">12월</option>
              </select>
            </div>
            <div class="selector-group">
              <label for="meetingTypeSelect">회의 구분</label>
              <select id="meetingTypeSelect" class="form-select">
                <option value="">회의 구분 선택</option>
                <option value="monthly">월간간담회</option>
                <option value="week1">1주차 주간간담회</option>
                <option value="week2">2주차 주간간담회</option>
                <option value="week3">3주차 주간간담회</option>
                <option value="week4">4주차 주간간담회</option>
                <option value="week5">5주차 주간간담회</option>
              </select>
            </div>
          </div>
          <button id="confirmBtn" class="btn-primary" onclick="goToMeeting()" disabled>회의자료 작성하기</button>
        </div>
      </div>
    </div>
  </div>

  <!-- 비밀번호 변경 모달 -->
  <div id="passwordModal" class="modal">
    <div class="modal-content">
      <h2 class="modal-title">비밀번호 변경</h2>
      <p class="modal-subtitle">보안을 위해 비밀번호를 변경해주세요.</p>
      <div class="form-group">
        <label for="currentPassword">현재 비밀번호</label>
        <input type="password" id="currentPassword" class="form-input">
      </div>
      <div class="form-group">
        <label for="newPassword">새 비밀번호</label>
        <input type="password" id="newPassword" class="form-input">
      </div>
      <div class="form-group">
        <label for="confirmPassword">비밀번호 확인</label>
        <input type="password" id="confirmPassword" class="form-input">
      </div>
      <button class="login-btn" onclick="changePassword()">비밀번호 변경</button>
      <div id="passwordMessage" class="login-message"></div>
    </div>
  </div>

  <script>
    // 전역 변수
    let currentUser = null;
    let currentUserRole = null;

    // 16개 부서 목록
    const departments = [
      '영업추진부', '리테일기획부', '모기지사업부', '심사부', 
      '리스크관리부', '경영관리본부(경영기획부)', '경영관리본부(IT기획부)', '미래디지털부',
      '소비자금융영업부', '소비자금융기획부', '신용관리부', '마케팅팀',
      '감사부', '준법지원부', '금융소비자보호부', '정보보안팀'
    ];

    // 초기 설정
    document.addEventListener('DOMContentLoaded', function() {
      initializeSystem();
    });

    function initializeSystem() {
      // 기본 관리자 계정 생성
      createDefaultAdminAccount();
      
      // 작성자 계정 생성 (OK 1 ~ OK 20)
      createWriterAccounts();
      
      // 로그인 상태 확인
      checkLoginStatus();
    }

    function createDefaultAdminAccount() {
      const savedAccounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const adminExists = savedAccounts.some(acc => acc.id === 'OKADMIN');
      
      if (!adminExists) {
        const adminAccount = {
          id: 'OKADMIN',
          password: 'admin123',
          role: 'admin',
          isFirstLogin: true,
          createdAt: new Date().toISOString()
        };
        savedAccounts.push(adminAccount);
        localStorage.setItem('systemAccounts', JSON.stringify(savedAccounts));
      }
    }

    function createWriterAccounts() {
      const savedAccounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      
      for (let i = 1; i <= 20; i++) {
        const accountId = `OK ${i}`;
        const accountExists = savedAccounts.some(acc => acc.id === accountId);
        
        if (!accountExists) {
          const writerAccount = {
            id: accountId,
            password: 'writer123',
            role: 'writer',
            isFirstLogin: true,
            createdAt: new Date().toISOString()
          };
          savedAccounts.push(writerAccount);
        }
      }
      
      localStorage.setItem('systemAccounts', JSON.stringify(savedAccounts));
    }

    function checkLoginStatus() {
      const savedUser = sessionStorage.getItem('currentUser');
      const savedRole = sessionStorage.getItem('currentUserRole');
      
      if (savedUser && savedRole) {
        currentUser = savedUser;
        currentUserRole = savedRole;
        showMainApp();
      } else {
        showLoginPage();
      }
    }

    function switchLoginType(type) {
      document.querySelectorAll('.login-type-btn').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      document.getElementById('adminLoginForm').style.display = type === 'admin' ? 'block' : 'none';
      document.getElementById('writerLoginForm').style.display = type === 'writer' ? 'block' : 'none';
      hideMessage();
    }

    function handleAdminLogin() {
      const id = document.getElementById('adminId').value.trim();
      const password = document.getElementById('adminPassword').value.trim();
      
      if (!id || !password) {
        showMessage('ID와 비밀번호를 모두 입력해주세요.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const account = accounts.find(acc => acc.id === id && acc.password === password && acc.role === 'admin');
      
      if (account) {
        currentUser = account.id;
        currentUserRole = account.role;
        
        sessionStorage.setItem('currentUser', currentUser);
        sessionStorage.setItem('currentUserRole', currentUserRole);
        
        // 마지막 로그인 시간 업데이트
        const accountIndex = accounts.findIndex(acc => acc.id === id);
        if (accountIndex !== -1) {
          accounts[accountIndex].lastLogin = new Date().toISOString();
          localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        }
        
        if (account.isFirstLogin) {
          showPasswordModal();
        } else {
          showMainApp();
        }
        
        recordLoginAttempt(id, true);
      } else {
        showMessage('관리자 ID 또는 비밀번호가 올바르지 않습니다.', 'error');
        recordLoginAttempt(id, false);
      }
    }

    function handleWriterLogin() {
      const id = document.getElementById('writerId').value.trim();
      const password = document.getElementById('writerPassword').value.trim();
      
      if (!id || !password) {
        showMessage('ID와 비밀번호를 모두 입력해주세요.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const account = accounts.find(acc => acc.id === id && acc.password === password && acc.role === 'writer');
      
      if (account) {
        currentUser = account.id;
        currentUserRole = account.role;
        
        sessionStorage.setItem('currentUser', currentUser);
        sessionStorage.setItem('currentUserRole', currentUserRole);
        
        // 마지막 로그인 시간 업데이트
        const accountIndex = accounts.findIndex(acc => acc.id === id);
        if (accountIndex !== -1) {
          accounts[accountIndex].lastLogin = new Date().toISOString();
          localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        }
        
        if (account.isFirstLogin) {
          showPasswordModal();
        } else {
          showMainApp();
        }
        
        recordLoginAttempt(id, true);
      } else {
        showMessage('작성자 ID 또는 비밀번호가 올바르지 않습니다.', 'error');
        recordLoginAttempt(id, false);
      }
    }

    function showPasswordModal() {
      document.getElementById('passwordModal').style.display = 'flex';
    }

    function changePassword() {
      const currentPassword = document.getElementById('currentPassword').value;
      const newPassword = document.getElementById('newPassword').value;
      const confirmPassword = document.getElementById('confirmPassword').value;
      
      if (!currentPassword || !newPassword || !confirmPassword) {
        showPasswordMessage('모든 필드를 입력해주세요.', 'error');
        return;
      }
      
      if (newPassword !== confirmPassword) {
        showPasswordMessage('새 비밀번호와 확인 비밀번호가 일치하지 않습니다.', 'error');
        return;
      }
      
      if (newPassword.length < 4) {
        showPasswordMessage('비밀번호는 4자 이상이어야 합니다.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const accountIndex = accounts.findIndex(acc => acc.id === currentUser);
      
      if (accountIndex !== -1 && accounts[accountIndex].password === currentPassword) {
        accounts[accountIndex].password = newPassword;
        accounts[accountIndex].isFirstLogin = false;
        localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        
        showPasswordMessage('비밀번호가 성공적으로 변경되었습니다.', 'success');
        
        setTimeout(() => {
          document.getElementById('passwordModal').style.display = 'none';
          showMainApp();
        }, 2000);
      } else {
        showPasswordMessage('현재 비밀번호가 올바르지 않습니다.', 'error');
      }
    }

    function showMainApp() {
      document.getElementById('loginPage').style.display = 'none';
      document.getElementById('mainApp').style.display = 'block';
      
      // 사용자 정보 표시
      document.getElementById('userInfo').textContent = `${currentUser} (${currentUserRole === 'admin' ? '관리자' : '작성자'})`;
      
      if (currentUserRole === 'admin') {
        document.getElementById('headerTitle').textContent = '관리자 대시보드';
        document.getElementById('adminTabs').style.display = 'block';
        document.getElementById('dashboardTab').style.display = 'block';
        document.getElementById('writerContent').style.display = 'none';
        
        // 관리자 대시보드 초기화
        initializeAdminDashboard();
      } else {
        document.getElementById('headerTitle').textContent = '회의자료 작성 시스템';
        document.getElementById('adminTabs').style.display = 'none';
        document.getElementById('dashboardTab').style.display = 'none';
        document.getElementById('writerContent').style.display = 'block';
      }
    }

    function showLoginPage() {
      document.getElementById('loginPage').style.display = 'flex';
      document.getElementById('mainApp').style.display = 'none';
    }

    function logout() {
      sessionStorage.removeItem('currentUser');
      sessionStorage.removeItem('currentUserRole');
      currentUser = null;
      currentUserRole = null;
      
      // 폼 초기화
      document.getElementById('adminId').value = 'OKADMIN';
      document.getElementById('adminPassword').value = '';
      document.getElementById('writerId').value = '';
      document.getElementById('writerPassword').value = '';
      
      hideMessage();
      showLoginPage();
    }

    function switchTab(tabName) {
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      event.target.classList.add('active');
      
      document.querySelectorAll('.tab-content').forEach(content => {
        content.style.display = 'none';
      });
      
      document.getElementById(tabName + 'Tab').style.display = 'block';
    }

    function showMessage(message, type) {
      const messageElement = document.getElementById('loginMessage');
      messageElement.textContent = message;
      messageElement.className = `login-message ${type}`;
      messageElement.style.display = 'block';
    }

    function hideMessage() {
      document.getElementById('loginMessage').style.display = 'none';
    }

    function showPasswordMessage(message, type) {
      const messageElement = document.getElementById('passwordMessage');
      messageElement.textContent = message;
      messageElement.className = `login-message ${type}`;
      messageElement.style.display = 'block';
    }

    function recordLoginAttempt(userId, success) {
      const records = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      const newRecord = {
        userId: userId,
        timestamp: new Date().toISOString(),
        success: success,
        ip: 'localhost', // 실제 구현에서는 IP를 가져오는 로직 추가
        userAgent: navigator.userAgent
      };
      
      records.push(newRecord);
      
      // 최대 1000개 기록 유지
      if (records.length > 1000) {
        records.splice(0, records.length - 1000);
      }
      
      localStorage.setItem('loginRecords', JSON.stringify(records));
    }

    // 작성자 회의 선택 로직
    function goToMeeting() {
      const year = document.getElementById('yearSelect').value;
      const month = document.getElementById('monthSelect').value;
      const meetingType = document.getElementById('meetingTypeSelect').value;
      
      if (!year || !month || !meetingType) {
        alert('모든 항목을 선택해주세요.');
        return;
      }
      
      // 회의 페이지로 이동하는 로직 (추후 구현)
      alert(`${year}년 ${month}월 ${meetingType} 회의자료 작성 페이지로 이동합니다.`);
    }

    // 회의 선택 유효성 검사
    document.addEventListener('DOMContentLoaded', function() {
      const selectors = ['yearSelect', 'monthSelect', 'meetingTypeSelect'];
      selectors.forEach(id => {
        document.getElementById(id).addEventListener('change', function() {
          checkMeetingSelection();
        });
      });
    });

    function checkMeetingSelection() {
      const year = document.getElementById('yearSelect').value;
      const month = document.getElementById('monthSelect').value;
      const meetingType = document.getElementById('meetingTypeSelect').value;
      
      document.getElementById('confirmBtn').disabled = !(year && month && meetingType);
    }

    // 엔터 키 이벤트
    document.getElementById('adminPassword').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        handleAdminLogin();
      }
    });

    document.getElementById('writerPassword').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        handleWriterLogin();
      }
    });

    // ========== 대시보드 기능 ==========
    let meetingData = {};
    let currentMeetingData = [];
    let selectedMeeting = null;

    // 대시보드 초기화
    function initializeDashboard() {
      loadMeetingData();
      updateDashboardStats();
      setupFilterEventListeners();
    }

    // 회의 데이터 로드
    function loadMeetingData() {
      meetingData = JSON.parse(localStorage.getItem('meetingData') || '{}');
    }

    // 필터 이벤트 리스너 설정
    function setupFilterEventListeners() {
      const filterIds = ['filterYear', 'filterMonth', 'filterType'];
      filterIds.forEach(id => {
        const element = document.getElementById(id);
        if (element) {
          element.addEventListener('change', checkSearchValid);
        }
      });
    }

    // 검색 버튼 활성화 체크
    function checkSearchValid() {
      const year = document.getElementById('filterYear').value;
      const month = document.getElementById('filterMonth').value;
      const type = document.getElementById('filterType').value;
      
      const searchBtn = document.getElementById('searchBtn');
      if (searchBtn) {
        searchBtn.disabled = !(year && month && type);
      }
    }

    // 회의 검색
    function searchMeeting() {
      const year = document.getElementById('filterYear').value;
      const month = document.getElementById('filterMonth').value;
      const type = document.getElementById('filterType').value;
      
      if (!year || !month || !type) {
        alert('모든 항목을 선택해주세요.');
        return;
      }
      
      const meetingId = `${year}-${month}-${type}`;
      const meetingName = generateMeetingName(year, month, type);
      
      selectedMeeting = {
        id: meetingId,
        name: meetingName,
        year,
        month,
        type
      };
      
      // 부서별 데이터 준비
      currentMeetingData = [];
      departments.forEach(dept => {
        const deptData = meetingData[meetingId] ? meetingData[meetingId][dept] : null;
        const status = getDepartmentStatus(deptData);
        const lastModified = getLastModified(deptData);
        
        currentMeetingData.push({
          meetingId,
          meetingName,
          department: dept,
          status,
          lastModified,
          data: deptData
        });
      });
      
      updateDashboardStats();
      renderMeetingTable();
    }

    // 회의명 생성
    function generateMeetingName(year, month, type) {
      const monthName = parseInt(month) + '월';
      if (type === 'monthly') {
        return `${year}년 ${monthName} 월간간담회`;
      } else {
        const weekNum = type.replace('week', '');
        return `${year}년 ${monthName} ${weekNum}주차 주간간담회`;
      }
    }

    // 부서 상태 확인
    function getDepartmentStatus(deptData) {
      if (!deptData) return 'not-started';
      if (deptData.completed) return 'completed';
      
      const hasContent = Object.keys(deptData).some(key => 
        key !== 'completed' && key !== 'lastModified' && 
        deptData[key] && deptData[key].toString().trim() !== ''
      );
      
      return hasContent ? 'pending' : 'not-started';
    }

    // 마지막 수정일 확인
    function getLastModified(deptData) {
      if (!deptData || !deptData.lastModified) return '-';
      const date = new Date(deptData.lastModified);
      return date.toLocaleDateString('ko-KR') + ' ' + date.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'});
    }

    // 대시보드 통계 업데이트
    function updateDashboardStats() {
      const stats = calculateStats();
      
      document.getElementById('totalMeetings').textContent = stats.totalDepartments;
      document.getElementById('completedTasks').textContent = stats.completed;
      document.getElementById('pendingTasks').textContent = stats.pending;
      document.getElementById('notStartedTasks').textContent = stats.notStarted;
    }

    // 통계 계산
    function calculateStats() {
      if (!selectedMeeting) {
        return { totalDepartments: 16, completed: 0, pending: 0, notStarted: 0 };
      }
      
      const totalDepartments = departments.length;
      let completed = 0;
      let pending = 0;
      let notStarted = 0;
      
      currentMeetingData.forEach(item => {
        switch(item.status) {
          case 'completed': completed++; break;
          case 'pending': pending++; break;
          case 'not-started': notStarted++; break;
        }
      });
      
      return { totalDepartments, completed, pending, notStarted };
    }

    // 회의 테이블 렌더링
    function renderMeetingTable() {
      const emptyState = document.getElementById('emptyState');
      const tableContainer = document.getElementById('dataTableContainer');
      const tableBody = document.getElementById('dataTableBody');
      
      if (!selectedMeeting || currentMeetingData.length === 0) {
        emptyState.style.display = 'block';
        tableContainer.style.display = 'none';
        return;
      }
      
      emptyState.style.display = 'none';
      tableContainer.style.display = 'block';
      
      tableBody.innerHTML = '';
      currentMeetingData.forEach(item => {
        const row = createTableRow(item);
        tableBody.appendChild(row);
      });
    }

    // 테이블 행 생성
    function createTableRow(item) {
      const row = document.createElement('tr');
      
      const statusText = {
        'completed': '작성완료',
        'pending': '작성중',
        'not-started': '미작성'
      };
      
      const statusClass = {
        'completed': 'status-completed',
        'pending': 'status-pending',
        'not-started': 'status-not-started'
      };
      
      row.innerHTML = `
        <td>${item.meetingName}</td>
        <td>${item.department}</td>
        <td><span class="status-badge ${statusClass[item.status]}">${statusText[item.status]}</span></td>
        <td>${item.lastModified}</td>
        <td>
          <button class="btn-action btn-view" onclick="viewMeetingDetail('${item.meetingId}', '${item.department}')">보기</button>
          <button class="btn-action btn-edit" onclick="editMeetingDetail('${item.meetingId}', '${item.department}')">수정</button>
          <button class="btn-action btn-delete" onclick="deleteMeetingDetail('${item.meetingId}', '${item.department}')">삭제</button>
        </td>
      `;
      
      return row;
    }

    // 회의 상세보기
    function viewMeetingDetail(meetingId, department) {
      const data = meetingData[meetingId] ? meetingData[meetingId][department] : null;
      if (data) {
        alert(`${department}의 회의자료:\n\n주요사항: ${data.keyPoints || '없음'}\n전월/전주 실적: ${data.previousResults || '없음'}\n금월/금주 계획: ${data.currentPlan || '없음'}`);
      } else {
        alert(`${department}의 회의자료가 없습니다.`);
      }
    }

    // 회의 수정
    function editMeetingDetail(meetingId, department) {
      alert(`${department}의 회의자료 수정 기능은 작성자 모드에서 사용할 수 있습니다.`);
    }

    // 회의 삭제
    function deleteMeetingDetail(meetingId, department) {
      if (!confirm(`${department}의 회의자료를 삭제하시겠습니까?`)) return;
      
      if (meetingData[meetingId] && meetingData[meetingId][department]) {
        delete meetingData[meetingId][department];
        
        // 해당 회의에 다른 부서 데이터가 없으면 회의 자체 삭제
        if (Object.keys(meetingData[meetingId]).length === 0) {
          delete meetingData[meetingId];
        }
        
        localStorage.setItem('meetingData', JSON.stringify(meetingData));
        searchMeeting(); // 테이블 새로고침
        alert('회의자료가 삭제되었습니다.');
      }
    }

    // 데이터 내보내기
    function exportCurrentData() {
      if (!selectedMeeting) {
        alert('먼저 회의를 선택해주세요.');
        return;
      }
      
      const csvContent = generateCSV(currentMeetingData);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `${selectedMeeting.name}_현황데이터_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // CSV 생성
    function generateCSV(data) {
      const headers = ['회의명', '부서', '상태', '마지막수정'];
      const rows = data.map(item => [
        item.meetingName,
        item.department,
        item.status === 'completed' ? '작성완료' : item.status === 'pending' ? '작성중' : '미작성',
        item.lastModified
      ]);
      
      const csvContent = [headers, ...rows]
        .map(row => row.map(field => `"${field}"`).join(','))
        .join('\n');
        
      return '\uFEFF' + csvContent; // BOM 추가 (한글 깨짐 방지)
    }

    // 데이터 새로고침
    function refreshData() {
      loadMeetingData();
      updateDashboardStats();
      if (selectedMeeting) {
        searchMeeting();
      }
      alert('데이터가 새로고침되었습니다.');
    }

    // 관리자 로그인 후 대시보드 초기화
    function initializeAdminDashboard() {
      if (currentUserRole === 'admin') {
        setTimeout(() => {
          initializeDashboard();
          initializeAccountManagement();
          initializeSecuritySettings();
        }, 100);
      }
    }

    // ========== 계정 관리 기능 ==========
    
    // 계정 관리 초기화
    function initializeAccountManagement() {
      setupAccountSelectors();
      updateAccountStats();
      renderAccountTable();
    }

    // 계정 선택기 설정
    function setupAccountSelectors() {
      const accountSelect = document.getElementById('newAccountId');
      const deptSelect = document.getElementById('newAccountDept');
      
      if (accountSelect) {
        accountSelect.innerHTML = '<option value="">계정 ID 선택</option>';
        
        // 기존 계정 확인
        const existingAccounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
        const existingIds = existingAccounts.filter(acc => acc.role === 'writer').map(acc => acc.id);
        
        for (let i = 1; i <= 20; i++) {
          const accountId = `OK ${i}`;
          if (!existingIds.includes(accountId)) {
            const option = document.createElement('option');
            option.value = accountId;
            option.textContent = accountId;
            accountSelect.appendChild(option);
          }
        }
      }
      
      if (deptSelect) {
        deptSelect.innerHTML = '<option value="">부서 선택</option>';
        departments.forEach(dept => {
          const option = document.createElement('option');
          option.value = dept;
          option.textContent = dept;
          deptSelect.appendChild(option);
        });
      }
    }

    // 계정 통계 업데이트
    function updateAccountStats() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const writerAccounts = accounts.filter(acc => acc.role === 'writer');
      
      const total = writerAccounts.length;
      const active = writerAccounts.filter(acc => acc.status !== 'inactive').length;
      const inactive = writerAccounts.filter(acc => acc.status === 'inactive').length;
      const online = writerAccounts.filter(acc => acc.status === 'online').length;
      
      document.getElementById('totalAccounts').textContent = total;
      document.getElementById('activeAccounts').textContent = active;
      document.getElementById('inactiveAccounts').textContent = inactive;
      document.getElementById('onlineAccounts').textContent = online;
    }

    // 새 계정 생성
    function createNewAccount() {
      const accountId = document.getElementById('newAccountId').value;
      const password = document.getElementById('newAccountPw').value;
      const department = document.getElementById('newAccountDept').value;
      const messageElement = document.getElementById('accountCreationMessage');
      
      if (!accountId || !password || !department) {
        showAccountMessage('모든 필드를 입력해주세요.', 'error');
        return;
      }
      
      if (password.length < 4) {
        showAccountMessage('비밀번호는 4자 이상이어야 합니다.', 'error');
        return;
      }
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const existingAccount = accounts.find(acc => acc.id === accountId);
      
      if (existingAccount) {
        showAccountMessage('이미 존재하는 계정 ID입니다.', 'error');
        return;
      }
      
      const newAccount = {
        id: accountId,
        password: password,
        role: 'writer',
        department: department,
        status: 'active',
        isFirstLogin: true,
        createdAt: new Date().toISOString(),
        lastLogin: null
      };
      
      accounts.push(newAccount);
      localStorage.setItem('systemAccounts', JSON.stringify(accounts));
      
      // 폼 초기화
      document.getElementById('newAccountId').value = '';
      document.getElementById('newAccountPw').value = '';
      document.getElementById('newAccountDept').value = '';
      
      showAccountMessage(`계정 "${accountId}"가 성공적으로 생성되었습니다!`, 'success');
      
      // 화면 업데이트
      setupAccountSelectors();
      updateAccountStats();
      renderAccountTable();
    }

    // 계정 테이블 렌더링
    function renderAccountTable() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const writerAccounts = accounts.filter(acc => acc.role === 'writer');
      const tbody = document.getElementById('accountTableBody');
      
      if (writerAccounts.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; color: #999; padding: 40px;">
              등록된 계정이 없습니다.
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = writerAccounts.map((account, index) => `
        <tr>
          <td>${index + 1}</td>
          <td><strong>${account.id}</strong></td>
          <td>${account.department || '-'}</td>
          <td><span class="account-status ${account.status || 'active'}">${getStatusText(account.status)}</span></td>
          <td>${new Date(account.createdAt).toLocaleDateString('ko-KR')}</td>
          <td>${account.lastLogin ? new Date(account.lastLogin).toLocaleString('ko-KR') : '없음'}</td>
          <td>
            ${account.status === 'active' ? 
              `<button class="btn-manage btn-deactivate" onclick="toggleAccountStatus('${account.id}', 'inactive')">비활성화</button>` :
              `<button class="btn-manage btn-activate" onclick="toggleAccountStatus('${account.id}', 'active')">활성화</button>`
            }
            <button class="btn-manage btn-reset" onclick="resetAccountPassword('${account.id}')">비밀번호 초기화</button>
            <button class="btn-manage btn-remove" onclick="removeAccount('${account.id}')">삭제</button>
          </td>
        </tr>
      `).join('');
    }

    // 계정 상태 텍스트 변환
    function getStatusText(status) {
      switch(status) {
        case 'active': return '활성';
        case 'inactive': return '비활성';
        case 'online': return '접속중';
        default: return '활성';
      }
    }

    // 계정 상태 토글
    function toggleAccountStatus(accountId, newStatus) {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const accountIndex = accounts.findIndex(acc => acc.id === accountId);
      
      if (accountIndex !== -1) {
        accounts[accountIndex].status = newStatus;
        localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        
        updateAccountStats();
        renderAccountTable();
        
        const statusText = newStatus === 'active' ? '활성화' : '비활성화';
        alert(`계정 "${accountId}"이 ${statusText}되었습니다.`);
      }
    }

    // 계정 비밀번호 초기화
    function resetAccountPassword(accountId) {
      if (!confirm(`계정 "${accountId}"의 비밀번호를 초기화하시겠습니까?`)) return;
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const accountIndex = accounts.findIndex(acc => acc.id === accountId);
      
      if (accountIndex !== -1) {
        accounts[accountIndex].password = 'writer123';
        accounts[accountIndex].isFirstLogin = true;
        localStorage.setItem('systemAccounts', JSON.stringify(accounts));
        
        alert(`계정 "${accountId}"의 비밀번호가 "writer123"으로 초기화되었습니다.`);
      }
    }

    // 계정 삭제
    function removeAccount(accountId) {
      if (!confirm(`계정 "${accountId}"를 완전히 삭제하시겠습니까?`)) return;
      
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const filteredAccounts = accounts.filter(acc => acc.id !== accountId);
      
      localStorage.setItem('systemAccounts', JSON.stringify(filteredAccounts));
      
      setupAccountSelectors();
      updateAccountStats();
      renderAccountTable();
      
      alert(`계정 "${accountId}"가 삭제되었습니다.`);
    }

    // 계정 데이터 내보내기
    function exportAccountData() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const writerAccounts = accounts.filter(acc => acc.role === 'writer');
      
      if (writerAccounts.length === 0) {
        alert('내보낼 계정 데이터가 없습니다.');
        return;
      }
      
      const csvContent = generateAccountCSV(writerAccounts);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `계정목록_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // 계정 CSV 생성
    function generateAccountCSV(accounts) {
      const headers = ['번호', '계정ID', '담당부서', '상태', '생성일', '마지막로그인'];
      const rows = accounts.map((account, index) => [
        index + 1,
        account.id,
        account.department || '-',
        getStatusText(account.status),
        new Date(account.createdAt).toLocaleDateString('ko-KR'),
        account.lastLogin ? new Date(account.lastLogin).toLocaleString('ko-KR') : '없음'
      ]);
      
      const csvContent = [headers, ...rows]
        .map(row => row.map(field => `"${field}"`).join(','))
        .join('\n');
        
      return '\uFEFF' + csvContent;
    }

    // 계정 데이터 새로고침
    function refreshAccountData() {
      updateAccountStats();
      renderAccountTable();
      setupAccountSelectors();
      alert('계정 데이터가 새로고침되었습니다.');
    }

    // 계정 메시지 표시
    function showAccountMessage(message, type) {
      const messageElement = document.getElementById('accountCreationMessage');
      messageElement.textContent = message;
      messageElement.className = `login-message ${type}`;
      messageElement.style.display = 'block';
      
      setTimeout(() => {
        messageElement.style.display = 'none';
      }, 3000);
    }

    // ========== 보안 설정 기능 ==========
    
    // 보안 설정 초기화
    function initializeSecuritySettings() {
      updateSecurityStats();
      loadAdminInfo();
      setupLoginFilters();
      renderLoginRecords();
    }

    // 보안 통계 업데이트
    function updateSecurityStats() {
      const loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      
      const totalLogins = loginRecords.length;
      const successLogins = loginRecords.filter(record => record.success).length;
      const failedLogins = loginRecords.filter(record => !record.success).length;
      const onlineUsers = accounts.filter(acc => acc.status === 'online').length;
      
      document.getElementById('totalLogins').textContent = totalLogins;
      document.getElementById('successLogins').textContent = successLogins;
      document.getElementById('failedLogins').textContent = failedLogins;
      document.getElementById('onlineUsers').textContent = onlineUsers;
    }

    // 관리자 정보 로드
    function loadAdminInfo() {
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      const adminAccount = accounts.find(acc => acc.id === 'OKADMIN');
      
      if (adminAccount && adminAccount.lastLogin) {
        const lastLoginDate = new Date(adminAccount.lastLogin);
        document.getElementById('adminLastLogin').textContent = lastLoginDate.toLocaleString('ko-KR');
      } else {
        document.getElementById('adminLastLogin').textContent = '-';
      }
    }

    // 로그인 필터 설정
    function setupLoginFilters() {
      const userFilter = document.getElementById('loginUserFilter');
      const accounts = JSON.parse(localStorage.getItem('systemAccounts') || '[]');
      
      if (userFilter) {
        userFilter.innerHTML = '<option value="">전체 사용자</option>';
        
        // 고유한 사용자 ID만 추출
        const uniqueUsers = [...new Set(accounts.map(acc => acc.id))];
        uniqueUsers.forEach(userId => {
          const option = document.createElement('option');
          option.value = userId;
          option.textContent = userId;
          userFilter.appendChild(option);
        });
      }
    }

    // 로그인 기록 렌더링
    function renderLoginRecords() {
      const loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      const tbody = document.getElementById('loginRecordsBody');
      
      if (loginRecords.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
              로그인 기록이 없습니다.
            </td>
          </tr>
        `;
        return;
      }
      
      // 최신 기록부터 표시
      const sortedRecords = loginRecords.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      tbody.innerHTML = sortedRecords.map((record, index) => `
        <tr>
          <td>${index + 1}</td>
          <td><strong>${record.userId}</strong></td>
          <td>${new Date(record.timestamp).toLocaleString('ko-KR')}</td>
          <td><span class="login-status ${record.success ? 'success' : 'failed'}">${record.success ? '성공' : '실패'}</span></td>
          <td><span class="ip-address">${record.ip || 'localhost'}</span></td>
          <td><span class="browser-info" title="${record.userAgent || 'Unknown'}">${getBrowserName(record.userAgent)}</span></td>
        </tr>
      `).join('');
    }

    // 브라우저 이름 추출
    function getBrowserName(userAgent) {
      if (!userAgent) return 'Unknown';
      
      if (userAgent.includes('Chrome')) return 'Chrome';
      if (userAgent.includes('Firefox')) return 'Firefox';
      if (userAgent.includes('Safari')) return 'Safari';
      if (userAgent.includes('Edge')) return 'Edge';
      if (userAgent.includes('Opera')) return 'Opera';
      
      return 'Unknown';
    }

    // 로그인 필터 적용
    function applyLoginFilters() {
      const userFilter = document.getElementById('loginUserFilter').value;
      const statusFilter = document.getElementById('loginStatusFilter').value;
      const dateFilter = document.getElementById('loginDateFilter').value;
      
      let loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      
      // 필터 적용
      if (userFilter) {
        loginRecords = loginRecords.filter(record => record.userId === userFilter);
      }
      
      if (statusFilter) {
        const isSuccess = statusFilter === 'true';
        loginRecords = loginRecords.filter(record => record.success === isSuccess);
      }
      
      if (dateFilter) {
        const filterDate = new Date(dateFilter);
        loginRecords = loginRecords.filter(record => {
          const recordDate = new Date(record.timestamp);
          return recordDate.toDateString() === filterDate.toDateString();
        });
      }
      
      renderFilteredLoginRecords(loginRecords);
    }

    // 필터된 로그인 기록 렌더링
    function renderFilteredLoginRecords(records) {
      const tbody = document.getElementById('loginRecordsBody');
      
      if (records.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
              필터 조건에 맞는 로그인 기록이 없습니다.
            </td>
          </tr>
        `;
        return;
      }
      
      const sortedRecords = records.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));
      
      tbody.innerHTML = sortedRecords.map((record, index) => `
        <tr>
          <td>${index + 1}</td>
          <td><strong>${record.userId}</strong></td>
          <td>${new Date(record.timestamp).toLocaleString('ko-KR')}</td>
          <td><span class="login-status ${record.success ? 'success' : 'failed'}">${record.success ? '성공' : '실패'}</span></td>
          <td><span class="ip-address">${record.ip || 'localhost'}</span></td>
          <td><span class="browser-info" title="${record.userAgent || 'Unknown'}">${getBrowserName(record.userAgent)}</span></td>
        </tr>
      `).join('');
    }

    // 관리자 비밀번호 변경
    function showAdminPasswordChange() {
      showPasswordModal();
    }

    // 시스템 설정
    function showSystemSettings() {
      alert('시스템 설정 기능은 추후 업데이트 예정입니다.');
    }

    // 로그인 데이터 내보내기
    function exportLoginData() {
      const loginRecords = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      
      if (loginRecords.length === 0) {
        alert('내보낼 로그인 데이터가 없습니다.');
        return;
      }
      
      const csvContent = generateLoginCSV(loginRecords);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `로그인기록_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // 로그인 CSV 생성
    function generateLoginCSV(records) {
      const headers = ['번호', '사용자ID', '로그인시간', '상태', 'IP주소', '브라우저'];
      const rows = records.map((record, index) => [
        index + 1,
        record.userId,
        new Date(record.timestamp).toLocaleString('ko-KR'),
        record.success ? '성공' : '실패',
        record.ip || 'localhost',
        getBrowserName(record.userAgent)
      ]);
      
      const csvContent = [headers, ...rows]
        .map(row => row.map(field => `"${field}"`).join(','))
        .join('\n');
        
      return '\uFEFF' + csvContent;
    }

    // 로그인 기록 삭제
    function clearLoginRecords() {
      if (!confirm('모든 로그인 기록을 삭제하시겠습니까?')) return;
      
      localStorage.removeItem('loginRecords');
      
      updateSecurityStats();
      renderLoginRecords();
      
      alert('로그인 기록이 삭제되었습니다.');
    }

    // 로그인 데이터 새로고침
    function refreshLoginData() {
      updateSecurityStats();
      renderLoginRecords();
      setupLoginFilters();
      
      // 필터 초기화
      document.getElementById('loginUserFilter').value = '';
      document.getElementById('loginStatusFilter').value = '';
      document.getElementById('loginDateFilter').value = '';
      
      alert('로그인 데이터가 새로고침되었습니다.');
    }
  </script>
</body>
</html>


