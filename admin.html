<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OKì €ì¶•ì€í–‰ íšŒì˜ìë£Œ ê´€ë¦¬ ì‹œìŠ¤í…œ - ê´€ë¦¬ì</title>
  <style>
    :root {
      --ok-orange: #E93D1A;
      --ok-dark-brown: #554744;
      --ok-yellow: #F4A611;
      --ok-bright-gray: #C5C5C5;
      --ok-bg-gray: #F8F8F8;
      --ok-text-dark: #2D2D2D;
      --ok-border-light: #E8E8E8;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
      background-color: var(--ok-bg-gray);
      color: var(--ok-text-dark);
      min-height: 100vh;
    }

    /* í—¤ë” */
    .admin-header {
      background: linear-gradient(135deg, var(--ok-dark-brown) 0%, #3D2F2C 100%);
      color: white;
      padding: 20px 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      position: relative;
    }

    .admin-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1400px;
      margin: 0 auto;
    }

    .header-title {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .ok-logo {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .ok-logo-text {
      font-size: 2rem;
      font-weight: 900;
      color: white;
      letter-spacing: 1px;
    }

    .ok-logo-accent {
      color: var(--ok-orange);
      font-size: 2.2rem;
    }

    .header-title h1 {
      font-size: 1.8rem;
      font-weight: 700;
      letter-spacing: -0.5px;
    }

    .header-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .btn-header {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }

         .btn-header:hover {
       background: #ff4520;
       transform: translateY(-2px);
     }

     /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
     .tab-navigation {
       background: white;
       border-bottom: 2px solid var(--ok-border-light);
       padding: 0;
       margin: 0;
       box-shadow: 0 2px 10px rgba(0,0,0,0.05);
     }

     .tab-container {
       max-width: 1400px;
       margin: 0 auto;
       display: flex;
     }

     .tab-button {
       background: none;
       border: none;
       padding: 20px 30px;
       font-size: 1.1rem;
       font-weight: 600;
       color: var(--ok-text-dark);
       cursor: pointer;
       transition: all 0.3s ease;
       border-bottom: 3px solid transparent;
       position: relative;
     }

     .tab-button:hover {
       background: rgba(233, 61, 26, 0.05);
       color: var(--ok-orange);
     }

     .tab-button.active {
       color: var(--ok-orange);
       border-bottom-color: var(--ok-orange);
       background: rgba(233, 61, 26, 0.05);
     }

     .tab-button.active::before {
       content: '';
       position: absolute;
       top: 0;
       left: 0;
       right: 0;
       height: 3px;
       background: var(--ok-orange);
     }

    .btn-secondary {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.3);
    }

    .btn-secondary:hover {
      background: rgba(255,255,255,0.2);
      border-color: rgba(255,255,255,0.5);
    }

    /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
    .admin-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 30px;
    }

    /* ëŒ€ì‹œë³´ë“œ ì¹´ë“œë“¤ */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }

    .dashboard-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      position: relative;
      overflow: hidden;
    }

    .dashboard-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--ok-text-dark);
    }

    .card-icon {
      font-size: 2rem;
    }

    .card-number {
      font-size: 3rem;
      font-weight: 900;
      color: var(--ok-orange);
      margin-bottom: 10px;
    }

    .card-description {
      color: var(--ok-dark-brown);
      font-size: 1rem;
    }

    /* í•„í„° ì„¹ì…˜ */
    .filter-section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
    }

    .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-group label {
      font-weight: 600;
      color: var(--ok-text-dark);
      font-size: 0.95rem;
    }

    .filter-select {
      padding: 12px 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 8px;
      font-size: 1rem;
      background: #fafafa;
      color: var(--ok-text-dark);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--ok-orange);
      background: white;
    }

    .btn-filter {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      height: fit-content;
    }

    .btn-filter:hover {
      background: #ff4520;
    }

    /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
    .table-container {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
    }

    .table-header {
      background: var(--ok-dark-brown);
      color: white;
      padding: 20px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-title {
      font-size: 1.3rem;
      font-weight: 700;
    }

    .table-actions {
      display: flex;
      gap: 10px;
    }

    .btn-table {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-table:hover {
      background: #ff4520;
    }

    .btn-danger {
      background: #dc3545;
    }

    .btn-danger:hover {
      background: #c82333;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.95rem;
    }

    .data-table th,
    .data-table td {
      padding: 15px 20px;
      text-align: left;
      border-bottom: 1px solid var(--ok-border-light);
    }

    .data-table th {
      background: #f8f9fa;
      font-weight: 600;
      color: var(--ok-text-dark);
      position: sticky;
      top: 0;
    }

    .data-table tbody tr:hover {
      background: #f8f9fa;
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 600;
      text-align: center;
      min-width: 80px;
      display: inline-block;
    }

    .status-completed {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .status-not-started {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f1b0b7;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e9ecef;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      transition: width 0.3s ease;
    }

    .action-buttons {
      display: flex;
      gap: 8px;
    }

    .btn-action {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-view {
      background: #007bff;
      color: white;
    }

    .btn-view:hover {
      background: #0056b3;
    }

    .btn-edit {
      background: #28a745;
      color: white;
    }

    .btn-edit:hover {
      background: #1e7e34;
    }

    .btn-delete {
      background: #dc3545;
      color: white;
    }

    .btn-delete:hover {
      background: #c82333;
    }

    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }

    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--ok-border-light);
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--ok-text-dark);
    }

    .close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: var(--ok-orange);
    }

    .modal-body {
      margin-bottom: 25px;
    }

    .modal-field {
      margin-bottom: 20px;
    }

    .modal-field label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--ok-text-dark);
    }

    .modal-field textarea,
    .modal-field input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
    }

    .modal-field textarea {
      min-height: 100px;
    }

    .modal-field textarea:focus,
    .modal-field input:focus {
      outline: none;
      border-color: var(--ok-orange);
    }

    .modal-key-points-section {
      background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
      border: 2px solid var(--ok-border-light);
      border-radius: 8px;
      padding: 15px;
      margin-bottom: 20px;
      position: relative;
    }

    .modal-key-points-section::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 3px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      border-radius: 8px 8px 0 0;
    }

    .modal-key-points-section label {
      display: block;
      font-weight: 700;
      color: var(--ok-text-dark);
      margin-bottom: 10px;
      font-size: 1.1rem;
      letter-spacing: -0.3px;
      text-align: center;
      background: linear-gradient(135deg, var(--ok-dark-brown) 0%, #3d2f2c 100%);
      color: white;
      padding: 10px 15px;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }

    .modal-key-points-section textarea {
      width: 100%;
      min-height: 80px;
      padding: 12px;
      border: 2px solid var(--ok-border-light);
      border-radius: 6px;
      font-size: 0.95rem;
      resize: vertical;
      transition: all 0.3s ease;
      font-family: inherit;
      background: white;
    }

    .modal-content-fields-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    .modal-content-fields-container .modal-field label {
      display: block;
      font-weight: 600;
      color: var(--ok-text-dark);
      margin-bottom: 8px;
      font-size: 1rem;
      letter-spacing: -0.3px;
      text-align: center;
      background: linear-gradient(135deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      color: white;
      padding: 8px 12px;
      border-radius: 6px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .modal-content-fields-container .modal-field textarea {
      min-height: 120px;
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .btn-modal {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: var(--ok-orange);
      color: white;
    }

    .btn-primary:hover {
      background: #ff4520;
    }

    .btn-cancel {
      background: var(--ok-bright-gray);
      color: var(--ok-text-dark);
    }

    .btn-cancel:hover {
      background: #a8a8a8;
    }

    /* ë°˜ì‘í˜• ë””ìì¸ */
    @media (max-width: 768px) {
      .admin-container {
        padding: 20px;
      }

      .header-content {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      .filter-grid {
        grid-template-columns: 1fr;
      }

      .dashboard-grid {
        grid-template-columns: 1fr;
      }

      .data-table {
        font-size: 0.85rem;
      }

      .data-table th,
      .data-table td {
        padding: 10px 12px;
      }

      .modal-content-fields-container {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .summary-content-fields-container {
        grid-template-columns: 1fr;
        gap: 15px;
      }

      .security-cards {
        grid-template-columns: 1fr;
        gap: 20px;
      }

      .tab-container {
        flex-direction: column;
      }

      .tab-button {
        padding: 15px 20px;
        font-size: 1rem;
      }

      .login-records-table {
        font-size: 0.85rem;
      }

      .login-records-table th,
      .login-records-table td {
        padding: 10px 8px;
      }
    }

    /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
    .loading {
      display: none;
      text-align: center;
      padding: 50px;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--ok-orange);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* ë¹ˆ ìƒíƒœ */
    .empty-state {
      text-align: center;
      padding: 50px 20px;
      color: var(--ok-bright-gray);
    }

    .empty-state i {
      font-size: 4rem;
      margin-bottom: 20px;
      display: block;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: var(--ok-text-dark);
    }

         .empty-state p {
       font-size: 1rem;
     }

     /* ì·¨í•© í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
     .summary-content {
       padding: 30px;
     }

     .summary-header {
       text-align: center;
       margin-bottom: 40px;
       border-bottom: 3px solid var(--ok-orange);
       padding-bottom: 20px;
     }

     .summary-header h2 {
       font-size: 2rem;
       color: var(--ok-text-dark);
       margin-bottom: 10px;
       font-weight: 700;
     }

     .summary-header p {
       color: var(--ok-dark-brown);
       font-size: 1.1rem;
     }

     .department-summary {
       margin-bottom: 40px;
       border: 2px solid var(--ok-border-light);
       border-radius: 12px;
       overflow: hidden;
     }

     .department-summary-header {
       background: var(--ok-dark-brown);
       color: white;
       padding: 15px 25px;
       font-weight: 700;
       font-size: 1.2rem;
       display: flex;
       justify-content: space-between;
       align-items: center;
     }

     .department-summary-content {
       padding: 25px;
     }

     .summary-field {
       margin-bottom: 25px;
     }

     .summary-field-title {
       font-weight: 700;
       color: var(--ok-dark-brown);
       font-size: 1.1rem;
       margin-bottom: 10px;
       border-left: 4px solid var(--ok-orange);
       padding-left: 12px;
     }

     .summary-field-content {
       background: #f8f9fa;
       padding: 15px 20px;
       border-radius: 8px;
       border: 1px solid var(--ok-border-light);
       min-height: 60px;
       line-height: 1.6;
       white-space: pre-wrap;
     }

     .summary-field-content.empty {
       color: #999;
       font-style: italic;
     }

     .summary-key-points-section {
       background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
       border: 2px solid var(--ok-border-light);
       border-radius: 8px;
       padding: 15px;
       margin-bottom: 20px;
       position: relative;
     }

     .summary-key-points-section::before {
       content: '';
       position: absolute;
       top: 0;
       left: 0;
       right: 0;
       height: 3px;
       background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
       border-radius: 8px 8px 0 0;
     }

     .summary-key-points-section .summary-field-title {
       font-weight: 700;
       color: var(--ok-text-dark);
       margin-bottom: 10px;
       font-size: 1.1rem;
       letter-spacing: -0.3px;
       text-align: center;
       background: linear-gradient(135deg, var(--ok-dark-brown) 0%, #3d2f2c 100%);
       color: white;
       padding: 10px 15px;
       border-radius: 6px;
       box-shadow: 0 2px 6px rgba(0,0,0,0.1);
       border: none;
     }

     .summary-key-points-section .summary-field-content {
       min-height: 80px;
       background: white;
     }

     .summary-content-fields-container {
       display: grid;
       grid-template-columns: 1fr 1fr;
       gap: 20px;
     }

     .summary-content-fields-container .summary-field-title {
       font-weight: 600;
       color: var(--ok-text-dark);
       margin-bottom: 10px;
       font-size: 1rem;
       letter-spacing: -0.3px;
       text-align: center;
       background: linear-gradient(135deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
       color: white;
       padding: 8px 12px;
       border-radius: 6px;
       box-shadow: 0 2px 4px rgba(0,0,0,0.1);
       border: none;
     }

     .summary-content-fields-container .summary-field-content {
       min-height: 120px;
     }

     .department-status {
       padding: 8px 15px;
       border-radius: 20px;
       font-size: 0.9rem;
       font-weight: 600;
     }

     .summary-actions {
       margin-top: 30px;
       text-align: center;
     }

     .btn-summary {
       background: var(--ok-orange);
       color: white;
       border: none;
       padding: 12px 25px;
       border-radius: 8px;
       cursor: pointer;
       font-size: 1rem;
       font-weight: 600;
       margin: 0 10px;
       transition: all 0.3s ease;
     }

     .btn-summary:hover {
       background: #ff4520;
       transform: translateY(-2px);
     }

     @media print {
       .table-header, .summary-actions, .btn-summary {
         display: none !important;
       }
       
       .summary-header .summary-actions {
         display: none !important;
       }
       
       .summary-content {
         padding: 0;
       }
       
       .department-summary {
         break-inside: avoid;
         margin-bottom: 30px;
       }

       .summary-content-fields-container {
         display: grid;
         grid-template-columns: 1fr 1fr;
         gap: 15px;
       }

       .summary-key-points-section {
         background: #f8f9fa !important;
         -webkit-print-color-adjust: exact;
       }

       .summary-key-points-section .summary-field-title,
       .summary-content-fields-container .summary-field-title {
         background: #E93D1A !important;
         color: white !important;
         -webkit-print-color-adjust: exact;
       }

               .summary-key-points-section .summary-field-title {
          background: #554744 !important;
          -webkit-print-color-adjust: exact;
        }
      }

      /* ë³´ì•ˆ ì„¤ì • í˜ì´ì§€ */
      .security-section {
        display: none;
        padding: 30px;
      }

      .security-section.active {
        display: block;
      }

      .security-cards {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
        gap: 30px;
        margin-bottom: 30px;
      }

      .security-card {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        border: 2px solid var(--ok-border-light);
        position: relative;
        overflow: hidden;
      }

      .security-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      }

      .security-card h3 {
        color: var(--ok-text-dark);
        font-size: 1.5rem;
        margin-bottom: 20px;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .security-card h3 .icon {
        font-size: 1.8rem;
      }

      .security-form {
        display: flex;
        flex-direction: column;
        gap: 20px;
      }

      .security-field {
        display: flex;
        flex-direction: column;
        gap: 8px;
      }

      .security-field label {
        font-weight: 600;
        color: var(--ok-text-dark);
        font-size: 1rem;
      }

      .security-field input {
        padding: 15px;
        border: 2px solid var(--ok-border-light);
        border-radius: 8px;
        font-size: 1rem;
        transition: all 0.3s ease;
        background: #fafafa;
      }

      .security-field input:focus {
        outline: none;
        border-color: var(--ok-orange);
        background: white;
        box-shadow: 0 0 0 3px rgba(233, 61, 26, 0.1);
      }

      .security-field input:hover {
        border-color: var(--ok-yellow);
      }

      .btn-security {
        background: linear-gradient(135deg, var(--ok-orange) 0%, #ff6b35 100%);
        color: white;
        border: none;
        padding: 15px 25px;
        border-radius: 8px;
        font-size: 1rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 6px 20px rgba(233, 61, 26, 0.3);
        margin-top: 10px;
      }

      .btn-security:hover {
        transform: translateY(-2px);
        box-shadow: 0 8px 25px rgba(233, 61, 26, 0.4);
      }

      .btn-security:active {
        transform: translateY(0);
      }

      .login-records {
        background: white;
        border-radius: 15px;
        padding: 30px;
        box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        border: 2px solid var(--ok-border-light);
        position: relative;
        overflow: hidden;
      }

      .login-records::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 6px;
        background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      }

      .login-records h3 {
        color: var(--ok-text-dark);
        font-size: 1.5rem;
        margin-bottom: 25px;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .login-records-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
      }

      .login-records-table th,
      .login-records-table td {
        padding: 15px;
        text-align: left;
        border-bottom: 1px solid var(--ok-border-light);
      }

      .login-records-table th {
        background: var(--ok-bg-gray);
        font-weight: 600;
        color: var(--ok-text-dark);
      }

      .login-records-table tr:hover {
        background: rgba(233, 61, 26, 0.05);
      }

      .status-success {
        color: #28a745;
        font-weight: 600;
      }

      .status-failed {
        color: #dc3545;
        font-weight: 600;
      }

      .ip-address {
        font-family: 'Courier New', monospace;
        background: #f8f9fa;
        padding: 4px 8px;
        border-radius: 4px;
        font-size: 0.9rem;
      }

      /* ê³„ì • ê´€ë¦¬ ìŠ¤íƒ€ì¼ */
      .accounts-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 15px;
      }

      .accounts-table th,
      .accounts-table td {
        padding: 12px;
        text-align: left;
        border-bottom: 1px solid var(--ok-border-light);
      }

      .accounts-table th {
        background: var(--ok-bg-gray);
        font-weight: 600;
        color: var(--ok-text-dark);
      }

      .accounts-table tr:hover {
        background: rgba(233, 61, 26, 0.05);
      }

      .account-status {
        padding: 4px 12px;
        border-radius: 12px;
        font-size: 0.8rem;
        font-weight: 600;
      }

      .account-status.active {
        background: #d4edda;
        color: #155724;
      }

      .account-status.inactive {
        background: #f8d7da;
        color: #721c24;
      }

      .btn-account {
        background: var(--ok-orange);
        color: white;
        border: none;
        padding: 6px 12px;
        border-radius: 4px;
        font-size: 0.8rem;
        cursor: pointer;
        margin: 0 2px;
        transition: all 0.3s ease;
      }

      .btn-account:hover {
        background: #ff4520;
      }

      .btn-account.btn-danger {
        background: #dc3545;
      }

      .btn-account.btn-danger:hover {
        background: #c82333;
      }

      .btn-account.btn-warning {
        background: #ffc107;
        color: #212529;
      }

      .btn-account.btn-warning:hover {
        background: #e0a800;
      }
  </style>
</head>
<body>
  <!-- í—¤ë” -->
  <div class="admin-header">
    <div class="header-content">
             <div class="header-title">
                 <div class="ok-logo">
          <svg width="140" height="50" viewBox="0 0 140 50" style="height: 40px; width: auto;">
            <defs>
              <linearGradient id="bgGradient4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#554744;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3d3330;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="orangeGradient4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#E93D1A;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#d32f0f;stop-opacity:1" />
              </linearGradient>
            </defs>
            <rect width="140" height="50" rx="12" fill="url(#bgGradient4)"/>
            <rect x="0" y="0" width="8" height="50" rx="12" fill="url(#orangeGradient4)"/>
            <text x="18" y="34" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="#2a2a2a" opacity="0.3">OK</text>
            <text x="16" y="32" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="white">OK</text>
            <text x="52" y="34" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#2a2a2a" opacity="0.3">!</text>
            <text x="50" y="32" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#E93D1A">!</text>
            <text x="70" y="22" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white">ì €ì¶•ì€í–‰</text>
            <text x="70" y="36" font-family="Arial, sans-serif" font-size="9" font-weight="500" fill="#F4A611">SAVINGS BANK</text>
            <circle cx="125" cy="15" r="4" fill="#E93D1A" opacity="0.8"/>
            <circle cx="130" cy="25" r="2.5" fill="#F4A611" opacity="0.9"/>
            <circle cx="120" cy="35" r="2" fill="#E93D1A" opacity="0.6"/>
          </svg>
        </div>
         <h1>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
       </div>
      <div class="header-actions">
        <a href="index.html" class="btn-header btn-secondary">
          <span>ğŸ“‹</span>
          <span>íšŒì˜ìë£Œ ì…ë ¥</span>
        </a>
        <button class="btn-header" onclick="exportData()">
          <span>ğŸ“Š</span>
          <span>ë°ì´í„° ë‚´ë³´ë‚´ê¸°</span>
        </button>
        <button class="btn-header" onclick="refreshData()">
          <span>ğŸ”„</span>
          <span>ìƒˆë¡œê³ ì¹¨</span>
        </button>
      </div>
    </div>
  </div>

  <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
  <div class="tab-navigation">
    <div class="tab-container">
      <button class="tab-button active" onclick="switchTab('meeting')" id="meetingTab">
        ğŸ“Š íšŒì˜ìë£Œ ê´€ë¦¬
      </button>
      <button class="tab-button" onclick="switchTab('security')" id="securityTab">
        ğŸ” ë³´ì•ˆ ì„¤ì •
      </button>
    </div>
  </div>

  <!-- íšŒì˜ìë£Œ ê´€ë¦¬ ì„¹ì…˜ -->
  <div class="admin-container" id="meetingSection">
    <!-- ëŒ€ì‹œë³´ë“œ í†µê³„ -->
    <div class="dashboard-grid">
      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ì „ì²´ íšŒì˜</div>
          <div class="card-icon">ğŸ“…</div>
        </div>
        <div class="card-number" id="totalMeetings">0</div>
        <div class="card-description">2025ë…„ 8ì›”~12ì›”</div>
      </div>

      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ì‘ì„±ì™„ë£Œ</div>
          <div class="card-icon">âœ…</div>
        </div>
        <div class="card-number" id="completedTasks">0</div>
        <div class="card-description">ë¶€ì„œë³„ ì‘ì„±ì™„ë£Œ ê±´ìˆ˜</div>
      </div>

      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ì‘ì„±ì¤‘</div>
          <div class="card-icon">ğŸ“</div>
        </div>
        <div class="card-number" id="pendingTasks">0</div>
        <div class="card-description">ì‘ì„± ì§„í–‰ì¤‘ì¸ ê±´ìˆ˜</div>
      </div>

      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ë¯¸ì‘ì„±</div>
          <div class="card-icon">â³</div>
        </div>
        <div class="card-number" id="notStartedTasks">0</div>
        <div class="card-description">ì•„ì§ ì‹œì‘í•˜ì§€ ì•Šì€ ê±´ìˆ˜</div>
      </div>
    </div>

    <!-- íšŒì˜ ì„ íƒ ì„¹ì…˜ -->
    <div class="filter-section">
      <h3 style="margin-bottom: 20px; color: var(--ok-text-dark); font-size: 1.2rem;">íšŒì˜ ì„ íƒ</h3>
      <div class="filter-grid">
        <div class="filter-group">
          <label for="filterYear">ì—°ë„</label>
          <select id="filterYear" class="filter-select">
            <option value="">ì—°ë„ ì„ íƒ</option>
            <option value="2025">2025ë…„</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filterMonth">ì›”</label>
          <select id="filterMonth" class="filter-select">
            <option value="">ì›” ì„ íƒ</option>
            <option value="08">8ì›”</option>
            <option value="09">9ì›”</option>
            <option value="10">10ì›”</option>
            <option value="11">11ì›”</option>
            <option value="12">12ì›”</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filterType">íšŒì˜ êµ¬ë¶„</label>
          <select id="filterType" class="filter-select">
            <option value="">íšŒì˜ êµ¬ë¶„ ì„ íƒ</option>
            <option value="monthly">ì›”ê°„ê°„ë‹´íšŒ</option>
            <option value="week1">1ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week2">2ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week3">3ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week4">4ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week5">5ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
          </select>
        </div>

        <button class="btn-filter" onclick="searchMeeting()" id="searchBtn" disabled>í™•ì¸</button>
      </div>
    </div>

    <!-- ë°ì´í„° í…Œì´ë¸” -->
    <div class="table-container">
      <div class="table-header">
        <div class="table-title">íšŒì˜ìë£Œ ì‘ì„± í˜„í™©</div>
               <div class="table-actions">
         <button class="btn-table" onclick="exportCurrentData()">í˜„ì¬ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
         <button class="btn-table btn-danger" onclick="clearCurrentData()">í˜„ì¬ íšŒì˜ ë°ì´í„° ì‚­ì œ</button>
       </div>
      </div>
      
      <div id="tableContent">
        <div class="loading" id="loadingSpinner">
          <div class="spinner"></div>
          <p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
        
                 <div class="empty-state" id="emptyState">
           <i>ğŸ“Š</i>
           <h3>íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
           <p>ìœ„ì—ì„œ ì—°ë„, ì›”, íšŒì˜ êµ¬ë¶„ì„ ì„ íƒí•œ í›„ í™•ì¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
         </div>
        
                 <table class="data-table" id="dataTable" style="display: none;">
           <thead>
             <tr>
               <th>íšŒì˜ëª…</th>
               <th>ë¶€ì„œ</th>
               <th>ìƒíƒœ</th>
               <th>ë§ˆì§€ë§‰ ìˆ˜ì •</th>
               <th>ì•¡ì…˜</th>
             </tr>
           </thead>
           <tbody id="dataTableBody">
           </tbody>
         </table>
             </div>
     </div>

     <!-- íšŒì˜ìë£Œ ì·¨í•© ì„¹ì…˜ -->
     <div class="table-container" id="summaryContainer" style="display: none;">
       <div class="table-header">
         <div class="table-title">íšŒì˜ìë£Œ ì·¨í•©</div>
         <div class="table-actions">
           <button class="btn-table" onclick="exportSummaryData()">ì·¨í•© ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
           <button class="btn-table" onclick="printSummaryData()">ì¸ì‡„í•˜ê¸°</button>
         </div>
       </div>
       
       <div class="summary-content" id="summaryContent">
         <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ì·¨í•© ë‚´ìš© -->
       </div>
     </div>
   </div>

   <!-- ìƒì„¸ ë³´ê¸° ëª¨ë‹¬ -->
  <div id="detailModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">ìƒì„¸ ì •ë³´</h2>
        <span class="close" onclick="closeModal()">&times;</span>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë‚´ìš© -->
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-cancel" onclick="closeModal()">ë‹«ê¸°</button>
        <button class="btn-modal btn-primary" onclick="saveModalData()" id="saveModalBtn">ì €ì¥</button>
      </div>
    </div>
  </div>

  <!-- ë³´ì•ˆ ì„¤ì • ì„¹ì…˜ -->
  <div class="security-section" id="securitySection">
    <!-- ê³„ì • ê´€ë¦¬ -->
    <div class="security-card" style="margin-bottom: 30px;">
      <h3>
        <span class="icon">ğŸ‘¥</span>
        ë¶€ì„œë³„ ê³„ì • ê´€ë¦¬
      </h3>
      <p style="color: #666; margin-bottom: 25px; line-height: 1.6;">
        ë¶€ì„œë³„ë¡œ ê°œë³„ ê³„ì •ì„ ìƒì„±í•˜ê³  ê´€ë¦¬í•©ë‹ˆë‹¤. ìµœëŒ€ 20ê°œê¹Œì§€ ê³„ì •ì„ ë§Œë“¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
      
      <!-- ê³„ì • ìƒì„± í¼ -->
      <div class="account-creation-form" style="background: #f8f9fa; padding: 20px; border-radius: 8px; margin-bottom: 25px;">
        <h4 style="margin-bottom: 15px; color: var(--ok-text-dark);">ìƒˆ ê³„ì • ìƒì„±</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 15px;">
          <div class="security-field">
            <label for="newAccountId">ê³„ì • ID</label>
            <select id="newAccountId" style="padding: 12px; border: 2px solid var(--ok-border-light); border-radius: 6px; background: white;">
              <option value="">ê³„ì • ID ì„ íƒ</option>
              <option value="OK 1">OK 1</option>
              <option value="OK 2">OK 2</option>
              <option value="OK 3">OK 3</option>
              <option value="OK 4">OK 4</option>
              <option value="OK 5">OK 5</option>
              <option value="OK 6">OK 6</option>
              <option value="OK 7">OK 7</option>
              <option value="OK 8">OK 8</option>
              <option value="OK 9">OK 9</option>
              <option value="OK 10">OK 10</option>
              <option value="OK 11">OK 11</option>
              <option value="OK 12">OK 12</option>
              <option value="OK 13">OK 13</option>
              <option value="OK 14">OK 14</option>
              <option value="OK 15">OK 15</option>
              <option value="OK 16">OK 16</option>
              <option value="OK 17">OK 17</option>
              <option value="OK 18">OK 18</option>
              <option value="OK 19">OK 19</option>
              <option value="OK 20">OK 20</option>
            </select>
          </div>
          <div class="security-field">
            <label for="newAccountPw">ë¹„ë°€ë²ˆí˜¸</label>
            <input type="password" id="newAccountPw" placeholder="ë¹„ë°€ë²ˆí˜¸ ì…ë ¥" maxlength="30">
          </div>
        </div>
        <button class="btn-security" onclick="createAccount()" style="margin-top: 10px;">
          â• ê³„ì • ìƒì„±
        </button>
        <div id="accountCreationStatus" style="margin-top: 15px; padding: 12px; border-radius: 6px; display: none;">
          <!-- ìƒíƒœ ë©”ì‹œì§€ -->
        </div>
      </div>

      <!-- ê³„ì • ëª©ë¡ -->
      <div class="accounts-list">
        <h4 style="margin-bottom: 15px; color: var(--ok-text-dark); display: flex; justify-content: space-between; align-items: center;">
          <span>ë“±ë¡ëœ ê³„ì • ëª©ë¡ (OK 1 ~ OK 20)</span>
          <div style="display: flex; gap: 10px;">
            <span style="background: var(--ok-orange); color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.8rem;">
              ì´ <span id="totalAccountCount">0</span>ê°œ
            </span>
            <span style="background: #28a745; color: white; padding: 4px 12px; border-radius: 15px; font-size: 0.8rem;">
              í™œì„± <span id="activeAccountCount">0</span>ê°œ
            </span>
          </div>
        </h4>
        <div style="overflow-x: auto;">
          <table class="accounts-table" style="width: 100%; border-collapse: collapse;">
            <thead>
              <tr style="background: var(--ok-bg-gray);">
                <th style="padding: 12px; text-align: center; border-bottom: 2px solid var(--ok-border-light);">ë²ˆí˜¸</th>
                <th style="padding: 12px; text-align: left; border-bottom: 2px solid var(--ok-border-light);">ê³„ì • ID</th>
                <th style="padding: 12px; text-align: center; border-bottom: 2px solid var(--ok-border-light);">ìƒíƒœ</th>
                <th style="padding: 12px; text-align: center; border-bottom: 2px solid var(--ok-border-light);">ìƒì„±ì¼</th>
                <th style="padding: 12px; text-align: center; border-bottom: 2px solid var(--ok-border-light);">ë§ˆì§€ë§‰ ë¡œê·¸ì¸</th>
                <th style="padding: 12px; text-align: center; border-bottom: 2px solid var(--ok-border-light);">ê´€ë¦¬</th>
              </tr>
            </thead>
            <tbody id="accountListBody">
              <tr>
                <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
                  ë“±ë¡ëœ ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤.
                </td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- ë¶€ì„œë³„ ë¡œê·¸ì¸ í˜„í™© -->
    <div class="security-card" style="margin-bottom: 30px;">
      <h3>
        <span class="icon">ğŸŒ</span>
        ë¶€ì„œë³„ ì‹¤ì‹œê°„ ì ‘ì† í˜„í™©
      </h3>
      <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">
        ê° ë¶€ì„œë³„ ì‹¤ì‹œê°„ ì ‘ì† ìƒíƒœì™€ ìµœê·¼ ë¡œê·¸ì¸ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
      
      <!-- ì ‘ì† í˜„í™© í†µê³„ -->
      <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
        <div style="background: #d4edda; padding: 15px; border-radius: 8px; text-align: center;">
          <div style="font-size: 1.5rem; font-weight: 700; color: #155724;" id="onlineCount">0</div>
          <div style="font-size: 0.9rem; color: #155724;">í˜„ì¬ ì ‘ì†ì¤‘</div>
        </div>
        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; text-align: center;">
          <div style="font-size: 1.5rem; font-weight: 700; color: #856404;" id="totalAccounts">0</div>
          <div style="font-size: 0.9rem; color: #856404;">ì „ì²´ ê³„ì •ìˆ˜</div>
        </div>
        <div style="background: #cce5ff; padding: 15px; border-radius: 8px; text-align: center;">
          <div style="font-size: 1.5rem; font-weight: 700; color: #004085;" id="todayLogins">0</div>
          <div style="font-size: 0.9rem; color: #004085;">ì˜¤ëŠ˜ ë¡œê·¸ì¸</div>
        </div>
      </div>

      <!-- ë¶€ì„œë³„ ìƒíƒœ -->
      <div id="departmentStatus" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 15px;">
        <!-- ë™ì ìœ¼ë¡œ ìƒì„± -->
      </div>
    </div>

    <!-- ë¡œê·¸ì¸ ê¸°ë¡ -->
    <div class="login-records">
      <h3>
        <span class="icon">ğŸ“‹</span>
        ë¶€ì„œë³„ ë¡œê·¸ì¸ ê¸°ë¡
      </h3>
      <p style="color: #666; margin-bottom: 20px; line-height: 1.6;">
        ë¶€ì„œë³„ ìƒì„¸ ë¡œê·¸ì¸ ê¸°ë¡ì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      </p>
      
      <!-- í•„í„° ì˜µì…˜ -->
      <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; flex-wrap: wrap; gap: 15px;">
        <div style="display: flex; gap: 15px; align-items: center; flex-wrap: wrap;">
          <div>
            <label for="deptFilter" style="margin-right: 8px; font-weight: 600;">ë¶€ì„œ:</label>
            <select id="deptFilter" style="padding: 8px 12px; border: 1px solid var(--ok-border-light); border-radius: 6px;">
              <option value="">ì „ì²´</option>
            </select>
          </div>
          <div>
            <label for="statusFilter" style="margin-right: 8px; font-weight: 600;">ìƒíƒœ:</label>
            <select id="statusFilter" style="padding: 8px 12px; border: 1px solid var(--ok-border-light); border-radius: 6px;">
              <option value="">ì „ì²´</option>
              <option value="success">ì„±ê³µ</option>
              <option value="failed">ì‹¤íŒ¨</option>
            </select>
          </div>
          <button class="btn-security" onclick="applyFilters()" style="padding: 8px 16px; font-size: 0.9rem;">
            ğŸ” í•„í„° ì ìš©
          </button>
        </div>
        <div>
          <strong>ì´ ë¡œê·¸ì¸ ê¸°ë¡:</strong> 
          <span id="totalLoginCount" style="color: var(--ok-orange); font-weight: 600;">0</span>ê±´
          <button class="btn-security" onclick="clearLoginRecords()" style="padding: 8px 16px; font-size: 0.9rem; margin-left: 15px;">
            ğŸ—‘ï¸ ê¸°ë¡ ì‚­ì œ
          </button>
        </div>
      </div>
      
      <div style="overflow-x: auto;">
        <table class="login-records-table">
          <thead>
            <tr>
              <th>ë²ˆí˜¸</th>
              <th>ë¶€ì„œ</th>
              <th>ë¡œê·¸ì¸ ì‹œê°„</th>
              <th>IP ì£¼ì†Œ</th>
              <th>ê³„ì • ID</th>
              <th>ìƒíƒœ</th>
              <th>ë¸Œë¼ìš°ì €</th>
            </tr>
          </thead>
          <tbody id="loginRecordsBody">
            <tr>
              <td colspan="7" style="text-align: center; color: #999; padding: 40px;">
                ì•„ì§ ë¡œê·¸ì¸ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <script>
    // 16ê°œ ë¶€ì„œ ëª©ë¡
    const departments = [
      'ì˜ì—…ì¶”ì§„ë¶€', 'ë¦¬í…Œì¼ê¸°íšë¶€', 'ëª¨ê¸°ì§€ì‚¬ì—…ë¶€', 'ì‹¬ì‚¬ë¶€', 
      'ë¦¬ìŠ¤í¬ê´€ë¦¬ë¶€', 'ê²½ì˜ê´€ë¦¬ë³¸ë¶€(ê²½ì˜ê¸°íšë¶€)', 'ê²½ì˜ê´€ë¦¬ë³¸ë¶€(ITê¸°íšë¶€)', 'ë¯¸ë˜ë””ì§€í„¸ë¶€',
      'ì†Œë¹„ìê¸ˆìœµì˜ì—…ë¶€', 'ì†Œë¹„ìê¸ˆìœµê¸°íšë¶€', 'ì‹ ìš©ê´€ë¦¬ë¶€', 'ë§ˆì¼€íŒ…íŒ€',
      'ê°ì‚¬ë¶€', 'ì¤€ë²•ì§€ì›ë¶€', 'ê¸ˆìœµì†Œë¹„ìë³´í˜¸ë¶€', 'ì •ë³´ë³´ì•ˆíŒ€'
    ];

         // ì „ì—­ ë³€ìˆ˜
     let meetingData = {};
     let currentMeetingData = [];
     let currentEditData = null;
     let selectedMeeting = null;

     // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
     document.addEventListener('DOMContentLoaded', function() {
       loadData();
       updateDashboard();
       setupEventListeners();
       showInitialState();
     });

         // ë°ì´í„° ë¡œë“œ
     function loadData() {
       meetingData = JSON.parse(localStorage.getItem('meetingData')) || {};
     }

     // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
     function setupEventListeners() {
       document.getElementById('filterYear').addEventListener('change', checkSearchValid);
       document.getElementById('filterMonth').addEventListener('change', checkSearchValid);
       document.getElementById('filterType').addEventListener('change', checkSearchValid);
     }

     // ê²€ìƒ‰ ë²„íŠ¼ í™œì„±í™” ì²´í¬
     function checkSearchValid() {
       const year = document.getElementById('filterYear').value;
       const month = document.getElementById('filterMonth').value;
       const type = document.getElementById('filterType').value;
       
       const searchBtn = document.getElementById('searchBtn');
       if (year && month && type) {
         searchBtn.disabled = false;
       } else {
         searchBtn.disabled = true;
       }
     }

     // ì´ˆê¸° ìƒíƒœ í‘œì‹œ
     function showInitialState() {
       const loadingSpinner = document.getElementById('loadingSpinner');
       const emptyState = document.getElementById('emptyState');
       const dataTable = document.getElementById('dataTable');
       
       loadingSpinner.style.display = 'none';
       emptyState.style.display = 'block';
       dataTable.style.display = 'none';
     }

         // íšŒì˜ ê²€ìƒ‰
     function searchMeeting() {
       const year = document.getElementById('filterYear').value;
       const month = document.getElementById('filterMonth').value;
       const type = document.getElementById('filterType').value;
       
       if (!year || !month || !type) {
         alert('ëª¨ë“  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       const meetingId = `${year}-${month}-${type}`;
       const meetingName = getMeetingName(month, type);
       
       selectedMeeting = {
         id: meetingId,
         name: meetingName,
         year,
         month,
         type
       };
       
       // í•´ë‹¹ íšŒì˜ì˜ ë¶€ì„œë³„ ë°ì´í„° ì¤€ë¹„
       currentMeetingData = [];
       departments.forEach(dept => {
         const deptData = meetingData[meetingId] ? meetingData[meetingId][dept] : null;
         const status = getDepartmentStatus(deptData);
         const progress = getDepartmentProgress(deptData, type);
         const lastModified = getLastModified(deptData);
         
         currentMeetingData.push({
           meetingId,
           meetingName,
           department: dept,
           status,
           progress,
           lastModified,
           data: deptData
         });
       });
               
        updateDashboard();
        renderTable();
        
        // íšŒì˜ìë£Œ ì·¨í•© ë²„íŠ¼ í‘œì‹œ
        showSummaryButton();
      }

      // íšŒì˜ìë£Œ ì·¨í•© ë²„íŠ¼ í‘œì‹œ
      function showSummaryButton() {
        if (selectedMeeting) {
          const tableContainer = document.querySelector('.table-container .table-header .table-actions');
          if (!document.getElementById('summaryBtn')) {
            const summaryBtn = document.createElement('button');
            summaryBtn.id = 'summaryBtn';
            summaryBtn.className = 'btn-table';
            summaryBtn.textContent = 'íšŒì˜ìë£Œ ì·¨í•©ë³´ê¸°';
            summaryBtn.onclick = showSummaryPage;
            tableContainer.insertBefore(summaryBtn, tableContainer.firstChild);
          }
        }
      }

      // íšŒì˜ëª… ìƒì„±
    function getMeetingName(month, type) {
      const monthName = parseInt(month) + 'ì›”';
      if (type === 'monthly') {
        return `2025ë…„ ${monthName} ì›”ê°„ê°„ë‹´íšŒ`;
      } else {
        const weekNum = type.replace('week', '');
        return `2025ë…„ ${monthName} ${weekNum}ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ`;
      }
    }

    // ë¶€ì„œ ìƒíƒœ í™•ì¸
    function getDepartmentStatus(deptData) {
      if (!deptData) return 'not-started';
      if (deptData.completed) return 'completed';
      
      const hasContent = Object.keys(deptData).some(key => 
        key !== 'completed' && deptData[key] && deptData[key].toString().trim() !== ''
      );
      
      return hasContent ? 'pending' : 'not-started';
    }

         // ì§„í–‰ë¥  ê³„ì‚° (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
     function getDepartmentProgress(deptData, meetingType) {
       return 0; // ì§„í–‰ë¥  ê¸°ëŠ¥ ì œê±°
     }

         // ë§ˆì§€ë§‰ ìˆ˜ì •ì¼ í™•ì¸
     function getLastModified(deptData) {
       if (!deptData || !deptData.lastModified) return '-';
       const date = new Date(deptData.lastModified);
       return date.toLocaleDateString('ko-KR') + ' ' + date.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'});
     }

         // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
     function updateDashboard() {
       const stats = calculateStats();
       
       document.getElementById('totalMeetings').textContent = stats.totalDepartments;
       document.getElementById('completedTasks').textContent = stats.completed;
       document.getElementById('pendingTasks').textContent = stats.pending;
       document.getElementById('notStartedTasks').textContent = stats.notStarted;
       
       // ëŒ€ì‹œë³´ë“œ ì¹´ë“œ ì œëª© ì—…ë°ì´íŠ¸
       const firstCard = document.querySelector('.dashboard-card .card-title');
       if (selectedMeeting) {
         firstCard.textContent = 'ì „ì²´ ë¶€ì„œ';
         document.querySelector('.card-description').textContent = selectedMeeting.name;
       } else {
         firstCard.textContent = 'ì „ì²´ ë¶€ì„œ';
         document.querySelector('.card-description').textContent = 'íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
       }
     }

         // í†µê³„ ê³„ì‚°
     function calculateStats() {
       if (!selectedMeeting) {
         return { totalDepartments: 16, completed: 0, pending: 0, notStarted: 0 };
       }
       
       const totalDepartments = departments.length;
       let completed = 0;
       let pending = 0;
       let notStarted = 0;
       
       currentMeetingData.forEach(item => {
         switch(item.status) {
           case 'completed': completed++; break;
           case 'pending': pending++; break;
           case 'not-started': notStarted++; break;
         }
       });
       
       return { totalDepartments, completed, pending, notStarted };
     }

         // í…Œì´ë¸” ë Œë”ë§
     function renderTable() {
       const tableBody = document.getElementById('dataTableBody');
       const loadingSpinner = document.getElementById('loadingSpinner');
       const emptyState = document.getElementById('emptyState');
       const dataTable = document.getElementById('dataTable');
       
       if (!selectedMeeting) {
         loadingSpinner.style.display = 'none';
         emptyState.style.display = 'block';
         dataTable.style.display = 'none';
         return;
       }
       
       // ë¡œë”© í‘œì‹œ
       loadingSpinner.style.display = 'block';
       emptyState.style.display = 'none';
       dataTable.style.display = 'none';
       
       setTimeout(() => {
         if (currentMeetingData.length === 0) {
           loadingSpinner.style.display = 'none';
           emptyState.style.display = 'block';
           emptyState.innerHTML = '<i>ğŸ“Š</i><h3>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</h3><p>ì„ íƒí•œ íšŒì˜ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
           return;
         }
         
         tableBody.innerHTML = '';
         currentMeetingData.forEach(item => {
           const row = createTableRow(item);
           tableBody.appendChild(row);
         });
         
         loadingSpinner.style.display = 'none';
         dataTable.style.display = 'table';
       }, 500);
     }

    // í…Œì´ë¸” í–‰ ìƒì„±
    function createTableRow(item) {
      const row = document.createElement('tr');
      
      const statusText = {
        'completed': 'ì‘ì„±ì™„ë£Œ',
        'pending': 'ì‘ì„±ì¤‘',
        'not-started': 'ë¯¸ì‘ì„±'
      };
      
      const statusClass = {
        'completed': 'status-completed',
        'pending': 'status-pending',
        'not-started': 'status-not-started'
      };
      
             row.innerHTML = `
         <td>${item.meetingName}</td>
         <td>${item.department}</td>
         <td><span class="status-badge ${statusClass[item.status]}">${statusText[item.status]}</span></td>
         <td>${item.lastModified}</td>
         <td>
           <div class="action-buttons">
             <button class="btn-action btn-view" onclick="viewDetail('${item.meetingId}', '${item.department}')">ë³´ê¸°</button>
             <button class="btn-action btn-edit" onclick="editDetail('${item.meetingId}', '${item.department}')">ìˆ˜ì •</button>
             <button class="btn-action btn-delete" onclick="deleteDetail('${item.meetingId}', '${item.department}')">ì‚­ì œ</button>
           </div>
         </td>
       `;
      
      return row;
    }

    // í•„í„° ì ìš©
    function applyFilters() {
      const year = document.getElementById('filterYear').value;
      const month = document.getElementById('filterMonth').value;
      const type = document.getElementById('filterType').value;
      const status = document.getElementById('filterStatus').value;
      
      filteredData = prepareTableData().filter(item => {
        if (year && !item.meetingId.startsWith(year)) return false;
        if (month && !item.meetingId.includes(`-${month}-`)) return false;
        if (type && !item.meetingId.endsWith(`-${type}`)) return false;
        if (status && item.status !== status) return false;
        return true;
      });
      
      updateDashboard();
      renderTable();
    }

    // ìƒì„¸ ë³´ê¸°
    function viewDetail(meetingId, department) {
      const data = meetingData[meetingId] ? meetingData[meetingId][department] : null;
      const meetingName = getMeetingName(meetingId.split('-')[1], meetingId.split('-')[2]);
      
      showModal(`${meetingName} - ${department}`, data, false);
    }

    // ìˆ˜ì •
    function editDetail(meetingId, department) {
      const data = meetingData[meetingId] ? meetingData[meetingId][department] : null;
      const meetingName = getMeetingName(meetingId.split('-')[1], meetingId.split('-')[2]);
      
      currentEditData = { meetingId, department };
      showModal(`${meetingName} - ${department} ìˆ˜ì •`, data, true);
    }

    // ì‚­ì œ
    function deleteDetail(meetingId, department) {
      if (!confirm(`${department}ì˜ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
      
      if (meetingData[meetingId] && meetingData[meetingId][department]) {
        delete meetingData[meetingId][department];
        if (Object.keys(meetingData[meetingId]).length === 0) {
          delete meetingData[meetingId];
        }
        localStorage.setItem('meetingData', JSON.stringify(meetingData));
      }
      
      loadData();
      updateDashboard();
      renderTable();
      
      alert('ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ëª¨ë‹¬ í‘œì‹œ
    function showModal(title, data, isEdit) {
      const modal = document.getElementById('detailModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalBody = document.getElementById('modalBody');
      const saveBtn = document.getElementById('saveModalBtn');
      
      modalTitle.textContent = title;
      saveBtn.style.display = isEdit ? 'block' : 'none';
      
      // ëª¨ë‹¬ ë‚´ìš© ìƒì„±
      let content = '';
      if (data) {
        const meetingType = currentEditData ? currentEditData.meetingId.split('-')[2] : 'monthly';
        
                 const previousLabel = meetingType === 'monthly' ? 'ì „ì›” ì¶”ì§„ ì‹¤ì ' : 'ì „ì£¼ ì¶”ì§„ ì‹¤ì ';
         const currentLabel = meetingType === 'monthly' ? 'ê¸ˆì›” ì¶”ì§„ ê³„íš' : 'ê¸ˆì£¼ ì¶”ì§„ ê³„íš';
         
         content = `
           <div class="modal-key-points-section">
             <label>ì£¼ìš”ì‚¬í•­</label>
             <textarea ${isEdit ? '' : 'readonly'}>${data.keyPoints || ''}</textarea>
           </div>
           <div class="modal-content-fields-container">
             <div class="modal-field">
               <label>${previousLabel}</label>
               <textarea ${isEdit ? '' : 'readonly'}>${data.previousResults || ''}</textarea>
             </div>
             <div class="modal-field">
               <label>${currentLabel}</label>
               <textarea ${isEdit ? '' : 'readonly'}>${data.currentPlan || ''}</textarea>
             </div>
           </div>
         `;
        
        if (data.completed) {
          content += `<div class="modal-field"><strong>ìƒíƒœ: ì‘ì„±ì™„ë£Œ</strong></div>`;
        }
      } else {
        content = '<p>ì‘ì„±ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
      
      modalBody.innerHTML = content;
      modal.style.display = 'block';
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal() {
      document.getElementById('detailModal').style.display = 'none';
      currentEditData = null;
    }

    // ëª¨ë‹¬ ë°ì´í„° ì €ì¥
    function saveModalData() {
      if (!currentEditData) return;
      
      const { meetingId, department } = currentEditData;
      const modalInputs = document.querySelectorAll('#modalBody textarea, #modalBody input');
      
      if (!meetingData[meetingId]) meetingData[meetingId] = {};
      if (!meetingData[meetingId][department]) meetingData[meetingId][department] = {};
      
             const fields = ['keyPoints', 'previousResults', 'currentPlan'];
       modalInputs.forEach((input, index) => {
         if (fields[index]) {
           meetingData[meetingId][department][fields[index]] = input.value;
         }
       });
      
      meetingData[meetingId][department].lastModified = new Date().toISOString();
      localStorage.setItem('meetingData', JSON.stringify(meetingData));
      
      closeModal();
      loadData();
      updateDashboard();
      renderTable();
      
      alert('ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
    function refreshData() {
      loadData();
      updateDashboard();
      renderTable();
      alert('ë°ì´í„°ê°€ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
    function exportData() {
      const dataStr = JSON.stringify(meetingData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `íšŒì˜ìë£Œ_ì „ì²´ë°ì´í„°_${new Date().toISOString().split('T')[0]}.json`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // í•„í„°ëœ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
    function exportFilteredData() {
      if (filteredData.length === 0) {
        alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      const csvContent = generateCSV(filteredData);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `íšŒì˜ìë£Œ_í•„í„°ë°ì´í„°_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

           // CSV ìƒì„±
       function generateCSV(data) {
         const headers = ['íšŒì˜ëª…', 'ë¶€ì„œ', 'ìƒíƒœ', 'ë§ˆì§€ë§‰ìˆ˜ì •'];
         const rows = data.map(item => [
           item.meetingName,
           item.department,
           item.status === 'completed' ? 'ì‘ì„±ì™„ë£Œ' : item.status === 'pending' ? 'ì‘ì„±ì¤‘' : 'ë¯¸ì‘ì„±',
           item.lastModified
         ]);
         
         const csvContent = [headers, ...rows]
           .map(row => row.map(field => `"${field}"`).join(','))
           .join('\n');
           
         return '\uFEFF' + csvContent; // BOM ì¶”ê°€ (í•œê¸€ ê¹¨ì§ ë°©ì§€)
       }

    // ì „ì²´ ë°ì´í„° ì‚­ì œ
    function clearAllData() {
      if (!confirm('ì „ì²´ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
      
      if (confirm('ì •ë§ë¡œ ëª¨ë“  íšŒì˜ìë£Œ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        localStorage.removeItem('meetingData');
        meetingData = {};
        loadData();
        updateDashboard();
        renderTable();
               alert('ì „ì²´ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
       }
     }

     // íšŒì˜ìë£Œ ì·¨í•© í˜ì´ì§€ í‘œì‹œ
     function showSummaryPage() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       const tableContainer = document.querySelector('.table-container');
       const summaryContainer = document.getElementById('summaryContainer');
       
       tableContainer.style.display = 'none';
       summaryContainer.style.display = 'block';
       
       generateSummaryContent();
     }

     // ì·¨í•© ë‚´ìš© ìƒì„±
     function generateSummaryContent() {
       const summaryContent = document.getElementById('summaryContent');
       const meetingType = selectedMeeting.type === 'monthly' ? 'ì›”ê°„' : 'ì£¼ê°„';
       const typeText = selectedMeeting.type === 'monthly' ? '' : ` ${selectedMeeting.type.replace('week', '')}ì£¼ì°¨`;
       
       let html = `
         <div class="summary-header">
           <h2>${selectedMeeting.name}</h2>
           <p>OKì €ì¶•ì€í–‰ ${meetingType}ê°„ë‹´íšŒ${typeText} - ì „ ë¶€ì„œ íšŒì˜ìë£Œ ì·¨í•©</p>
           <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
             ì‘ì„±ì¼: ${new Date().toLocaleDateString('ko-KR')} ${new Date().toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'})}
           </p>
           <div class="summary-actions" style="margin-top: 25px;">
             <button class="btn-summary" onclick="backToTable()">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
             <button class="btn-summary" onclick="exportSummaryData()">PDFë¡œ ë‚´ë³´ë‚´ê¸°</button>
             <button class="btn-summary" onclick="printSummaryData()">ì¸ì‡„í•˜ê¸°</button>
           </div>
         </div>
       `;
       
       departments.forEach(dept => {
         const deptData = meetingData[selectedMeeting.id] ? meetingData[selectedMeeting.id][dept] : null;
         const status = getDepartmentStatus(deptData);
         const lastModified = getLastModified(deptData);
         
         const statusText = {
           'completed': 'ì‘ì„±ì™„ë£Œ',
           'pending': 'ì‘ì„±ì¤‘',
           'not-started': 'ë¯¸ì‘ì„±'
         };
         
         const statusClass = {
           'completed': 'status-completed',
           'pending': 'status-pending',
           'not-started': 'status-not-started'
         };
         
         const previousLabel = selectedMeeting.type === 'monthly' ? 'ì „ì›” ì¶”ì§„ ì‹¤ì ' : 'ì „ì£¼ ì¶”ì§„ ì‹¤ì ';
         const currentLabel = selectedMeeting.type === 'monthly' ? 'ê¸ˆì›” ì¶”ì§„ ê³„íš' : 'ê¸ˆì£¼ ì¶”ì§„ ê³„íš';
         
         html += `
           <div class="department-summary">
             <div class="department-summary-header">
               <span>${dept}</span>
               <span class="department-status ${statusClass[status]}">${statusText[status]}</span>
             </div>
             <div class="department-summary-content">
               <div class="summary-key-points-section">
                 <div class="summary-field-title">ì£¼ìš”ì‚¬í•­</div>
                 <div class="summary-field-content ${!deptData?.keyPoints ? 'empty' : ''}">
                   ${deptData?.keyPoints || 'ì‘ì„±ë˜ì§€ ì•ŠìŒ'}
                 </div>
               </div>
               <div class="summary-content-fields-container">
                 <div class="summary-field">
                   <div class="summary-field-title">${previousLabel}</div>
                   <div class="summary-field-content ${!deptData?.previousResults ? 'empty' : ''}">
                     ${deptData?.previousResults || 'ì‘ì„±ë˜ì§€ ì•ŠìŒ'}
                   </div>
                 </div>
                 <div class="summary-field">
                   <div class="summary-field-title">${currentLabel}</div>
                   <div class="summary-field-content ${!deptData?.currentPlan ? 'empty' : ''}">
                     ${deptData?.currentPlan || 'ì‘ì„±ë˜ì§€ ì•ŠìŒ'}
                   </div>
                 </div>
               </div>
               ${lastModified !== '-' ? `<div style="text-align: right; color: #666; font-size: 0.9rem; margin-top: 15px;">ìµœì¢… ìˆ˜ì •: ${lastModified}</div>` : ''}
             </div>
           </div>
         `;
       });
       

       
       summaryContent.innerHTML = html;
     }

     // ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
     function backToTable() {
       const tableContainer = document.querySelector('.table-container');
       const summaryContainer = document.getElementById('summaryContainer');
       
       summaryContainer.style.display = 'none';
       tableContainer.style.display = 'block';
     }

     // ì·¨í•© ë°ì´í„° ë‚´ë³´ë‚´ê¸°
     function exportSummaryData() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       // HTML ë‚´ìš©ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ ë‚´ë³´ë‚´ê¸°
       const summaryHTML = document.getElementById('summaryContent').innerHTML;
       const exportData = {
         meeting: selectedMeeting,
         generatedAt: new Date().toISOString(),
         departments: {}
       };
       
       departments.forEach(dept => {
         const deptData = meetingData[selectedMeeting.id] ? meetingData[selectedMeeting.id][dept] : null;
         exportData.departments[dept] = deptData;
       });
       
       const dataStr = JSON.stringify(exportData, null, 2);
       const dataBlob = new Blob([dataStr], {type: 'application/json'});
       const url = URL.createObjectURL(dataBlob);
       const link = document.createElement('a');
       link.href = url;
       link.download = `${selectedMeeting.name}_ì·¨í•©ìë£Œ_${new Date().toISOString().split('T')[0]}.json`;
       link.click();
       URL.revokeObjectURL(url);
     }

     // ì¸ì‡„í•˜ê¸°
     function printSummaryData() {
       window.print();
     }

     // í˜„ì¬ íšŒì˜ ë°ì´í„° ì‚­ì œ
     function clearCurrentData() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       if (!confirm(`${selectedMeeting.name}ì˜ ëª¨ë“  ë¶€ì„œ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
       
       if (meetingData[selectedMeeting.id]) {
         delete meetingData[selectedMeeting.id];
         localStorage.setItem('meetingData', JSON.stringify(meetingData));
       }
       
       loadData();
       updateDashboard();
       renderTable();
       
       alert('í˜„ì¬ íšŒì˜ì˜ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
     }

     // í˜„ì¬ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
     function exportCurrentData() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       if (currentMeetingData.length === 0) {
         alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
         return;
       }
       
       const csvContent = generateCSV(currentMeetingData);
       const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
       const url = URL.createObjectURL(blob);
       const link = document.createElement('a');
       link.href = url;
       link.download = `${selectedMeeting.name}_í˜„í™©ë°ì´í„°_${new Date().toISOString().split('T')[0]}.csv`;
       link.click();
       URL.revokeObjectURL(url);
     }

     // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    window.onclick = function(event) {
      const modal = document.getElementById('detailModal');
      if (event.target === modal) {
        closeModal();
      }
    };
    // ========== ë³´ì•ˆ ì„¤ì • ê´€ë ¨ í•¨ìˆ˜ë“¤ ==========

    // íƒ­ ì „í™˜ í•¨ìˆ˜
    function switchTab(tabName) {
      // íƒ­ ë²„íŠ¼ ìŠ¤íƒ€ì¼ ë³€ê²½
      document.querySelectorAll('.tab-button').forEach(btn => btn.classList.remove('active'));
      document.getElementById(tabName + 'Tab').classList.add('active');
      
      // ì„¹ì…˜ í‘œì‹œ/ìˆ¨ê¹€
      if (tabName === 'meeting') {
        document.getElementById('meetingSection').style.display = 'block';
        document.getElementById('securitySection').classList.remove('active');
      } else if (tabName === 'security') {
        document.getElementById('meetingSection').style.display = 'none';
        document.getElementById('securitySection').classList.add('active');
        loadSecuritySettings();
      }
    }

    // ë³´ì•ˆ ì„¤ì • ë¡œë“œ
    function loadSecuritySettings() {
      const savedCredentials = localStorage.getItem('adminLoginCredentials');
      if (savedCredentials) {
        const credentials = JSON.parse(savedCredentials);
        document.getElementById('currentUserId').textContent = credentials.userId || 'ì„¤ì •ë˜ì§€ ì•ŠìŒ';
        document.getElementById('lastUpdated').textContent = 
          `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${new Date(credentials.lastUpdated).toLocaleString('ko-KR')}`;
      }
      
      loadLoginRecords();
    }

    // ID/PW ì„¤ì • ì €ì¥
    function saveLoginCredentials() {
      const userId = document.getElementById('adminUserId').value.trim();
      const password = document.getElementById('adminUserPassword').value.trim();
      const passwordConfirm = document.getElementById('adminUserPasswordConfirm').value.trim();
      const statusDiv = document.getElementById('credentialsStatus');
      
      // ìœ íš¨ì„± ê²€ì‚¬
      if (!userId || !password || !passwordConfirm) {
        showStatus(statusDiv, 'ëª¨ë“  í•„ë“œë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
        return;
      }
      
      if (userId.length < 3) {
        showStatus(statusDiv, 'IDëŠ” 3ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error');
        return;
      }
      
      if (password.length < 4) {
        showStatus(statusDiv, 'ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error');
        return;
      }
      
      if (password !== passwordConfirm) {
        showStatus(statusDiv, 'ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'error');
        return;
      }
      
      // ì €ì¥
      const credentials = {
        userId: userId,
        password: password,
        lastUpdated: new Date().toISOString()
      };
      
      localStorage.setItem('adminLoginCredentials', JSON.stringify(credentials));
      
      // UI ì—…ë°ì´íŠ¸
      document.getElementById('currentUserId').textContent = userId;
      document.getElementById('lastUpdated').textContent = 
        `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${new Date().toLocaleString('ko-KR')}`;
      
      // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
      document.getElementById('adminUserId').value = '';
      document.getElementById('adminUserPassword').value = '';
      document.getElementById('adminUserPasswordConfirm').value = '';
      
      showStatus(statusDiv, 'ë¡œê·¸ì¸ ì •ë³´ê°€ ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!', 'success');
    }

    // ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
    function showStatus(element, message, type) {
      element.style.display = 'block';
      element.textContent = message;
      
      if (type === 'success') {
        element.style.background = '#d4edda';
        element.style.color = '#155724';
        element.style.border = '1px solid #c3e6cb';
      } else if (type === 'error') {
        element.style.background = '#f8d7da';
        element.style.color = '#721c24';
        element.style.border = '1px solid #f5c6cb';
      }
      
      // 3ì´ˆ í›„ ìë™ ìˆ¨ê¹€
      setTimeout(() => {
        element.style.display = 'none';
      }, 3000);
    }

    // ë¡œê·¸ì¸ ê¸°ë¡ ë¡œë“œ
    function loadLoginRecords() {
      const records = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      const tbody = document.getElementById('loginRecordsBody');
      const totalCount = document.getElementById('totalLoginCount');
      
      totalCount.textContent = records.length;
      
      if (records.length === 0) {
        tbody.innerHTML = `
          <tr>
            <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
              ì•„ì§ ë¡œê·¸ì¸ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤.
            </td>
          </tr>
        `;
        return;
      }
      
      tbody.innerHTML = records.map((record, index) => `
        <tr>
          <td>${records.length - index}</td>
          <td>${new Date(record.timestamp).toLocaleString('ko-KR')}</td>
          <td><span class="ip-address">${record.ip}</span></td>
          <td>${record.userId}</td>
          <td><span class="status-${record.success ? 'success' : 'failed'}">${record.success ? 'ì„±ê³µ' : 'ì‹¤íŒ¨'}</span></td>
          <td>${record.browser}</td>
        </tr>
      `).join('');
    }

    // ë¡œê·¸ì¸ ê¸°ë¡ ì‚­ì œ
    function clearLoginRecords() {
      if (confirm('ëª¨ë“  ë¡œê·¸ì¸ ê¸°ë¡ì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        localStorage.removeItem('loginRecords');
        loadLoginRecords();
        alert('ë¡œê·¸ì¸ ê¸°ë¡ì´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
      }
    }

    // ë¡œê·¸ì¸ ê¸°ë¡ ì¶”ê°€ (index.htmlì—ì„œ í˜¸ì¶œë¨)
    function addLoginRecord(userId, success, ip = 'Unknown') {
      const records = JSON.parse(localStorage.getItem('loginRecords') || '[]');
      const newRecord = {
        timestamp: new Date().toISOString(),
        userId: userId,
        success: success,
        ip: ip,
        browser: navigator.userAgent.split(') ')[0] + ')' || 'Unknown'
      };
      
      records.push(newRecord);
      
      // ìµœëŒ€ 100ê°œê¹Œì§€ë§Œ ë³´ê´€
      if (records.length > 100) {
        records.splice(0, records.length - 100);
      }
      
      localStorage.setItem('loginRecords', JSON.stringify(records));
    }

    // ì‚¬ìš©ì IP ì£¼ì†Œ ê°€ì ¸ì˜¤ê¸° (ì™¸ë¶€ API ì‚¬ìš©)
    async function getUserIP() {
      try {
        const response = await fetch('https://api.ipify.org?format=json');
        const data = await response.json();
        return data.ip;
      } catch (error) {
        console.log('IP ì£¼ì†Œë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤:', error);
        return 'Unknown';
      }
    }

    // ê³„ì • ìƒì„± í•¨ìˆ˜
    function createAccount() {
      const accountId = document.getElementById('newAccountId').value;
      const password = document.getElementById('newAccountPw').value;
      const statusDiv = document.getElementById('accountCreationStatus');
      
      // ìœ íš¨ì„± ê²€ì‚¬
      if (!accountId) {
        showAccountStatus(statusDiv, 'ê³„ì • IDë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.', 'error');
        return;
      }
      
      if (!password) {
        showAccountStatus(statusDiv, 'ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”.', 'error');
        return;
      }
      
      if (password.length < 4) {
        showAccountStatus(statusDiv, 'ë¹„ë°€ë²ˆí˜¸ëŠ” 4ì ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤.', 'error');
        return;
      }
      
      // ê¸°ì¡´ ê³„ì • ì¤‘ë³µ í™•ì¸
      const accounts = JSON.parse(localStorage.getItem('userAccounts') || '[]');
      const existingAccount = accounts.find(acc => acc.id === accountId);
      
      if (existingAccount) {
        showAccountStatus(statusDiv, 'ì´ë¯¸ ì¡´ì¬í•˜ëŠ” ê³„ì • IDì…ë‹ˆë‹¤.', 'error');
        return;
      }
      
      // ìƒˆ ê³„ì • ìƒì„±
      const newAccount = {
        id: accountId,
        password: password,
        status: 'active',
        createdAt: new Date().toISOString(),
        lastLogin: null
      };
      
      accounts.push(newAccount);
      localStorage.setItem('userAccounts', JSON.stringify(accounts));
      
      // ì…ë ¥ í•„ë“œ ì´ˆê¸°í™”
      document.getElementById('newAccountId').value = '';
      document.getElementById('newAccountPw').value = '';
      
      showAccountStatus(statusDiv, `ê³„ì • "${accountId}"ê°€ ì„±ê³µì ìœ¼ë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!`, 'success');
      
      // ê³„ì • ëª©ë¡ ìƒˆë¡œê³ ì¹¨
      loadAccountList();
    }

    // ê³„ì • ëª©ë¡ ë¡œë“œ
    function loadAccountList() {
      const accounts = JSON.parse(localStorage.getItem('userAccounts') || '[]');
      const tbody = document.getElementById('accountListBody');
      const totalCount = document.getElementById('totalAccountCount');
      const activeCount = document.getElementById('activeAccountCount');
      
      if (tbody) {
        totalCount.textContent = accounts.length;
        activeCount.textContent = accounts.filter(acc => acc.status === 'active').length;
        
        if (accounts.length === 0) {
          tbody.innerHTML = `
            <tr>
              <td colspan="6" style="text-align: center; color: #999; padding: 40px;">
                ë“±ë¡ëœ ê³„ì •ì´ ì—†ìŠµë‹ˆë‹¤.
              </td>
            </tr>
          `;
          return;
        }
        
        tbody.innerHTML = accounts.map((account, index) => `
          <tr>
            <td>${index + 1}</td>
            <td><strong>${account.id}</strong></td>
            <td><span class="status-${account.status}">${account.status === 'active' ? 'í™œì„±' : 'ë¹„í™œì„±'}</span></td>
            <td>${new Date(account.createdAt).toLocaleDateString('ko-KR')}</td>
            <td>${account.lastLogin ? new Date(account.lastLogin).toLocaleString('ko-KR') : 'ì—†ìŒ'}</td>
            <td>
              <button class="btn-small ${account.status === 'active' ? 'btn-warning' : 'btn-success'}" 
                      onclick="toggleAccountStatus('${account.id}')">
                ${account.status === 'active' ? 'ë¹„í™œì„±í™”' : 'í™œì„±í™”'}
              </button>
              <button class="btn-small btn-danger" onclick="deleteAccount('${account.id}')">ì‚­ì œ</button>
            </td>
          </tr>
        `).join('');
      }
    }

    // ê³„ì • ìƒíƒœ í† ê¸€
    function toggleAccountStatus(accountId) {
      const accounts = JSON.parse(localStorage.getItem('userAccounts') || '[]');
      const account = accounts.find(acc => acc.id === accountId);
      
      if (account) {
        account.status = account.status === 'active' ? 'inactive' : 'active';
        localStorage.setItem('userAccounts', JSON.stringify(accounts));
        loadAccountList();
        
        alert(`ê³„ì • "${accountId}"ì´ ${account.status === 'active' ? 'í™œì„±í™”' : 'ë¹„í™œì„±í™”'}ë˜ì—ˆìŠµë‹ˆë‹¤.`);
      }
    }

    // ê³„ì • ì‚­ì œ
    function deleteAccount(accountId) {
      if (!confirm(`ê³„ì • "${accountId}"ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
      
      const accounts = JSON.parse(localStorage.getItem('userAccounts') || '[]');
      const filteredAccounts = accounts.filter(acc => acc.id !== accountId);
      
      localStorage.setItem('userAccounts', JSON.stringify(filteredAccounts));
      loadAccountList();
      
      alert(`ê³„ì • "${accountId}"ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.`);
    }

    // ê³„ì • ìƒì„± ìƒíƒœ ë©”ì‹œì§€ í‘œì‹œ
    function showAccountStatus(element, message, type) {
      element.style.display = 'block';
      element.textContent = message;
      
      if (type === 'success') {
        element.style.background = '#d4edda';
        element.style.color = '#155724';
        element.style.border = '1px solid #c3e6cb';
      } else if (type === 'error') {
        element.style.background = '#f8d7da';
        element.style.color = '#721c24';
        element.style.border = '1px solid #f5c6cb';
      }
      
      // 3ì´ˆ í›„ ìë™ ìˆ¨ê¹€
      setTimeout(() => {
        element.style.display = 'none';
      }, 3000);
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ê¸°ë³¸ê°’ ì„¤ì •
    document.addEventListener('DOMContentLoaded', function() {
      // ê¸°ë³¸ì ìœ¼ë¡œ íšŒì˜ìë£Œ ê´€ë¦¬ íƒ­ì´ í™œì„±í™”ë¨
      document.getElementById('securitySection').classList.remove('active');
      
      // ê³„ì • ëª©ë¡ ë¡œë“œ
      loadAccountList();
    });
  </script>
</body>
</html>
