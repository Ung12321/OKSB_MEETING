<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>OKì €ì¶•ì€í–‰ íšŒì˜ìë£Œ ê´€ë¦¬ ì‹œìŠ¤í…œ - ê´€ë¦¬ì</title>
  <style>
    :root {
      --ok-orange: #E93D1A;
      --ok-dark-brown: #554744;
      --ok-yellow: #F4A611;
      --ok-bright-gray: #C5C5C5;
      --ok-bg-gray: #F8F8F8;
      --ok-text-dark: #2D2D2D;
      --ok-border-light: #E8E8E8;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Noto Sans KR', 'Apple SD Gothic Neo', 'Malgun Gothic', sans-serif;
      background-color: var(--ok-bg-gray);
      color: var(--ok-text-dark);
      min-height: 100vh;
    }

    /* í—¤ë” */
    .admin-header {
      background: linear-gradient(135deg, var(--ok-dark-brown) 0%, #3D2F2C 100%);
      color: white;
      padding: 20px 30px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      position: relative;
    }

    .admin-header::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .header-content {
      display: flex;
      justify-content: space-between;
      align-items: center;
      max-width: 1400px;
      margin: 0 auto;
    }

    .header-title {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .ok-logo {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .ok-logo-text {
      font-size: 2rem;
      font-weight: 900;
      color: white;
      letter-spacing: 1px;
    }

    .ok-logo-accent {
      color: var(--ok-orange);
      font-size: 2.2rem;
    }

    .header-title h1 {
      font-size: 1.8rem;
      font-weight: 700;
      letter-spacing: -0.5px;
    }

    .header-actions {
      display: flex;
      gap: 15px;
      align-items: center;
    }

    .btn-header {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 8px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s ease;
      text-decoration: none;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .btn-header:hover {
      background: #ff4520;
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(255,255,255,0.1);
      border: 2px solid rgba(255,255,255,0.3);
    }

    .btn-secondary:hover {
      background: rgba(255,255,255,0.2);
      border-color: rgba(255,255,255,0.5);
    }

    /* ë©”ì¸ ì»¨í…Œì´ë„ˆ */
    .admin-container {
      max-width: 1400px;
      margin: 0 auto;
      padding: 30px;
    }

    /* ëŒ€ì‹œë³´ë“œ ì¹´ë“œë“¤ */
    .dashboard-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 25px;
      margin-bottom: 40px;
    }

    .dashboard-card {
      background: white;
      border-radius: 15px;
      padding: 25px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
      position: relative;
      overflow: hidden;
    }

    .dashboard-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
    }

    .card-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 20px;
    }

    .card-title {
      font-size: 1.3rem;
      font-weight: 700;
      color: var(--ok-text-dark);
    }

    .card-icon {
      font-size: 2rem;
    }

    .card-number {
      font-size: 3rem;
      font-weight: 900;
      color: var(--ok-orange);
      margin-bottom: 10px;
    }

    .card-description {
      color: var(--ok-dark-brown);
      font-size: 1rem;
    }

    /* í•„í„° ì„¹ì…˜ */
    .filter-section {
      background: white;
      border-radius: 15px;
      padding: 25px;
      margin-bottom: 30px;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
    }

    .filter-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
      gap: 20px;
      align-items: end;
    }

    .filter-group {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .filter-group label {
      font-weight: 600;
      color: var(--ok-text-dark);
      font-size: 0.95rem;
    }

    .filter-select {
      padding: 12px 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 8px;
      font-size: 1rem;
      background: #fafafa;
      color: var(--ok-text-dark);
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .filter-select:focus {
      outline: none;
      border-color: var(--ok-orange);
      background: white;
    }

    .btn-filter {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 12px 25px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
      height: fit-content;
    }

    .btn-filter:hover {
      background: #ff4520;
    }

    /* í…Œì´ë¸” ìŠ¤íƒ€ì¼ */
    .table-container {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 8px 30px rgba(0,0,0,0.08);
      border: 1px solid var(--ok-border-light);
    }

    .table-header {
      background: var(--ok-dark-brown);
      color: white;
      padding: 20px 25px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .table-title {
      font-size: 1.3rem;
      font-weight: 700;
    }

    .table-actions {
      display: flex;
      gap: 10px;
    }

    .btn-table {
      background: var(--ok-orange);
      color: white;
      border: none;
      padding: 8px 15px;
      border-radius: 6px;
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-table:hover {
      background: #ff4520;
    }

    .btn-danger {
      background: #dc3545;
    }

    .btn-danger:hover {
      background: #c82333;
    }

    .data-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 0.95rem;
    }

    .data-table th,
    .data-table td {
      padding: 15px 20px;
      text-align: left;
      border-bottom: 1px solid var(--ok-border-light);
    }

    .data-table th {
      background: #f8f9fa;
      font-weight: 600;
      color: var(--ok-text-dark);
      position: sticky;
      top: 0;
    }

    .data-table tbody tr:hover {
      background: #f8f9fa;
    }

    .status-badge {
      padding: 6px 12px;
      border-radius: 15px;
      font-size: 0.8rem;
      font-weight: 600;
      text-align: center;
      min-width: 80px;
      display: inline-block;
    }

    .status-completed {
      background: #d4edda;
      color: #155724;
      border: 1px solid #c3e6cb;
    }

    .status-pending {
      background: #fff3cd;
      color: #856404;
      border: 1px solid #ffeaa7;
    }

    .status-not-started {
      background: #f8d7da;
      color: #721c24;
      border: 1px solid #f1b0b7;
    }

    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e9ecef;
      border-radius: 4px;
      overflow: hidden;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--ok-orange) 0%, var(--ok-yellow) 100%);
      transition: width 0.3s ease;
    }

    .action-buttons {
      display: flex;
      gap: 8px;
    }

    .btn-action {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 0.8rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-view {
      background: #007bff;
      color: white;
    }

    .btn-view:hover {
      background: #0056b3;
    }

    .btn-edit {
      background: #28a745;
      color: white;
    }

    .btn-edit:hover {
      background: #1e7e34;
    }

    .btn-delete {
      background: #dc3545;
      color: white;
    }

    .btn-delete:hover {
      background: #c82333;
    }

    /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
    .modal {
      display: none;
      position: fixed;
      z-index: 1000;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0,0,0,0.5);
    }

    .modal-content {
      background-color: white;
      margin: 5% auto;
      padding: 30px;
      border-radius: 15px;
      width: 90%;
      max-width: 600px;
      max-height: 80vh;
      overflow-y: auto;
      position: relative;
    }

    .modal-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 25px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--ok-border-light);
    }

    .modal-title {
      font-size: 1.5rem;
      font-weight: 700;
      color: var(--ok-text-dark);
    }

    .close {
      color: #aaa;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover {
      color: var(--ok-orange);
    }

    .modal-body {
      margin-bottom: 25px;
    }

    .modal-field {
      margin-bottom: 20px;
    }

    .modal-field label {
      display: block;
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--ok-text-dark);
    }

    .modal-field textarea,
    .modal-field input {
      width: 100%;
      padding: 12px 15px;
      border: 2px solid var(--ok-border-light);
      border-radius: 8px;
      font-size: 1rem;
      font-family: inherit;
      resize: vertical;
    }

    .modal-field textarea {
      min-height: 100px;
    }

    .modal-field textarea:focus,
    .modal-field input:focus {
      outline: none;
      border-color: var(--ok-orange);
    }

    .modal-footer {
      display: flex;
      justify-content: flex-end;
      gap: 10px;
    }

    .btn-modal {
      padding: 12px 25px;
      border: none;
      border-radius: 8px;
      cursor: pointer;
      font-size: 1rem;
      font-weight: 600;
      transition: all 0.3s ease;
    }

    .btn-primary {
      background: var(--ok-orange);
      color: white;
    }

    .btn-primary:hover {
      background: #ff4520;
    }

    .btn-cancel {
      background: var(--ok-bright-gray);
      color: var(--ok-text-dark);
    }

    .btn-cancel:hover {
      background: #a8a8a8;
    }

    /* ë°˜ì‘í˜• ë””ìì¸ */
    @media (max-width: 768px) {
      .admin-container {
        padding: 20px;
      }

      .header-content {
        flex-direction: column;
        gap: 15px;
        text-align: center;
      }

      .filter-grid {
        grid-template-columns: 1fr;
      }

      .dashboard-grid {
        grid-template-columns: 1fr;
      }

      .data-table {
        font-size: 0.85rem;
      }

      .data-table th,
      .data-table td {
        padding: 10px 12px;
      }
    }

    /* ë¡œë”© ìŠ¤í”¼ë„ˆ */
    .loading {
      display: none;
      text-align: center;
      padding: 50px;
    }

    .spinner {
      border: 4px solid #f3f3f3;
      border-top: 4px solid var(--ok-orange);
      border-radius: 50%;
      width: 50px;
      height: 50px;
      animation: spin 1s linear infinite;
      margin: 0 auto 20px;
    }

    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    /* ë¹ˆ ìƒíƒœ */
    .empty-state {
      text-align: center;
      padding: 50px 20px;
      color: var(--ok-bright-gray);
    }

    .empty-state i {
      font-size: 4rem;
      margin-bottom: 20px;
      display: block;
    }

    .empty-state h3 {
      font-size: 1.5rem;
      margin-bottom: 10px;
      color: var(--ok-text-dark);
    }

         .empty-state p {
       font-size: 1rem;
     }

     /* ì·¨í•© í˜ì´ì§€ ìŠ¤íƒ€ì¼ */
     .summary-content {
       padding: 30px;
     }

     .summary-header {
       text-align: center;
       margin-bottom: 40px;
       border-bottom: 3px solid var(--ok-orange);
       padding-bottom: 20px;
     }

     .summary-header h2 {
       font-size: 2rem;
       color: var(--ok-text-dark);
       margin-bottom: 10px;
       font-weight: 700;
     }

     .summary-header p {
       color: var(--ok-dark-brown);
       font-size: 1.1rem;
     }

     .department-summary {
       margin-bottom: 40px;
       border: 2px solid var(--ok-border-light);
       border-radius: 12px;
       overflow: hidden;
     }

     .department-summary-header {
       background: var(--ok-dark-brown);
       color: white;
       padding: 15px 25px;
       font-weight: 700;
       font-size: 1.2rem;
       display: flex;
       justify-content: space-between;
       align-items: center;
     }

     .department-summary-content {
       padding: 25px;
     }

     .summary-field {
       margin-bottom: 25px;
     }

     .summary-field-title {
       font-weight: 700;
       color: var(--ok-dark-brown);
       font-size: 1.1rem;
       margin-bottom: 10px;
       border-left: 4px solid var(--ok-orange);
       padding-left: 12px;
     }

     .summary-field-content {
       background: #f8f9fa;
       padding: 15px 20px;
       border-radius: 8px;
       border: 1px solid var(--ok-border-light);
       min-height: 60px;
       line-height: 1.6;
       white-space: pre-wrap;
     }

     .summary-field-content.empty {
       color: #999;
       font-style: italic;
     }

     .department-status {
       padding: 8px 15px;
       border-radius: 20px;
       font-size: 0.9rem;
       font-weight: 600;
     }

     .summary-actions {
       margin-top: 30px;
       text-align: center;
     }

     .btn-summary {
       background: var(--ok-orange);
       color: white;
       border: none;
       padding: 12px 25px;
       border-radius: 8px;
       cursor: pointer;
       font-size: 1rem;
       font-weight: 600;
       margin: 0 10px;
       transition: all 0.3s ease;
     }

     .btn-summary:hover {
       background: #ff4520;
       transform: translateY(-2px);
     }

     @media print {
       .table-header, .summary-actions, .btn-summary {
         display: none !important;
       }
       
       .summary-header .summary-actions {
         display: none !important;
       }
       
       .summary-content {
         padding: 0;
       }
       
       .department-summary {
         break-inside: avoid;
         margin-bottom: 30px;
       }
     }
  </style>
</head>
<body>
  <!-- í—¤ë” -->
  <div class="admin-header">
    <div class="header-content">
             <div class="header-title">
                 <div class="ok-logo">
          <svg width="140" height="50" viewBox="0 0 140 50" style="height: 40px; width: auto;">
            <defs>
              <linearGradient id="bgGradient4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#554744;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#3d3330;stop-opacity:1" />
              </linearGradient>
              <linearGradient id="orangeGradient4" x1="0%" y1="0%" x2="100%" y2="100%">
                <stop offset="0%" style="stop-color:#E93D1A;stop-opacity:1" />
                <stop offset="100%" style="stop-color:#d32f0f;stop-opacity:1" />
              </linearGradient>
            </defs>
            <rect width="140" height="50" rx="12" fill="url(#bgGradient4)"/>
            <rect x="0" y="0" width="8" height="50" rx="12" fill="url(#orangeGradient4)"/>
            <text x="18" y="34" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="#2a2a2a" opacity="0.3">OK</text>
            <text x="16" y="32" font-family="Arial, sans-serif" font-size="24" font-weight="900" fill="white">OK</text>
            <text x="52" y="34" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#2a2a2a" opacity="0.3">!</text>
            <text x="50" y="32" font-family="Arial, sans-serif" font-size="26" font-weight="900" fill="#E93D1A">!</text>
            <text x="70" y="22" font-family="Arial, sans-serif" font-size="11" font-weight="600" fill="white">ì €ì¶•ì€í–‰</text>
            <text x="70" y="36" font-family="Arial, sans-serif" font-size="9" font-weight="500" fill="#F4A611">SAVINGS BANK</text>
            <circle cx="125" cy="15" r="4" fill="#E93D1A" opacity="0.8"/>
            <circle cx="130" cy="25" r="2.5" fill="#F4A611" opacity="0.9"/>
            <circle cx="120" cy="35" r="2" fill="#E93D1A" opacity="0.6"/>
          </svg>
        </div>
         <h1>ê´€ë¦¬ì ëŒ€ì‹œë³´ë“œ</h1>
       </div>
      <div class="header-actions">
        <a href="index.html" class="btn-header btn-secondary">
          <span>ğŸ“‹</span>
          <span>íšŒì˜ìë£Œ ì…ë ¥</span>
        </a>
        <button class="btn-header" onclick="exportData()">
          <span>ğŸ“Š</span>
          <span>ë°ì´í„° ë‚´ë³´ë‚´ê¸°</span>
        </button>
        <button class="btn-header" onclick="refreshData()">
          <span>ğŸ”„</span>
          <span>ìƒˆë¡œê³ ì¹¨</span>
        </button>
      </div>
    </div>
  </div>

  <!-- ë©”ì¸ ì»¨í…Œì´ë„ˆ -->
  <div class="admin-container">
    <!-- ëŒ€ì‹œë³´ë“œ í†µê³„ -->
    <div class="dashboard-grid">
      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ì „ì²´ íšŒì˜</div>
          <div class="card-icon">ğŸ“…</div>
        </div>
        <div class="card-number" id="totalMeetings">0</div>
        <div class="card-description">2025ë…„ 8ì›”~12ì›”</div>
      </div>

      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ì‘ì„±ì™„ë£Œ</div>
          <div class="card-icon">âœ…</div>
        </div>
        <div class="card-number" id="completedTasks">0</div>
        <div class="card-description">ë¶€ì„œë³„ ì‘ì„±ì™„ë£Œ ê±´ìˆ˜</div>
      </div>

      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ì‘ì„±ì¤‘</div>
          <div class="card-icon">ğŸ“</div>
        </div>
        <div class="card-number" id="pendingTasks">0</div>
        <div class="card-description">ì‘ì„± ì§„í–‰ì¤‘ì¸ ê±´ìˆ˜</div>
      </div>

      <div class="dashboard-card">
        <div class="card-header">
          <div class="card-title">ë¯¸ì‘ì„±</div>
          <div class="card-icon">â³</div>
        </div>
        <div class="card-number" id="notStartedTasks">0</div>
        <div class="card-description">ì•„ì§ ì‹œì‘í•˜ì§€ ì•Šì€ ê±´ìˆ˜</div>
      </div>
    </div>

    <!-- íšŒì˜ ì„ íƒ ì„¹ì…˜ -->
    <div class="filter-section">
      <h3 style="margin-bottom: 20px; color: var(--ok-text-dark); font-size: 1.2rem;">íšŒì˜ ì„ íƒ</h3>
      <div class="filter-grid">
        <div class="filter-group">
          <label for="filterYear">ì—°ë„</label>
          <select id="filterYear" class="filter-select">
            <option value="">ì—°ë„ ì„ íƒ</option>
            <option value="2025">2025ë…„</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filterMonth">ì›”</label>
          <select id="filterMonth" class="filter-select">
            <option value="">ì›” ì„ íƒ</option>
            <option value="08">8ì›”</option>
            <option value="09">9ì›”</option>
            <option value="10">10ì›”</option>
            <option value="11">11ì›”</option>
            <option value="12">12ì›”</option>
          </select>
        </div>
        
        <div class="filter-group">
          <label for="filterType">íšŒì˜ êµ¬ë¶„</label>
          <select id="filterType" class="filter-select">
            <option value="">íšŒì˜ êµ¬ë¶„ ì„ íƒ</option>
            <option value="monthly">ì›”ê°„ê°„ë‹´íšŒ</option>
            <option value="week1">1ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week2">2ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week3">3ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week4">4ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
            <option value="week5">5ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ</option>
          </select>
        </div>

        <button class="btn-filter" onclick="searchMeeting()" id="searchBtn" disabled>í™•ì¸</button>
      </div>
    </div>

    <!-- ë°ì´í„° í…Œì´ë¸” -->
    <div class="table-container">
      <div class="table-header">
        <div class="table-title">íšŒì˜ìë£Œ ì‘ì„± í˜„í™©</div>
               <div class="table-actions">
         <button class="btn-table" onclick="exportCurrentData()">í˜„ì¬ ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
         <button class="btn-table btn-danger" onclick="clearCurrentData()">í˜„ì¬ íšŒì˜ ë°ì´í„° ì‚­ì œ</button>
       </div>
      </div>
      
      <div id="tableContent">
        <div class="loading" id="loadingSpinner">
          <div class="spinner"></div>
          <p>ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
        </div>
        
                 <div class="empty-state" id="emptyState">
           <i>ğŸ“Š</i>
           <h3>íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”</h3>
           <p>ìœ„ì—ì„œ ì—°ë„, ì›”, íšŒì˜ êµ¬ë¶„ì„ ì„ íƒí•œ í›„ í™•ì¸ ë²„íŠ¼ì„ ëˆŒëŸ¬ì£¼ì„¸ìš”.</p>
         </div>
        
                 <table class="data-table" id="dataTable" style="display: none;">
           <thead>
             <tr>
               <th>íšŒì˜ëª…</th>
               <th>ë¶€ì„œ</th>
               <th>ìƒíƒœ</th>
               <th>ë§ˆì§€ë§‰ ìˆ˜ì •</th>
               <th>ì•¡ì…˜</th>
             </tr>
           </thead>
           <tbody id="dataTableBody">
           </tbody>
         </table>
             </div>
     </div>

     <!-- íšŒì˜ìë£Œ ì·¨í•© ì„¹ì…˜ -->
     <div class="table-container" id="summaryContainer" style="display: none;">
       <div class="table-header">
         <div class="table-title">íšŒì˜ìë£Œ ì·¨í•©</div>
         <div class="table-actions">
           <button class="btn-table" onclick="exportSummaryData()">ì·¨í•© ë°ì´í„° ë‚´ë³´ë‚´ê¸°</button>
           <button class="btn-table" onclick="printSummaryData()">ì¸ì‡„í•˜ê¸°</button>
         </div>
       </div>
       
       <div class="summary-content" id="summaryContent">
         <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ì·¨í•© ë‚´ìš© -->
       </div>
     </div>
   </div>

   <!-- ìƒì„¸ ë³´ê¸° ëª¨ë‹¬ -->
  <div id="detailModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title" id="modalTitle">ìƒì„¸ ì •ë³´</h2>
        <span class="close" onclick="closeModal()">&times;</span>
      </div>
      <div class="modal-body" id="modalBody">
        <!-- ë™ì ìœ¼ë¡œ ìƒì„±ë  ë‚´ìš© -->
      </div>
      <div class="modal-footer">
        <button class="btn-modal btn-cancel" onclick="closeModal()">ë‹«ê¸°</button>
        <button class="btn-modal btn-primary" onclick="saveModalData()" id="saveModalBtn">ì €ì¥</button>
      </div>
    </div>
  </div>

  <script>
    // 16ê°œ ë¶€ì„œ ëª©ë¡
    const departments = [
      'ì˜ì—…ì¶”ì§„ë¶€', 'ë¦¬í…Œì¼ê¸°íšë¶€', 'ëª¨ê¸°ì§€ì‚¬ì—…ë¶€', 'ì‹¬ì‚¬ë¶€', 
      'ë¦¬ìŠ¤í¬ê´€ë¦¬ë¶€', 'ê²½ì˜ê´€ë¦¬ë³¸ë¶€(ê²½ì˜ê¸°íšë¶€)', 'ê²½ì˜ê´€ë¦¬ë³¸ë¶€(ITê¸°íšë¶€)', 'ë¯¸ë˜ë””ì§€í„¸ë¶€',
      'ì†Œë¹„ìê¸ˆìœµì˜ì—…ë¶€', 'ì†Œë¹„ìê¸ˆìœµê¸°íšë¶€', 'ì‹ ìš©ê´€ë¦¬ë¶€', 'ë§ˆì¼€íŒ…íŒ€',
      'ê°ì‚¬ë¶€', 'ì¤€ë²•ì§€ì›ë¶€', 'ê¸ˆìœµì†Œë¹„ìë³´í˜¸ë¶€', 'ì •ë³´ë³´ì•ˆíŒ€'
    ];

         // ì „ì—­ ë³€ìˆ˜
     let meetingData = {};
     let currentMeetingData = [];
     let currentEditData = null;
     let selectedMeeting = null;

     // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸°í™”
     document.addEventListener('DOMContentLoaded', function() {
       loadData();
       updateDashboard();
       setupEventListeners();
       showInitialState();
     });

         // ë°ì´í„° ë¡œë“œ
     function loadData() {
       meetingData = JSON.parse(localStorage.getItem('meetingData')) || {};
     }

     // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì„¤ì •
     function setupEventListeners() {
       document.getElementById('filterYear').addEventListener('change', checkSearchValid);
       document.getElementById('filterMonth').addEventListener('change', checkSearchValid);
       document.getElementById('filterType').addEventListener('change', checkSearchValid);
     }

     // ê²€ìƒ‰ ë²„íŠ¼ í™œì„±í™” ì²´í¬
     function checkSearchValid() {
       const year = document.getElementById('filterYear').value;
       const month = document.getElementById('filterMonth').value;
       const type = document.getElementById('filterType').value;
       
       const searchBtn = document.getElementById('searchBtn');
       if (year && month && type) {
         searchBtn.disabled = false;
       } else {
         searchBtn.disabled = true;
       }
     }

     // ì´ˆê¸° ìƒíƒœ í‘œì‹œ
     function showInitialState() {
       const loadingSpinner = document.getElementById('loadingSpinner');
       const emptyState = document.getElementById('emptyState');
       const dataTable = document.getElementById('dataTable');
       
       loadingSpinner.style.display = 'none';
       emptyState.style.display = 'block';
       dataTable.style.display = 'none';
     }

         // íšŒì˜ ê²€ìƒ‰
     function searchMeeting() {
       const year = document.getElementById('filterYear').value;
       const month = document.getElementById('filterMonth').value;
       const type = document.getElementById('filterType').value;
       
       if (!year || !month || !type) {
         alert('ëª¨ë“  í•­ëª©ì„ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       const meetingId = `${year}-${month}-${type}`;
       const meetingName = getMeetingName(month, type);
       
       selectedMeeting = {
         id: meetingId,
         name: meetingName,
         year,
         month,
         type
       };
       
       // í•´ë‹¹ íšŒì˜ì˜ ë¶€ì„œë³„ ë°ì´í„° ì¤€ë¹„
       currentMeetingData = [];
       departments.forEach(dept => {
         const deptData = meetingData[meetingId] ? meetingData[meetingId][dept] : null;
         const status = getDepartmentStatus(deptData);
         const progress = getDepartmentProgress(deptData, type);
         const lastModified = getLastModified(deptData);
         
         currentMeetingData.push({
           meetingId,
           meetingName,
           department: dept,
           status,
           progress,
           lastModified,
           data: deptData
         });
       });
               
        updateDashboard();
        renderTable();
        
        // íšŒì˜ìë£Œ ì·¨í•© ë²„íŠ¼ í‘œì‹œ
        showSummaryButton();
      }

      // íšŒì˜ìë£Œ ì·¨í•© ë²„íŠ¼ í‘œì‹œ
      function showSummaryButton() {
        if (selectedMeeting) {
          const tableContainer = document.querySelector('.table-container .table-header .table-actions');
          if (!document.getElementById('summaryBtn')) {
            const summaryBtn = document.createElement('button');
            summaryBtn.id = 'summaryBtn';
            summaryBtn.className = 'btn-table';
            summaryBtn.textContent = 'íšŒì˜ìë£Œ ì·¨í•©ë³´ê¸°';
            summaryBtn.onclick = showSummaryPage;
            tableContainer.insertBefore(summaryBtn, tableContainer.firstChild);
          }
        }
      }

      // íšŒì˜ëª… ìƒì„±
    function getMeetingName(month, type) {
      const monthName = parseInt(month) + 'ì›”';
      if (type === 'monthly') {
        return `2025ë…„ ${monthName} ì›”ê°„ê°„ë‹´íšŒ`;
      } else {
        const weekNum = type.replace('week', '');
        return `2025ë…„ ${monthName} ${weekNum}ì£¼ì°¨ ì£¼ê°„ê°„ë‹´íšŒ`;
      }
    }

    // ë¶€ì„œ ìƒíƒœ í™•ì¸
    function getDepartmentStatus(deptData) {
      if (!deptData) return 'not-started';
      if (deptData.completed) return 'completed';
      
      const hasContent = Object.keys(deptData).some(key => 
        key !== 'completed' && deptData[key] && deptData[key].toString().trim() !== ''
      );
      
      return hasContent ? 'pending' : 'not-started';
    }

         // ì§„í–‰ë¥  ê³„ì‚° (ì‚¬ìš©í•˜ì§€ ì•ŠìŒ)
     function getDepartmentProgress(deptData, meetingType) {
       return 0; // ì§„í–‰ë¥  ê¸°ëŠ¥ ì œê±°
     }

         // ë§ˆì§€ë§‰ ìˆ˜ì •ì¼ í™•ì¸
     function getLastModified(deptData) {
       if (!deptData || !deptData.lastModified) return '-';
       const date = new Date(deptData.lastModified);
       return date.toLocaleDateString('ko-KR') + ' ' + date.toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'});
     }

         // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
     function updateDashboard() {
       const stats = calculateStats();
       
       document.getElementById('totalMeetings').textContent = stats.totalDepartments;
       document.getElementById('completedTasks').textContent = stats.completed;
       document.getElementById('pendingTasks').textContent = stats.pending;
       document.getElementById('notStartedTasks').textContent = stats.notStarted;
       
       // ëŒ€ì‹œë³´ë“œ ì¹´ë“œ ì œëª© ì—…ë°ì´íŠ¸
       const firstCard = document.querySelector('.dashboard-card .card-title');
       if (selectedMeeting) {
         firstCard.textContent = 'ì „ì²´ ë¶€ì„œ';
         document.querySelector('.card-description').textContent = selectedMeeting.name;
       } else {
         firstCard.textContent = 'ì „ì²´ ë¶€ì„œ';
         document.querySelector('.card-description').textContent = 'íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”';
       }
     }

         // í†µê³„ ê³„ì‚°
     function calculateStats() {
       if (!selectedMeeting) {
         return { totalDepartments: 16, completed: 0, pending: 0, notStarted: 0 };
       }
       
       const totalDepartments = departments.length;
       let completed = 0;
       let pending = 0;
       let notStarted = 0;
       
       currentMeetingData.forEach(item => {
         switch(item.status) {
           case 'completed': completed++; break;
           case 'pending': pending++; break;
           case 'not-started': notStarted++; break;
         }
       });
       
       return { totalDepartments, completed, pending, notStarted };
     }

         // í…Œì´ë¸” ë Œë”ë§
     function renderTable() {
       const tableBody = document.getElementById('dataTableBody');
       const loadingSpinner = document.getElementById('loadingSpinner');
       const emptyState = document.getElementById('emptyState');
       const dataTable = document.getElementById('dataTable');
       
       if (!selectedMeeting) {
         loadingSpinner.style.display = 'none';
         emptyState.style.display = 'block';
         dataTable.style.display = 'none';
         return;
       }
       
       // ë¡œë”© í‘œì‹œ
       loadingSpinner.style.display = 'block';
       emptyState.style.display = 'none';
       dataTable.style.display = 'none';
       
       setTimeout(() => {
         if (currentMeetingData.length === 0) {
           loadingSpinner.style.display = 'none';
           emptyState.style.display = 'block';
           emptyState.innerHTML = '<i>ğŸ“Š</i><h3>ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤</h3><p>ì„ íƒí•œ íšŒì˜ì˜ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
           return;
         }
         
         tableBody.innerHTML = '';
         currentMeetingData.forEach(item => {
           const row = createTableRow(item);
           tableBody.appendChild(row);
         });
         
         loadingSpinner.style.display = 'none';
         dataTable.style.display = 'table';
       }, 500);
     }

    // í…Œì´ë¸” í–‰ ìƒì„±
    function createTableRow(item) {
      const row = document.createElement('tr');
      
      const statusText = {
        'completed': 'ì‘ì„±ì™„ë£Œ',
        'pending': 'ì‘ì„±ì¤‘',
        'not-started': 'ë¯¸ì‘ì„±'
      };
      
      const statusClass = {
        'completed': 'status-completed',
        'pending': 'status-pending',
        'not-started': 'status-not-started'
      };
      
             row.innerHTML = `
         <td>${item.meetingName}</td>
         <td>${item.department}</td>
         <td><span class="status-badge ${statusClass[item.status]}">${statusText[item.status]}</span></td>
         <td>${item.lastModified}</td>
         <td>
           <div class="action-buttons">
             <button class="btn-action btn-view" onclick="viewDetail('${item.meetingId}', '${item.department}')">ë³´ê¸°</button>
             <button class="btn-action btn-edit" onclick="editDetail('${item.meetingId}', '${item.department}')">ìˆ˜ì •</button>
             <button class="btn-action btn-delete" onclick="deleteDetail('${item.meetingId}', '${item.department}')">ì‚­ì œ</button>
           </div>
         </td>
       `;
      
      return row;
    }

    // í•„í„° ì ìš©
    function applyFilters() {
      const year = document.getElementById('filterYear').value;
      const month = document.getElementById('filterMonth').value;
      const type = document.getElementById('filterType').value;
      const status = document.getElementById('filterStatus').value;
      
      filteredData = prepareTableData().filter(item => {
        if (year && !item.meetingId.startsWith(year)) return false;
        if (month && !item.meetingId.includes(`-${month}-`)) return false;
        if (type && !item.meetingId.endsWith(`-${type}`)) return false;
        if (status && item.status !== status) return false;
        return true;
      });
      
      updateDashboard();
      renderTable();
    }

    // ìƒì„¸ ë³´ê¸°
    function viewDetail(meetingId, department) {
      const data = meetingData[meetingId] ? meetingData[meetingId][department] : null;
      const meetingName = getMeetingName(meetingId.split('-')[1], meetingId.split('-')[2]);
      
      showModal(`${meetingName} - ${department}`, data, false);
    }

    // ìˆ˜ì •
    function editDetail(meetingId, department) {
      const data = meetingData[meetingId] ? meetingData[meetingId][department] : null;
      const meetingName = getMeetingName(meetingId.split('-')[1], meetingId.split('-')[2]);
      
      currentEditData = { meetingId, department };
      showModal(`${meetingName} - ${department} ìˆ˜ì •`, data, true);
    }

    // ì‚­ì œ
    function deleteDetail(meetingId, department) {
      if (!confirm(`${department}ì˜ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
      
      if (meetingData[meetingId] && meetingData[meetingId][department]) {
        delete meetingData[meetingId][department];
        if (Object.keys(meetingData[meetingId]).length === 0) {
          delete meetingData[meetingId];
        }
        localStorage.setItem('meetingData', JSON.stringify(meetingData));
      }
      
      loadData();
      updateDashboard();
      renderTable();
      
      alert('ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ëª¨ë‹¬ í‘œì‹œ
    function showModal(title, data, isEdit) {
      const modal = document.getElementById('detailModal');
      const modalTitle = document.getElementById('modalTitle');
      const modalBody = document.getElementById('modalBody');
      const saveBtn = document.getElementById('saveModalBtn');
      
      modalTitle.textContent = title;
      saveBtn.style.display = isEdit ? 'block' : 'none';
      
      // ëª¨ë‹¬ ë‚´ìš© ìƒì„±
      let content = '';
      if (data) {
        const meetingType = currentEditData ? currentEditData.meetingId.split('-')[2] : 'monthly';
        
                 const previousLabel = meetingType === 'monthly' ? 'ì „ì›” ì¶”ì§„ ì‹¤ì ' : 'ì „ì£¼ ì¶”ì§„ ì‹¤ì ';
         const currentLabel = meetingType === 'monthly' ? 'ê¸ˆì›” ì¶”ì§„ ê³„íš' : 'ê¸ˆì£¼ ì¶”ì§„ ê³„íš';
         
         content = `
           <div class="modal-field">
             <label>${previousLabel}</label>
             <textarea ${isEdit ? '' : 'readonly'}>${data.previousResults || ''}</textarea>
           </div>
           <div class="modal-field">
             <label>${currentLabel}</label>
             <textarea ${isEdit ? '' : 'readonly'}>${data.currentPlan || ''}</textarea>
           </div>
         `;
        
        if (data.completed) {
          content += `<div class="modal-field"><strong>ìƒíƒœ: ì‘ì„±ì™„ë£Œ</strong></div>`;
        }
      } else {
        content = '<p>ì‘ì„±ëœ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
      }
      
      modalBody.innerHTML = content;
      modal.style.display = 'block';
    }

    // ëª¨ë‹¬ ë‹«ê¸°
    function closeModal() {
      document.getElementById('detailModal').style.display = 'none';
      currentEditData = null;
    }

    // ëª¨ë‹¬ ë°ì´í„° ì €ì¥
    function saveModalData() {
      if (!currentEditData) return;
      
      const { meetingId, department } = currentEditData;
      const modalInputs = document.querySelectorAll('#modalBody textarea, #modalBody input');
      
      if (!meetingData[meetingId]) meetingData[meetingId] = {};
      if (!meetingData[meetingId][department]) meetingData[meetingId][department] = {};
      
             const fields = ['previousResults', 'currentPlan'];
       modalInputs.forEach((input, index) => {
         if (fields[index]) {
           meetingData[meetingId][department][fields[index]] = input.value;
         }
       });
      
      meetingData[meetingId][department].lastModified = new Date().toISOString();
      localStorage.setItem('meetingData', JSON.stringify(meetingData));
      
      closeModal();
      loadData();
      updateDashboard();
      renderTable();
      
      alert('ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ë°ì´í„° ìƒˆë¡œê³ ì¹¨
    function refreshData() {
      loadData();
      updateDashboard();
      renderTable();
      alert('ë°ì´í„°ê°€ ìƒˆë¡œê³ ì¹¨ë˜ì—ˆìŠµë‹ˆë‹¤.');
    }

    // ë°ì´í„° ë‚´ë³´ë‚´ê¸°
    function exportData() {
      const dataStr = JSON.stringify(meetingData, null, 2);
      const dataBlob = new Blob([dataStr], {type: 'application/json'});
      const url = URL.createObjectURL(dataBlob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `íšŒì˜ìë£Œ_ì „ì²´ë°ì´í„°_${new Date().toISOString().split('T')[0]}.json`;
      link.click();
      URL.revokeObjectURL(url);
    }

    // í•„í„°ëœ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
    function exportFilteredData() {
      if (filteredData.length === 0) {
        alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
        return;
      }
      
      const csvContent = generateCSV(filteredData);
      const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = `íšŒì˜ìë£Œ_í•„í„°ë°ì´í„°_${new Date().toISOString().split('T')[0]}.csv`;
      link.click();
      URL.revokeObjectURL(url);
    }

           // CSV ìƒì„±
       function generateCSV(data) {
         const headers = ['íšŒì˜ëª…', 'ë¶€ì„œ', 'ìƒíƒœ', 'ë§ˆì§€ë§‰ìˆ˜ì •'];
         const rows = data.map(item => [
           item.meetingName,
           item.department,
           item.status === 'completed' ? 'ì‘ì„±ì™„ë£Œ' : item.status === 'pending' ? 'ì‘ì„±ì¤‘' : 'ë¯¸ì‘ì„±',
           item.lastModified
         ]);
         
         const csvContent = [headers, ...rows]
           .map(row => row.map(field => `"${field}"`).join(','))
           .join('\n');
           
         return '\uFEFF' + csvContent; // BOM ì¶”ê°€ (í•œê¸€ ê¹¨ì§ ë°©ì§€)
       }

    // ì „ì²´ ë°ì´í„° ì‚­ì œ
    function clearAllData() {
      if (!confirm('ì „ì²´ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.')) return;
      
      if (confirm('ì •ë§ë¡œ ëª¨ë“  íšŒì˜ìë£Œ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        localStorage.removeItem('meetingData');
        meetingData = {};
        loadData();
        updateDashboard();
        renderTable();
               alert('ì „ì²´ ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
       }
     }

     // íšŒì˜ìë£Œ ì·¨í•© í˜ì´ì§€ í‘œì‹œ
     function showSummaryPage() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ë¨¼ì € ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       const tableContainer = document.querySelector('.table-container');
       const summaryContainer = document.getElementById('summaryContainer');
       
       tableContainer.style.display = 'none';
       summaryContainer.style.display = 'block';
       
       generateSummaryContent();
     }

     // ì·¨í•© ë‚´ìš© ìƒì„±
     function generateSummaryContent() {
       const summaryContent = document.getElementById('summaryContent');
       const meetingType = selectedMeeting.type === 'monthly' ? 'ì›”ê°„' : 'ì£¼ê°„';
       const typeText = selectedMeeting.type === 'monthly' ? '' : ` ${selectedMeeting.type.replace('week', '')}ì£¼ì°¨`;
       
       let html = `
         <div class="summary-header">
           <h2>${selectedMeeting.name}</h2>
           <p>OKì €ì¶•ì€í–‰ ${meetingType}ê°„ë‹´íšŒ${typeText} - ì „ ë¶€ì„œ íšŒì˜ìë£Œ ì·¨í•©</p>
           <p style="margin-top: 10px; font-size: 0.9rem; color: #666;">
             ì‘ì„±ì¼: ${new Date().toLocaleDateString('ko-KR')} ${new Date().toLocaleTimeString('ko-KR', {hour: '2-digit', minute: '2-digit'})}
           </p>
           <div class="summary-actions" style="margin-top: 25px;">
             <button class="btn-summary" onclick="backToTable()">ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°</button>
             <button class="btn-summary" onclick="exportSummaryData()">PDFë¡œ ë‚´ë³´ë‚´ê¸°</button>
             <button class="btn-summary" onclick="printSummaryData()">ì¸ì‡„í•˜ê¸°</button>
           </div>
         </div>
       `;
       
       departments.forEach(dept => {
         const deptData = meetingData[selectedMeeting.id] ? meetingData[selectedMeeting.id][dept] : null;
         const status = getDepartmentStatus(deptData);
         const lastModified = getLastModified(deptData);
         
         const statusText = {
           'completed': 'ì‘ì„±ì™„ë£Œ',
           'pending': 'ì‘ì„±ì¤‘',
           'not-started': 'ë¯¸ì‘ì„±'
         };
         
         const statusClass = {
           'completed': 'status-completed',
           'pending': 'status-pending',
           'not-started': 'status-not-started'
         };
         
         const previousLabel = selectedMeeting.type === 'monthly' ? 'ì „ì›” ì¶”ì§„ ì‹¤ì ' : 'ì „ì£¼ ì¶”ì§„ ì‹¤ì ';
         const currentLabel = selectedMeeting.type === 'monthly' ? 'ê¸ˆì›” ì¶”ì§„ ê³„íš' : 'ê¸ˆì£¼ ì¶”ì§„ ê³„íš';
         
         html += `
           <div class="department-summary">
             <div class="department-summary-header">
               <span>${dept}</span>
               <span class="department-status ${statusClass[status]}">${statusText[status]}</span>
             </div>
             <div class="department-summary-content">
               <div class="summary-field">
                 <div class="summary-field-title">${previousLabel}</div>
                 <div class="summary-field-content ${!deptData?.previousResults ? 'empty' : ''}">
                   ${deptData?.previousResults || 'ì‘ì„±ë˜ì§€ ì•ŠìŒ'}
                 </div>
               </div>
               <div class="summary-field">
                 <div class="summary-field-title">${currentLabel}</div>
                 <div class="summary-field-content ${!deptData?.currentPlan ? 'empty' : ''}">
                   ${deptData?.currentPlan || 'ì‘ì„±ë˜ì§€ ì•ŠìŒ'}
                 </div>
               </div>
               ${lastModified !== '-' ? `<div style="text-align: right; color: #666; font-size: 0.9rem; margin-top: 15px;">ìµœì¢… ìˆ˜ì •: ${lastModified}</div>` : ''}
             </div>
           </div>
         `;
       });
       

       
       summaryContent.innerHTML = html;
     }

     // ëª©ë¡ìœ¼ë¡œ ëŒì•„ê°€ê¸°
     function backToTable() {
       const tableContainer = document.querySelector('.table-container');
       const summaryContainer = document.getElementById('summaryContainer');
       
       summaryContainer.style.display = 'none';
       tableContainer.style.display = 'block';
     }

     // ì·¨í•© ë°ì´í„° ë‚´ë³´ë‚´ê¸°
     function exportSummaryData() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       // HTML ë‚´ìš©ì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜í•˜ì—¬ ë‚´ë³´ë‚´ê¸°
       const summaryHTML = document.getElementById('summaryContent').innerHTML;
       const exportData = {
         meeting: selectedMeeting,
         generatedAt: new Date().toISOString(),
         departments: {}
       };
       
       departments.forEach(dept => {
         const deptData = meetingData[selectedMeeting.id] ? meetingData[selectedMeeting.id][dept] : null;
         exportData.departments[dept] = deptData;
       });
       
       const dataStr = JSON.stringify(exportData, null, 2);
       const dataBlob = new Blob([dataStr], {type: 'application/json'});
       const url = URL.createObjectURL(dataBlob);
       const link = document.createElement('a');
       link.href = url;
       link.download = `${selectedMeeting.name}_ì·¨í•©ìë£Œ_${new Date().toISOString().split('T')[0]}.json`;
       link.click();
       URL.revokeObjectURL(url);
     }

     // ì¸ì‡„í•˜ê¸°
     function printSummaryData() {
       window.print();
     }

     // í˜„ì¬ íšŒì˜ ë°ì´í„° ì‚­ì œ
     function clearCurrentData() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       if (!confirm(`${selectedMeeting.name}ì˜ ëª¨ë“  ë¶€ì„œ ë°ì´í„°ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
       
       if (meetingData[selectedMeeting.id]) {
         delete meetingData[selectedMeeting.id];
         localStorage.setItem('meetingData', JSON.stringify(meetingData));
       }
       
       loadData();
       updateDashboard();
       renderTable();
       
       alert('í˜„ì¬ íšŒì˜ì˜ ëª¨ë“  ë°ì´í„°ê°€ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
     }

     // í˜„ì¬ ë°ì´í„° ë‚´ë³´ë‚´ê¸°
     function exportCurrentData() {
       if (!selectedMeeting) {
         alert('íšŒì˜ë¥¼ ì„ íƒí•´ì£¼ì„¸ìš”.');
         return;
       }
       
       if (currentMeetingData.length === 0) {
         alert('ë‚´ë³´ë‚¼ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
         return;
       }
       
       const csvContent = generateCSV(currentMeetingData);
       const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
       const url = URL.createObjectURL(blob);
       const link = document.createElement('a');
       link.href = url;
       link.download = `${selectedMeeting.name}_í˜„í™©ë°ì´í„°_${new Date().toISOString().split('T')[0]}.csv`;
       link.click();
       URL.revokeObjectURL(url);
     }

     // ëª¨ë‹¬ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
    window.onclick = function(event) {
      const modal = document.getElementById('detailModal');
      if (event.target === modal) {
        closeModal();
      }
    };
  </script>
</body>
</html>
